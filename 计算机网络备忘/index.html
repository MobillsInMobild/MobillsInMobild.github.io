<!DOCTYPE html><html lang=zh-CN data-default-color-scheme=auto><head><meta charset=UTF-8><link rel=apple-touch-icon sizes=76x76 href=/img/favicon/favicon.png><link rel=icon href=/img/favicon/favicon.png><link rel=canonical href=https://justloseit.top/计算机网络备忘/ ><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content=#2f4154><meta name=author content="Mobilis In Mobili"><meta name=keywords content=""><meta name=description content="学习计算机网络时提炼的备忘，主要就是看 MOOC 和谢希仁的计算机网络（第7版）"><meta property=og:type content=article><meta property=og:title content=计算机网络备忘><meta property=og:url content=https://justloseit.top/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/index.html><meta property=og:site_name content=动中之动><meta property=og:description content="学习计算机网络时提炼的备忘，主要就是看 MOOC 和谢希仁的计算机网络（第7版）"><meta property=og:locale content=zh_CN><meta property=og:image content=https://justloseit.top/img/index/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98.jpg><meta property=article:published_time content=2020-10-23T16:14:25.000Z><meta property=article:modified_time content=2023-03-03T06:49:24.756Z><meta property=article:author content="Mobilis In Mobili"><meta property=article:tag content=计算机><meta property=article:tag content=网络><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=https://justloseit.top/img/index/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98.jpg><title>计算机网络备忘 - 动中之动</title><link rel=stylesheet href=https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css><link rel=stylesheet href=https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css><link rel=stylesheet href=https://lib.baomitu.com/hint.css/2.7.0/hint.min.css><link rel=stylesheet href=https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css><link rel=stylesheet href=https://lib.baomitu.com/KaTeX/0.16.2/katex.min.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css><link rel=stylesheet href=/css/main.css><link id=highlight-css rel=stylesheet href=/css/highlight.css><link id=highlight-css-dark rel=stylesheet href=/css/highlight-dark.css><script id=fluid-configs>var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"justloseit.top",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:60,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:"§"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:"snI2XNrHrhyx5g84m3Uim3EC-gzGzoHsz",app_key:"x2YseXJIHmvnsM4v9y9UAlvu",server_url:"https://sni2xnrh.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src=/js/utils.js></script><script src=/js/color-schema.js></script><meta name=generator content="Hexo 5.4.2"><link rel=alternate href=/atom.xml title=动中之动 type=application/atom+xml></head><body><header><div class=header-inner style=height:70vh><nav id=navbar class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=/ ><strong>Mobilis In Mobili</strong> </a><button id=navbar-toggler-btn class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"><div class=animated-icon><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto text-center"><li class=nav-item><a class=nav-link href=/ target=_self><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class=nav-item><a class=nav-link href=/archives/ target=_self><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class=nav-item><a class=nav-link href=/categories/ target=_self><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class=nav-item><a class=nav-link href=/tags/ target=_self><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class=nav-item><a class=nav-link href=/about/ target=_self><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class=nav-item><a class=nav-link href=/links/ target=_self><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class=nav-item id=search-btn><a class=nav-link target=_self href=javascript:; data-toggle=modal data-target=#modalSearch aria-label=Search><i class="iconfont icon-search"></i></a></li><li class=nav-item id=color-toggle-btn><a class=nav-link target=_self href=javascript:; aria-label="Color Toggle"><i class="iconfont icon-dark" id=color-toggle-icon></i></a></li></ul></div></div></nav><div id=banner class=banner parallax=true style="background:url(/img/banner/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98.jpg) no-repeat center center;background-size:cover"><div class=full-bg-img><div class="mask flex-center" style=background-color:rgba(0,0,0,.3)><div class="banner-text text-center fade-in-up"><div class=h2><span id=subtitle data-typed-text=计算机网络备忘></span></div><div class=mt-3><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden=true></i> Mobilis In Mobili </span><span class=post-meta><i class="iconfont icon-date-fill" aria-hidden=true></i> <time datetime="2020-10-24 00:14" pubdate>2020年10月24日 凌晨</time></span></div><div class=mt-1><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 21k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 173 分钟 </span><span id=leancloud-page-views-container class=post-meta style=display:none><i class="iconfont icon-eye" aria-hidden=true></i> <span id=leancloud-page-views></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id=board-ctn><div id=board><article class="post-content mx-auto"><h1 id=seo-header>计算机网络备忘</h1><p id=updated-time class="note note-info">本文最后更新于 2023年3月3日 下午</p><div class=markdown-body><p>学习计算机网络时提炼的备忘，主要就是看 MOOC 和谢希仁的计算机网络（第7版）</p><span id=more></span><h1 id=计算机网络备忘><a class=markdownIt-Anchor href=#计算机网络备忘></a> 计算机网络备忘</h1><h2 id=互联网概述><a class=markdownIt-Anchor href=#互联网概述></a> 互联网概述</h2><ul><li><p>互联网：由数量极大的各种计算机网络互连起来而形成的网络。</p><p>两个重要特点：</p><ol><li>连通性(Connectivity) ——上网用户之间可以交换信息</li><li>共享(Sharing)——资源共享</li></ol></li><li><p>网络(计算机网络)：由若干节点(node)和连接这些节点的链路(link)组成【与网络相连的计算机称为主机】<br>互连网(internetwork)：通过路由器将网络互连，构成更大的计算机网络<br>互联网(Internet)：特指世界上最大的、覆盖全球的计算机网络</p><ul><li>互联网服务提供者 ISP：任何机构和个人只要向某个 ISP 交纳规定的费用，就可从该 ISP 获取所需 IP 地址的使用权，并可通过该ISP 接入到互联网；ISP 根据层次可以分成：主干 ISP 、地区 ISP 、本地 ISP 。</li></ul></li><li><p>互联网的标准化：所有互联网标准都以 RFC 的形式在互联网上发表。</p><ul><li>三个阶段：互联网草案(还不是RFC文档)→建议标准(RFC文档)→互联网标准</li></ul></li></ul><h3 id=互联网的组成><a class=markdownIt-Anchor href=#互联网的组成></a> 互联网的组成</h3><h4 id=边缘部分><a class=markdownIt-Anchor href=#边缘部分></a> 边缘部分</h4><ul><li>端系统：连接在互联网上的所有的主机。</li><li>端系统之间的通信方式<ul><li>客户—服务器方式(C/S方式)<ul><li>客户(client) 和服务器(server) 都是指通信中所涉及的两个应用进程</li><li>描述的是进程之间服务和被服务的关系</li><li>客户(被用户调用后运行)是服务的请求方，服务器(一直不断地运行着，被动地等待)是服务的提供方</li></ul></li><li>对等连接(P2P)peer-to-peer<ul><li>对等连接中的每一个主机既是客户又是服务器</li></ul></li></ul></li></ul><h4 id=核心部分><a class=markdownIt-Anchor href=#核心部分></a> 核心部分</h4><ul><li><p>在网络核心部分起特殊作用的是路由器(router)</p></li><li><p>路由器是实现分组交换的关键构件，其任务是转发收到的分组，这是网络核心部分最重要的功能。</p></li><li><p>电路交换：每一部电话都直接连接到交换机上，而交换机使用交换的方法，让电话用户彼此之间可以很方便地通信。</p><ul><li>“交换”就是按照某种方式动态地分配传输线路的资源</li><li>电路交换必然是面向连接的</li><li>电路交换的三个阶段：建立连接→通信→释放连接</li><li>由于计算机数据具有突发性，这导致在传送计算机数据时，通信线路的利用率很低</li></ul></li><li><p>分组交换：采用存储转发技术，步骤如下</p><ol><li>在发送端，先把较长的报文划分成较短的、固定长度的数据段。</li><li>每一个数据段前面添加上首部构成分组(packet)</li><li>分组交换网以“分组”作为数据传输单元，依次把各分组发送到接收端</li><li>最后，在接收端把收到的数据恢复成为原来的报文</li></ol><ul><li>高效、灵活、迅速、可靠，但是会因为分组转发时需要排队而造成一定时延，首部也会造成一定的开销</li><li>类似的有：电报通信的报文交换</li></ul></li><li><p>路由器</p><ul><li>在路由器中的输入和输出端口之间没有直接连线</li><li>处理分组的过程<ul><li>把收到的分组先放入缓存（暂时存储）</li><li>查找转发表，找出到某个目的地址应从哪个端口转发</li><li>把分组送到适当的端口转发出去</li></ul></li><li>路由器在转发分组时最高只用到网际层</li></ul></li></ul><p><strong>互联网核心部分中的路由器之间一般都用高速链路相连接，而在网络边缘的主机接入到核心部分则通常以相对较低速率的链路相连接。</strong></p><p>※：接入网 AN：是从某个用户端系统到互联网中的第一个路由器之间的一种网络，既不属于互联网的核心部分，也不属于互联网的边缘部分</p><ul><li>计算机网络的性能指标：速率、带宽、吞吐率、时延、时延带宽积、往返时间RTT、利用率</li><li>计算机网络的非性能特征：费用、质量、标准化、可靠性、时延带宽积、可扩展性和可升级性、易于管理和维护</li></ul><h3 id=计算机网络的体系结构><a class=markdownIt-Anchor href=#计算机网络的体系结构></a> 计算机网络的体系结构</h3><ul><li><p>开放系统互连参考模型 OSI/RM：一个试图使各种计算机在世界范围内互连成网的标准框架<br>※：法律上的国际标准 OSI 并没有得到市场的认可，非国际标准TCP/IP 却获得了最广泛的应用。</p></li><li><p>网络协议：为进行网络中的数据交换而建立的规则、标准或约定【文字描述和程序代码】</p><ul><li>语法：数据与控制信息的结构或格式</li><li>语义：需要发出何种控制信息，完成何种动作以及做出何种响应</li><li>同步：事件实现顺序的详细说明</li></ul></li></ul><table cellspacing=0 border=0><colgroup width=140></colgroup><colgroup width=202></colgroup><colgroup width=191></colgroup><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>OSI&#30340;&#20307;&#31995;&#32467;&#26500;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>TCP/IP&#30340;&#20307;&#31995;&#32467;&#26500;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#20116;&#23618;&#21327;&#35758;&#30340;&#20307;&#31995;&#32467;&#26500;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#24212;&#29992;&#23618;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" rowspan=3 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#24212;&#29992;&#23618;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" rowspan=3 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#24212;&#29992;&#23618;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#34920;&#31034;&#23618;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#20250;&#35805;&#23618;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#36816;&#36755;&#23618;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#36816;&#36755;&#23618;&#65288;TCP&#25110;UDP&#65289;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#36816;&#36755;&#23618;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#32593;&#32476;&#23618;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#32593;&#32476;&#23618;IP</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#32593;&#32476;&#23618;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#25968;&#25454;&#38142;&#36335;&#23618;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" rowspan=2 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#32593;&#32476;&#25509;&#21475;&#23618;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#25968;&#25454;&#38142;&#36335;&#23618;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#29289;&#29702;&#23618;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#29289;&#29702;&#23618;</font></td></tr></table>- 协议数据单元 PDU：对等层次之间传送的数据单位<p>“对等层”(peer layers)之间的通信：任何两个同样的层次把数据（即数据单元加上控制信息）通过水平虚线直接传递给对方</p><h3 id=协议与服务><a class=markdownIt-Anchor href=#协议与服务></a> 协议与服务</h3><ul><li><p>实体：表示任何可发送或接收信息的硬件或软件进程</p></li><li><p>协议：控制两个对等实体进行通信的规则的集合</p><ul><li><p>在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供<strong>服务</strong></p></li><li><p>要实现本层协议，还需要使用服务原语使用下层所提供的<strong>服务</strong></p><p>※：服务是”垂直的“，协议是”水平的“</p></li></ul></li><li><p>服务访问点 SAP：同一系统相邻两层的实体进行交互的地方<br>服务数据单元 SDU：层与层之间交换的数据的单位【可以和PDU不一样，因为可以组合和划分】</p></li></ul><h2 id=物理层><a class=markdownIt-Anchor href=#物理层></a> 物理层</h2><h3 id=物理层的基本概念><a class=markdownIt-Anchor href=#物理层的基本概念></a> 物理层的基本概念</h3><ul><li><p>主要功能：提供透明比特流传输</p><ul><li>尽可能地屏蔽掉不同传输媒体和通信手段的差异</li><li>只关心比特流的正确搬运，不关心内容</li></ul></li><li><p>特性</p><ol><li>机械特性：接口所用接线器的形状、尺寸、引线数目和排列等</li><li>电气特性：接口电缆的各条线上出现的电压范围</li><li>功能特性：某条线上出现的某一电平的电压表示的意义</li><li>过程（规程，procedure，即物理层的协议）特性：对于不同功能的各种可能事件的出现顺序</li></ol></li></ul><h4 id=数据通信系统的模型><a class=markdownIt-Anchor href=#数据通信系统的模型></a> 数据通信系统的模型</h4><div align=center><img src=/img/post/计算机网络备忘/数据通信系统的模型.png alt=数据通信系统的模型 style=zoom:67%></div><ul><li><p>数据：运送消息的实体</p></li><li><p>信号：数据的电气或者电磁的表现</p></li><li><p>模拟信号：代表消息的参数的取值是连续的</p></li><li><p>数字信号：代表消息的参数的取值是离散的</p></li><li><p>码元：在使用时域的波形表示数字信号是，代表不同离散数值的基本波形</p></li></ul><h5 id=信道一般表示向某一方向发送信息的媒体><a class=markdownIt-Anchor href=#信道一般表示向某一方向发送信息的媒体></a> 信道：一般表示向某一方向发送信息的媒体</h5><ul><li><p>单向通信（单工通信）：只能有一个方向的通信而没有反方向的交互</p></li><li><p>双向交替通信（半双工通信）：通信的双方都可以发送信息，但是不能同时发送</p></li><li><p>双向同时通信（全双工通信）：通信的双方可以同时发送和接收信息</p></li><li><p>基带信号：来自信源的信号</p><ul><li>由于基带信号往往包含较多的低频成分，甚至直流成分，许多信道并不能传输这种低频分量或直流分量。因此必须对基带信号进行调制，一般可以分成两大类<ul><li>基带调制（编码）：基带信号→基带信号（仅变换波形）</li><li>带通调制：使用载波，将信号频率提高，转换为模拟信号，得到<strong>带通信号</strong></li></ul></li></ul></li><li><p>常用编码方式</p><ul><li>不归零制：正电平代表1，负电平代表0</li><li>归零制：正脉冲代表1，负脉冲代表0</li><li>曼切斯特编码：位周期中心的向上跳变代表0，位周期中心的向下跳变代表1（反过来定义也可）</li><li>差分曼切斯特编码：在每一位的钟信处始终都有跳变。位开始边界有跳变代表0，没有跳变代表1</li></ul></li></ul><div align=center><img src=/img/post/计算机网络备忘/数字信号的常用编码方式.png alt=数字信号的常用编码方式 style=zoom:67%></div><p>※：可以从图中看出</p><ol><li>曼彻斯特编码和差分曼彻斯特编码产生的信号频率比不归零制高</li><li>不归零制不能从信号波形本身中提取信号时钟频率（这叫作没有自同步能力），而曼彻斯特编码和差分曼彻斯特编码具有自同步能力</li></ol><ul><li>基本的带通调制方法<ul><li>调幅 AM：载波的振幅随基带数字信号而变化</li><li>调频 FM：载波的频率随基带数字信号而变化</li><li>调相 PM：载波的初始相位随基带数字信号而变化</li></ul></li></ul><div align=center><img src=/img/post/计算机网络备忘/最基本的三种调制方式.png alt=最基本的三种调制方式 style=zoom:67%></div><p>※：技术上更为复杂的多元制的振幅相位混合调制方法可以提高码元，从而提高数据传输率，但是这在进行解调时出错率会增加</p><ul><li><p>信道的极限容量的两个限制因素</p><ul><li><p>信道能够通过的频率范围：【奈氏准则】在假定的理想条件下，为了避免码间串扰，码元的传输速率的上限值——在任何信道中，码元传输的速率是有上限的，否则就会出现码间串扰的问题，从而导致失真</p></li><li><p>信噪比：信噪比就是信号的平均功率和噪声的平均功率之比。常记为 S/N，并用分贝 (dB) 作为度量单位。即：信噪比(dB) = 10 log10(S/N) (dB)<br>【香农公式】带宽受限且有高斯白噪声干扰的信道的极限、无差错的信息传输速率<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>=</mo><mi>W</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy=false>(</mo><mn>1</mn><mo>+</mo><mfrac><mi>S</mi><mi>N</mi></mfrac><mo stretchy=false>)</mo><mo stretchy=false>(</mo><mi>b</mi><mi>i</mi><mi>t</mi><mi mathvariant=normal>/</mi><mi>s</mi><mo separator=true>,</mo><mi>b</mi><mi>p</mi><mi>s</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>C=Wlog_{2}(1+\frac{S}{N})(bit/s,bps)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class="mord mathdefault">o</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.217331em;vertical-align:-.345em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.872331em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.10903em>N</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05764em>S</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose>)</span><span class=mopen>(</span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class=mord>/</span><span class="mord mathdefault">s</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class="mord mathdefault">p</span><span class="mord mathdefault">s</span><span class=mclose>)</span></span></span></span><br>其中：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>W</mi></mrow><annotation encoding=application/x-tex>W</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>W</span></span></span></span> 位信道带宽（<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mi>z</mi></mrow><annotation encoding=application/x-tex>Hz</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class="mord mathdefault" style=margin-right:.04398em>z</span></span></span></span>）;<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi></mrow><annotation encoding=application/x-tex>S</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span></span> 为信道内所传信号的平均功率；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>N</mi></mrow><annotation encoding=application/x-tex>N</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>N</span></span></span></span> 为信道内部的高斯噪声功率</p></li></ul></li></ul><p>※：对于频带宽度已确定的信道，如果信噪比不能再提高了，并且码元传输速率也达到了上限值，那么还可以<strong>用编码的方法让每一个码元携带更多比特的信息量</strong>提高信息的传输速率。</p><p><strong>※ 采样定理（奈奎斯特定理）： <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>=</mo><mi>B</mi><mo>∗</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding=application/x-tex>C=B*log_2n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class="mord mathdefault">o</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault">n</span></span></span></span> ，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>B</mi></mrow><annotation encoding=application/x-tex>B</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05017em>B</span></span></span></span> 为波特率（码率，采样率，符号率，指每秒钟信号变化的次数），<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span> 是比特率 （位传输率、数据传输速率、数字带宽），<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 为调制电平数或者线路的状态数，为 2 的整数倍，但是也有例外</strong></p><h3 id=物理层下面的传输媒体><a class=markdownIt-Anchor href=#物理层下面的传输媒体></a> 物理层下面的传输媒体</h3><ul><li>传输媒体：也称为传输介质或传输媒介，它就是数据传输系统中在发送器和接收器之间的物理通路</li></ul><h4 id=引导型传输媒体电磁波被导引沿着固体媒体铜线或光纤传播><a class=markdownIt-Anchor href=#引导型传输媒体电磁波被导引沿着固体媒体铜线或光纤传播></a> 引导型传输媒体：电磁波被导引沿着固体媒体（铜线或光纤）传播</h4><ul><li><p>双绞线：最常用的传输媒体</p><ul><li>屏蔽双绞线 STP（Shielded Twisted Pair）：带金属屏蔽层</li><li>无屏蔽双绞线 UTP（Unshielded Twisted Pair）<div align=center><img src=/img/post/计算机网络备忘/双绞线.png alt=双绞线 style=zoom:67%></div></li><li>标准：EIA/TIA-568、EIA/TIA-568A（5类线）</li></ul></li><li><p>同轴电缆：具有很好的抗干扰特性性，被广泛用于传输较高速率的数据</p><ul><li>50Ω：LAN/数字传输常用 70Ω：有线电视/模拟传输常用</li></ul></li></ul><div align=center><img src=/img/post/计算机网络备忘/同轴电缆的结构.png alt=同轴电缆的结构 style=zoom:67%></div><ul><li><p>光缆：光纤通信的传输媒体，传输带宽远远大于目前其他各种传输媒体的带宽</p><ul><li><p>多模光纤：可以存在多条不同角度入射的光线在一条光纤中传输</p></li><li><p>单模光纤：光纤的直径减小到只有一个光的波长，光线一直向前传播，而不会产生多次反射</p><div align=center><img src=/img/post/计算机网络备忘/光纤.png alt=光纤 style=zoom:67%></div></li></ul></li></ul><p>※：优点：通信容量非常大；传输损耗小，中继距离长；抗雷电和电磁干扰性能好；无串音干扰，保密性好；体积小，重量轻</p><h4 id=非引导型传输媒体自由空间><a class=markdownIt-Anchor href=#非引导型传输媒体自由空间></a> 非引导型传输媒体：自由空间</h4><ul><li>在自由空间，电磁波的传输常称为无线传输</li><li>短波通信：主要是靠电离层的反射，但短波信道的通信质量较差，传输速率低</li><li>微波在空间主要是直线传播</li><li>传统微波通信有两种方式：地面微博接力通信、卫星通信</li></ul><h3 id=信道复用技术><a class=markdownIt-Anchor href=#信道复用技术></a> 信道复用技术</h3><ul><li>复用：允许用户使用一个共享信道进行通信，降低成本，提高利用率<ul><li>频分复用 FDM (Frequency Division Multiplexing)：将整个带宽分为多份，用户在分配到一定的频带后，在通信过程中自始至终都占用这个频带。<ul><li>频分复用的所有用户在同样的时间占用不同的带宽资源<br>（※：这里的“带宽”是频率带宽而不是数据的发送速率）</li></ul></li></ul></li></ul><div align=center><img src=/img/post/计算机网络备忘/FDM.png alt=FDM style=zoom:67%></div><ul><li><p>时分复用 TDM (Time Division Multiplexing)：是将时间划分为一段段等长的时分复用帧（TDM 帧）。每一个时分复用的用户在每一个 TDM 帧中占用固定序号的时隙。</p><ul><li><p>每一个用户所占用的时隙是周期性出现的，所以 TDM 信号又叫做等时信号</p></li><li><p>时分复用的所有用户是在不同的时间占用同样的频带宽度</p></li><li><p>由于计算机数据的突发性质，用户对分配到的子信道的利用率一般是不高的</p><div align=center><img src=/img/post/计算机网络备忘/TDM.png alt=TDM style=zoom:67%></div></li></ul></li><li><p>统计时分复用 STDM (Statistic TDM)：STDM 帧不是固定分配时隙，而是按需动态地分配时隙。因此统计时分复用可以提高线路的利用率。</p></li><li><p>波分复用 WDM(Wavelength Division Multiplexing)：使用一根光纤来同时传输多个光载波信号，即光的频分复用</p></li><li><p>码分复用 CDM (Code Division Multiplexing)：各用户使用经过特殊挑选的<strong>不同码型</strong>，因此彼此不会造成干扰</p><ul><li><p>码片 (chip)：每一个比特时间划分为 m 个短的间隔</p></li><li><p>每个站被指派一个唯一的 m bit 码片序列<br>eg：发送比特 1，则发送自己的 m bit 码片序列；如发送比特 0，则发送该码片序列的二进制反码<br>这就实现了（直接序列）<strong>扩频</strong> DSSS：假定S站要发送信息的数据率为 b bit/s。由于每一个比特要转换成 m 个比特的码片，因此 S 站实际上发送的数据率提高到 mb bit/s，同时 S 站所占用的频带宽度也提高到原来数值的 m 倍<br>※：还有一种跳频扩频 FHSS</p><ul><li>每个站的码片序列必须各不相同，而且必须相互正交</li><li>任何一个码片向量和他自己规格化内积都是1，和该码片反码的向量的规格化内积是-1</li><li>在实际系统中用的是伪随机码序列</li></ul></li></ul></li></ul><h4 id=一个原理的实例><a class=markdownIt-Anchor href=#一个原理的实例></a> 一个原理的实例</h4><p>设 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding=application/x-tex>m=8</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>8</span></span></span></span>，每个向量为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>8</mn><mi>b</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding=application/x-tex>8bit</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord>8</span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span></span></span></span><br>假设在A站和B站同时向C站发送数据时：</p><p>A站发送数据1:码片向量 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>S</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{S}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mo>−</mo><mn>1</mn><mo separator=true>,</mo><mo>+</mo><mn>1</mn><mo separator=true>,</mo><mo>−</mo><mn>1</mn><mo separator=true>,</mo><mo>−</mo><mn>1</mn><mo separator=true>,</mo><mo>+</mo><mn>1</mn><mo separator=true>,</mo><mo>+</mo><mn>1</mn><mo separator=true>,</mo><mo>−</mo><mn>1</mn><mo separator=true>,</mo><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(-1,+1,-1,-1,+1,+1,-1,-1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>−</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>+</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>+</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>+</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class=mord>1</span><span class=mclose>)</span></span></span></span></p><p>B站发送数据0:码片向量 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>T</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{T}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mo>+</mo><mn>1</mn><mo separator=true>,</mo><mo>+</mo><mn>1</mn><mo separator=true>,</mo><mo>−</mo><mn>1</mn><mo separator=true>,</mo><mo>−</mo><mn>1</mn><mo separator=true>,</mo><mo>+</mo><mn>1</mn><mo separator=true>,</mo><mo>−</mo><mn>1</mn><mo separator=true>,</mo><mo>+</mo><mn>1</mn><mo separator=true>,</mo><mo>+</mo><mn>1</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(+1,+1,-1,-1,+1,-1,+1,+1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>+</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>+</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>+</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>+</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>+</span><span class=mord>1</span><span class=mclose>)</span></span></span></span></p><p>二者在公共信道上会向量复合(两个向量相加)得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mrow><mi>S</mi><mo>+</mo><mi>T</mi></mrow><mo stretchy=true>→</mo></mover></mrow><annotation encoding=application/x-tex>\overrightarrow{S+T}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.28866em;vertical-align:-.08333em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.20533em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span class=svg-align style=top:-3.6833299999999998em><span class=pstrut style=height:3em></span><span class=hide-tail style=height:.522em;min-width:.888em><svg width=400em height=0.522em viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.08333em><span></span></span></span></span></span></span></span></span> 的向量信息，主站收到这个信息后会让它所拥有的所有站的8位码片向量和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mrow><mi>S</mi><mo>−</mo><mi>T</mi></mrow><mo stretchy=true>→</mo></mover></mrow><annotation encoding=application/x-tex>\overrightarrow{S-T}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.28866em;vertical-align:-.08333em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.20533em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span class=svg-align style=top:-3.6833299999999998em><span class=pstrut style=height:3em></span><span class=hide-tail style=height:.522em;min-width:.888em><svg width=400em height=0.522em viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.08333em><span></span></span></span></span></span></span></span></span> 相乘</p><p>结合上述性质推导下列算式:</p><p>比如：码片向量 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>S</mi><mo>⃗</mo></mover><mo>:</mo><mover accent=true><mi>S</mi><mo>⃗</mo></mover><mo>∙</mo><mover accent=true><mrow><mi>S</mi><mo>+</mo><mi>T</mi></mrow><mo stretchy=true>→</mo></mover><mo>=</mo><mfrac><mn>1</mn><mn>8</mn></mfrac><mrow><mo fence=true>(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>8</mn></msubsup><msub><mi>S</mi><mi>i</mi></msub><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>8</mn></msubsup><msub><mi>S</mi><mi>i</mi></msub><msub><mi>T</mi><mi>i</mi></msub><mo fence=true>)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\vec{S} :\vec{S} \bullet \overrightarrow{S+T}=\frac{1}{8}\left(\sum_{i=1}^{8} S_{i} S_{i}-\sum_{i=1}^{8} S_{i} T_{i}\right)=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∙</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.28866em;vertical-align:-.08333em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.20533em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span class=svg-align style=top:-3.6833299999999998em><span class=pstrut style=height:3em></span><span class=hide-tail style=height:.522em;min-width:.888em><svg width=400em height=0.522em viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.08333em><span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.80002em;vertical-align:-.65002em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.845108em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">(</span></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.954008em><span style=top:-2.40029em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.29971000000000003em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.954008em><span style=top:-2.40029em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.29971000000000003em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">)</span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>，则表示 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>S</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{S}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>对应的A站向C站发送了数据1</p><p>同理，向量 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mrow><mo>−</mo><mi>T</mi></mrow><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{-T}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0496599999999998em;vertical-align:-.08333em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>−</span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2355em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.08333em><span></span></span></span></span></span></span></span></span> :<span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>T</mi><mo>⃗</mo></mover><mo>∙</mo><mover accent=true><mrow><mi>S</mi><mo>+</mo><mi>T</mi></mrow><mo stretchy=true>→</mo></mover><mo>=</mo><mfrac><mn>1</mn><mn>8</mn></mfrac><mrow><mo fence=true>(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>8</mn></msubsup><msub><mi>T</mi><mi>i</mi></msub><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>8</mn></msubsup><msub><mi>T</mi><mi>i</mi></msub><msub><mi>T</mi><mi>i</mi></msub><mo fence=true>)</mo></mrow><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\vec{T} \bullet \overrightarrow{S+T}=\frac{1}{8}\left(\sum_{i=1}^{8} T_{i} S_{i}-\sum_{i=1}^{8} T_{i} T_{i}\right)=-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∙</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.28866em;vertical-align:-.08333em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.20533em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span class=svg-align style=top:-3.6833299999999998em><span class=pstrut style=height:3em></span><span class=hide-tail style=height:.522em;min-width:.888em><svg width=400em height=0.522em viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.08333em><span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.80002em;vertical-align:-.65002em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.845108em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">(</span></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.954008em><span style=top:-2.40029em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.29971000000000003em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.954008em><span style=top:-2.40029em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.29971000000000003em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">)</span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>−</span><span class=mord>1</span></span></span></span>，则表示 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>T</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{T}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>对应的B站向C站发送了数据0</p><p>当然对于其他的码片 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>M</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>(代指是除了A站,B站 以外的所有码片)，</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>M</mi><mo>⃗</mo></mover><mo>∙</mo><mover accent=true><mrow><mi>S</mi><mo>−</mo><mi>T</mi></mrow><mo stretchy=true>→</mo></mover><mo>=</mo><mfrac><mn>1</mn><mn>8</mn></mfrac><mrow><mo fence=true>(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>8</mn></msubsup><msub><mi>M</mi><mi>i</mi></msub><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>8</mn></msubsup><msub><mi>M</mi><mi>i</mi></msub><msub><mi>T</mi><mi>i</mi></msub><mo fence=true>)</mo></mrow><mo>=</mo><mn>0</mn><mo>−</mo><mn>0</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>\vec{M} \bullet \overrightarrow{S-T}=\frac{1}{8}\left(\sum_{i=1}^{8} M_{i} S_{i}-\sum_{i=1}^{8} M_{i} T_{i}\right)=0-0=0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∙</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.28866em;vertical-align:-.08333em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.20533em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span class=svg-align style=top:-3.6833299999999998em><span class=pstrut style=height:3em></span><span class=hide-tail style=height:.522em;min-width:.888em><svg width=400em height=0.522em viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.08333em><span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.80002em;vertical-align:-.65002em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.845108em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">(</span></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.954008em><span style=top:-2.40029em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.29971000000000003em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.954008em><span style=top:-2.40029em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.29971000000000003em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">)</span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>0</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span></p><p>这一切都是因为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>M</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>S</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{S}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mover accent=true><mi>T</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{T}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9663299999999999em;vertical-align:0></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9663299999999999em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span><span style=top:-3.25233em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.15216em><span class=overlay style=height:.714em;width:.471em><svg width=0.471em height=0.714em style=width:.471em viewBox="0 0 471 714" preserveAspectRatio=xMinYMin><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>相互正交。</p><p>​</p><h3 id=数字传输系统><a class=markdownIt-Anchor href=#数字传输系统></a> 数字传输系统</h3><h4 id=ptsn-公共交换电话网络><a class=markdownIt-Anchor href=#ptsn-公共交换电话网络></a> PTSN 公共交换电话网络</h4><pre><code class=mermaid>graph LR
A[呼叫方的语音] --&gt;|本地回路| B[端局]
    B --&gt;|干线| C[上级交换局]
    C --&gt;  D[对方的端局]
    D --&gt;E[被叫方]
</code></pre><ul><li><p>PSTN 的主要构成</p><ul><li><p>本地回路：模拟线路——连接端局和千家万户或业务部门</p><ul><li>传输模拟信号，需要调制解调器（数模转换，就是猫，56k）</li><li>突破电话信号的4k限制——宽带服务</li><li>突破物理特性的限制——光纤到户 FTTH</li></ul></li><li><p>干线：数字光纤——连接交换局、端局</p><ul><li><p>使用了复用技术</p><ul><li>SONET/SDH：同步数据传输的标准</li></ul></li><li><p>端局：含有编解码器codec，利用脉冲编码调制 PCM，用于数模转换，构成了现代 PTSN 的核心</p></li></ul></li><li><p>交换局：语音拨接的场所</p><ul><li><p>电路交换：提前分配，容错能力弱，按序，按时间计费</p></li><li><p>包交换：按需分配，容错能力强，乱序，按流量计费</p></li></ul></li></ul></li></ul><h4 id=宽带接入技术><a class=markdownIt-Anchor href=#宽带接入技术></a> 宽带接入技术</h4><ul><li><p>非对称数字用户线 ADSL：用数字技术对现有的模拟电话用户线进行改造，使它能够承载宽带业务（低频用于电话，高频用于上网）</p><ul><li>用户线（铜线）<strong>两端</strong>各安装一个 ADSL 调制解调器</li><li>上行和下行带宽做成不对称的<ul><li>上行指从用户到 ISP，而下行指从 ISP 到用户</li></ul></li><li>采用自适应调制技术使用户线能够传送尽可能高的数据，但是不能保证固定的数据率</li></ul><div align=center><img src="/img/post/计算机网络备忘/基于 ADSL 的接入网的组成.png" srcset="/img/loading.gif" lazyload alt="基于 ADSL 的接入网的组成" style=zoom:67%></div></li></ul><h4 id=光纤同轴混合网hfc网><a class=markdownIt-Anchor href=#光纤同轴混合网hfc网></a> 光纤同轴混合网（HFC网）</h4><ul><li>HFC：在目前覆盖面很广的有线电视网 CATV 的基础上开发的一种居民宽带接入网<ul><li>将原 CATV 网中的同轴电缆主干部分改换为光纤，并使用模拟光纤技术</li><li>每个家庭要安装一个用户接口盒 UIB，提供三种连接</li></ul><div align=center><img src=/img/post/计算机网络备忘/HFC网的结构图.png alt=HFC网的结构图 style=zoom:67%></div></li></ul><h4 id=fttx技术><a class=markdownIt-Anchor href=#fttx技术></a> FTTx技术</h4><ul><li>光纤到……：FTTH、FTTB、FTTC</li></ul><h3 id=物理层设备><a class=markdownIt-Anchor href=#物理层设备></a> 物理层设备</h3><ul><li><p>收发器 Transceiver，MAU</p><ul><li>现在退化成网卡上一个部件</li></ul></li><li><p>中继器 Reapter</p><ul><li>再生信号：去噪、放大，这样可以延伸线缆</li><li>不能过滤流量</li></ul></li><li><p>集线器 Hub：多端口的中继器</p><ul><li>作为星型拓扑的中心</li><li>广播（泛洪）：从除了来的那个端口外的所有其他端口转发出去</li></ul></li><li><p>冲突：信号的碰撞</p><ul><li>冲突域：数据包产生和冲突的网络区域，即共享介质的区域<ul><li>冲突域越大，冲突的可能性越大，网络性能下降</li><li>中继器、集线器扩大了冲突域</li></ul></li></ul></li></ul><h2 id=数据链路层><a class=markdownIt-Anchor href=#数据链路层></a> 数据链路层</h2><h3 id=概述><a class=markdownIt-Anchor href=#概述></a> 概述</h3><ul><li><p>数据链路层：保证数据传输的有效、可靠（差错检测和控制、流量控制）</p></li><li><p>PDU：帧=帧头+载荷+帧尾</p><p>※：物理层：位流 bits ；数据链路层：帧 frame</p></li></ul><h4 id=成帧><a class=markdownIt-Anchor href=#成帧></a> 成帧</h4><ul><li><p>成帧：将原始的位流分散到离散的帧中</p><ul><li><p>字符计数法</p><ul><li>发送方：在每个帧头部的第一个字段，标识该帧的长度，总共有多少字符数</li><li>接收方：通过第一个字段就知道该帧有几个字符啊，在哪里结束帧</li><li>特点：简单，容易实现；但是一旦出错无法恢复</li></ul></li></ul></li><li><p>字节填充的标志字节法</p><ul><li>考虑到重新同步问题，每个帧采用了一个特殊的标记字节（flag）做帧界（帧的开始和结束）</li><li>在数据中的标记字节前面加上<strong>转义符</strong>，防止与帧界混淆</li><li>缺点：任意比特数的帧不适用，须是8位整数倍</li></ul></li><li><p>比特填充的标记比特法</p><ul><li>为了适用于任意比特位数的帧，使用比特填充法</li><li>传输效率更高：标记 flag 占用比特数少</li></ul></li><li><p>物理层编码违例法</p><ul><li>帧界：冗余信号</li></ul></li></ul><h3 id=差错处理概述><a class=markdownIt-Anchor href=#差错处理概述></a> 差错处理概述</h3><ul><li><p>不存在完美的信道，传输总会<strong>出错</strong></p></li><li><p>单个错误、突发错误（集中在一个数据块内）</p></li><li><p>纠错（前向纠错错误）发现错误，从错误中恢复出正确的来。开销大，所以有线传输使用少。</p></li><li><p>检错：只能发现错误，不能从错误中恢复，但是可重传恢复。局域网中主要采用检错码。</p></li><li><p>码字：包含数据位和校验位的 n 位单元（模式）</p></li><li><p>海明距离：两个码字的海明距离等于两个码字之间不同位的数目——可以用异或来计算</p><ul><li>全部码字的海明距离：全部码字中任意两个码字之间海明距离的最小值</li><li>海明距离的意义：如果海明距离为 d，则一个码字需要发生 d 个 1 位错误才能变成另外一个码字</li><li>海明距离与检错位数的关系：海明距离为 d+1 的编码能检测出 d 为差错</li><li>海明距离与纠错位数的关系：海明距离为 2d+1 的编码能检测出 d 为差错</li><li>海明距离增加，纠错能力越强，但是合法码字就减少了，<strong>传输效率会降低</strong></li></ul></li></ul><h3 id=纠-1-位错的海明码><a class=markdownIt-Anchor href=#纠-1-位错的海明码></a> 纠 1 位错的海明码</h3><ul><li><p>纠 1 位错需要的冗余位 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span> 跟数据位 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的关系：<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>m</mi><mo>+</mo><mi>r</mi><mo>+</mo><mn>1</mn><mo stretchy=false>)</mo><mo>≤</mo><msup><mn>2</mn><mi>r</mi></msup></mrow><annotation encoding=application/x-tex>(m+r+1)\leq 2^r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span></span></span></span></p></li><li><p>海明纠错码</p><ul><li><p>每一个码字从左往右编号，<strong>最左边是第一位</strong></p></li><li><p>校验位：凡是编号为 2 的幂次的位。依据包括它自身在内的一些位的集合的奇偶值可以设置。</p></li><li><p>如何决定每个数据位的校验位：将某一数据为的编号展开成 2 的乘幂的和，那么每一项对应的位即为该数据为的校验位（接收方使用）。反过来，校验位的校验集合也包含这些数据位。</p></li><li><p>纠错方法：设置差错计数器 count ，然后逐个检查校验位，每错一个就count+=出错校验位的编号，最后 count 的值就是出错的位编号</p></li><li><p>用于纠正突发错误：数据按行排列成矩阵，然后按列发送。但是能够纠错的突发错误的个数小于等于发送矩阵的行数</p></li></ul></li></ul><h3 id=检错码><a class=markdownIt-Anchor href=#检错码></a> 检错码</h3><h4 id=奇偶检验><a class=markdownIt-Anchor href=#奇偶检验></a> 奇偶检验</h4><p>奇偶位取值等同于对数据位进行模 2 和运算</p><ul><li>能够判断正确的概率是 50%</li></ul><h4 id=互联网校验和><a class=markdownIt-Anchor href=#互联网校验和></a> 互联网校验和</h4><ul><li>校验和：按照 n 位码字进行模 2 加运算</li><li>校验位： 发方追加到报文尾部</li><li>常见：16 位互联网校验和</li></ul><h4 id=循环冗余检错码-crc><a class=markdownIt-Anchor href=#循环冗余检错码-crc></a> 循环冗余检错码 CRC</h4><ul><li><p>工作原理：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 位的帧 = <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>k-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 次的多项式</p></li><li><p>对于发方：生成多项式 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>G(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">G</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 阶数为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 位帧的多项式 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>&gt;</mo><mi>r</mi></mrow><annotation encoding=application/x-tex>m&gt;r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>&gt;</mo><mi>G</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M(x)&gt;G(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">G</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span></p><p>​ 设 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>X</mi><mi>r</mi></msup><mi>M</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mi mathvariant=normal>/</mi><mi>G</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mi>Q</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>+</mo><mi>R</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>X^rM(x)/G(x)=Q(x)+R(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mord>/</span><span class="mord mathdefault">G</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">Q</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span>，则 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msup><mi>X</mi><mi>r</mi></msup><mi>M</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>−</mo><mi>R</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mi mathvariant=normal>/</mi><mi>G</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mi>Q</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(X^rM(x)-R(x))/G(x)=Q(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mclose>)</span><span class=mord>/</span><span class="mord mathdefault">G</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">Q</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span></p><p>​ <strong>发送被除数减去模 2 除法的余数 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>X</mi><mi>r</mi></msup><mi>M</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>−</mo><mi>R</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>X^rM(x)-R(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> ，<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>X</mi><mi>r</mi></msup><mi>M</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>X^rM(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 相当于在数据帧的低端加上 r 个 0</strong></p><p>对于收方：把收到的码字去除生成多项式，如果除得结果为 0 ，则没有发生传输错误</p></li><li><p>生成多项式国际标准：CRC32等</p></li></ul><h3 id=基本数据链路层协议><a class=markdownIt-Anchor href=#基本数据链路层协议></a> 基本数据链路层协议</h3><ul><li><p>假设</p><ol><li>物理层、数据链路层、网络层各自是独立的处理进程</li><li>机器 A 希望向 B 发送的是一个可靠的、面向连接的长数据流</li><li>假设机器不会崩溃</li><li>从网络层拿到的是纯数据</li></ol></li><li><p>几点说明</p><ul><li><p>六个协议共同使用的数据类型、调用的函数过程定义在 protocol.h 中</p></li><li><p>与网络层、物理层之间的数据传送接口</p><ul><li>发送：from_network_layer、to_physical_layer</li><li>接收：from_physical_layer、to_network_layer</li></ul></li><li><p>Wait_for_event 等待某个事件发生：frame_arrival、cksum_err、timeout</p></li><li><p>Timer 计时器作用</p><ul><li>重传定时器：start_timer、stop_timer</li><li>捎带确认定时器：start_ack_timer、stop_ack_timer</li></ul></li><li><p>帧结构</p><figure class="highlight abnf"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><code class="hljs abnf">typedef struct&#123;<br> frame_kind kind<span class=hljs-comment>;</span><br> seq_nr seq<span class=hljs-comment>; # 序号</span><br> seq_nr ack<span class=hljs-comment>; # 确认号</span><br> packet info<span class=hljs-comment>;</span><br>&#125;frame<span class=hljs-comment>;</span><br></code></pre></td></tr></table></figure></li></ul></li></ul><h4 id=协议1无限制的单工协议><a class=markdownIt-Anchor href=#协议1无限制的单工协议></a> 协议1：无限制的单工协议</h4><p>【乌托邦协议】</p><ul><li>假设</li><li>数据单向传送<ul><li>收发双方的网络层都处于就绪状态</li><li>处理时间可忽略不计</li><li>可用的缓存空间无穷大</li><li>假设 DLL 之间的信道永远不会损坏或者丢失帧</li></ul></li></ul><h4 id=协议2单工停等协议><a class=markdownIt-Anchor href=#协议2单工停等协议></a> 协议2：单工停—等协议</h4><ul><li><strong>取消</strong>”接收方允许无限量接收“的假设，解决如何避免收方被涌入的数据淹没的问题</li><li>解决方法：收方回发一个哑帧，接收方收到哑帧，表明收方允许接受数据，此时再次发送下一帧数据</li><li>实际上是半双工协议（因为收方回发哑帧）</li></ul><h4 id=协议3有噪声信道的单工协议><a class=markdownIt-Anchor href=#协议3有噪声信道的单工协议></a> 协议3：有噪声信道的单工协议</h4><ul><li><p>有噪声就会产生差错，有差错就可能会引起以下问题：</p><ul><li>接收方检测到错误帧，如何通知发送方？如何恢复正确帧？<ul><li>对正确帧的确认</li><li>定时器超期：重传</li><li>重传定时器可防止死锁的产生</li></ul></li><li>数据帧或确认帧再途中丢失将如何解决？<ul><li>定时器超期：重传</li></ul></li><li>有可能收到重复帧，如何解决？<ul><li>给每个帧一个独一无二的序列号</li><li>序号也拿来重组排序</li></ul></li></ul></li><li><p>主动确认重传：接收方无误，回发确认帧</p><ul><li>PAR/ARQ的基本工作机制<ul><li>发送方每发出一个帧，就启动一个重传定时器<ul><li>超时前，如果接收到收方的确认，拆除定时器</li><li>超时未得到确认，重传，重置定时器</li></ul></li></ul></li></ul></li><li><p>如何进一步提高数据传输效率？</p><ul><li>全双工</li><li>捎带确认：将确认暂时延迟以便可以钩到一个外发的数据帧（s.ack）<ul><li>如无法”捎带“，当一个控制捎带确认的定时器超时后，单独发确认帧</li></ul></li><li>批发数据：在等待的时间发送数据帧</li></ul></li></ul><h4 id=协议4w1-的滑窗协议><a class=markdownIt-Anchor href=#协议4w1-的滑窗协议></a> 协议4：W=1 的滑窗协议</h4><ul><li><p>两个窗口</p><ul><li>发送窗口：对应着<strong>已经发送但还未被确认</strong>的帧的序号</li><li>接收窗口：对应着<strong>期望接受</strong>的帧的序号</li></ul></li><li><p>窗口滑动的条件</p><ul><li>接收方：收到帧后，首先核对是否为 frame_expected，如果是的，那么接受并 frame_expected+1</li><li>发送方：收到<strong>应答帧</strong>，核对响应帧号 next_frame_to_send，核对无误后，从网络层取出新的帧，并 next_frame_to_send+1</li></ul></li><li><p>滑动窗口的基本概念</p><ul><li>每个待发送帧被赋予一个序列号 seq，取值在 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>[</mo><mn>0</mn><mo separator=true>,</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>[0,2^n-1]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>[</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>]</span></span></span></span>（n 位字段）</li><li>建立缓冲区<ul><li>发送窗口：缓存已发送，待确认的帧 W</li><li>接受窗口：缓存期待接受的帧（序号）</li></ul></li></ul></li><li><p>协议 4 的滑动窗口的基本工作原理</p><ul><li>窗口设置<ul><li>滑动窗口最大值：MAX_SEQ=1</li><li>通信双方的初始值：seq=0、ack=1（期待接收 seq=0）</li></ul></li><li>窗口滑动机制<ul><li>A 首先发送数据帧（seq=0，ack=1，A0）</li><li>B 收到 A0，发送捎带确认帧（seq=0，ack=0，B0）</li><li>A收到对 A0 的确认，滑动窗口，发送帧（seq=1，ack=0，A1）</li></ul></li></ul></li><li><p>协议 4 的滑动窗口特点</p><ul><li>序列号 seq 和确定值 ack 在 0，1交替</li><li>滑动窗口长度 W=1，收到确认后才移动窗口</li><li>保证按顺序将接收到的正确帧只一次上交网络层</li></ul></li><li><p>协议 4 的信道利用率</p><ul><li><p>由于协议 4 中忽略了：接收方处理到达帧的时间，事实上，发送方在来回时间 RTT 时处在 blocked 状态</p></li><li><p>如果信道传输速率是 b bps，每帧的大小是 k bits，来回时间是 R sec</p><p>则信道的利用率是：Line Utilization Rate = <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mi mathvariant=normal>/</mi><mo stretchy=false>(</mo><mi>k</mi><mo>+</mo><mi>b</mi><mi>R</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>k/(k+bR)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mord>/</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mclose>)</span></span></span></span></p></li><li><p>提高信道利用率的方法</p><ul><li><p>增加滑动窗口最大长度 W</p><p>信道利用率 = <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>W</mi><mo>∗</mo><msub><mi>T</mi><mi>f</mi></msub><mi mathvariant=normal>/</mi><mo stretchy=false>(</mo><msub><mi>T</mi><mi>f</mi></msub><mo>+</mo><mi>R</mi><mo stretchy=false>)</mo><mo>=</mo><mi>W</mi><mo>∗</mo><mi>k</mi><mi mathvariant=normal>/</mi><mo stretchy=false>(</mo><mi>k</mi><mo>+</mo><mi>b</mi><mi>R</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>W*T_f/(T_f+R)=W*k/(k+bR)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.10764em>f</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mord>/</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.10764em>f</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mord>/</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mclose>)</span></span></span></span></p><p><strong>Q：怎样找到一个合适的 W 值？</strong></p><p>A：信道上的容量：一帧从发送方传输到接收期间可容纳的帧数量</p><p>带宽-延迟积：BD</p><p>窗口值：W=2*BD+1</p></li></ul></li></ul></li><li><p>面临的问题：连续发个数据帧，其中有一帧出错，但是后续帧被成功发送</p><ul><li>丢弃错帧及后续帧——协议 5</li><li>丢弃错帧，缓存后续正确帧——协议 6</li></ul></li></ul><h4 id=协议-5回退-n-帧的滑窗协议><a class=markdownIt-Anchor href=#协议-5回退-n-帧的滑窗协议></a> 协议 5：回退 n 帧的滑窗协议</h4><ul><li>工作原理<ul><li>发送方<ul><li>正常发送：对帧编号，待确认帧缓存</li><li>收到确认：释放确认帧所占缓存，滑动发送窗口</li><li>差错帧超时时间到：回退到超时帧，顺序重传最后被确认帧以后的缓冲区中缓存的帧</li><li>发送窗口：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>W</mi><mo>≤</mo><mi>M</mi><mi>A</mi><mi>X</mi><mi mathvariant=normal>_</mi><mi>S</mi><mi>E</mi><mi>Q</mi></mrow><annotation encoding=application/x-tex>W\leq MAX\_SEQ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8193em;vertical-align:-.13597em></span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.99333em;vertical-align:-.31em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mord style=margin-right:.02778em>_</span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class="mord mathdefault">Q</span></span></span></span></li></ul></li><li>接收方<ul><li>收到<strong>每一个</strong>期望的正确帧：上交网络层、会送确认【累计确认】</li><li>收到出错帧：丢弃，回发最后一个正确的帧的确认</li><li>接收窗口：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>W</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>W=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></li></ul></li></ul></li></ul><h4 id=协议-6选择性重传><a class=markdownIt-Anchor href=#协议-6选择性重传></a> 协议 6：选择性重传</h4><ul><li><p>工作原理</p><ul><li>发送方<ul><li>正确发送：对帧标号，待确认帧缓存</li><li>收到确认：释放确认帧所占缓存，滑动发送窗口</li><li>差错帧超时时间到：重传缓存的最后被确认帧以后的那一帧</li></ul></li><li>接收方<ul><li>正常接收：上交网络层，回信确认，滑动接收窗口</li><li>收到非期望的正确帧：<strong>缓存</strong>，回送对接收最后正确帧的确认</li><li>收到重传帧：<strong>将缓存帧排序上交</strong>，回送确认，话哦的那个接收窗口</li></ul></li></ul></li><li><p>否定确认 NAK：可以加快重传节奏</p></li><li><p>与协议 5 对比</p></li></ul><table><thead><tr><th></th><th>回退 n 帧</th><th>选择性重传</th></tr></thead><tbody><tr><td>缓冲区</td><td>发送方</td><td>接收方</td></tr><tr><td>适用网络环境</td><td>出错率小</td><td>出错率大</td></tr></tbody></table><ul><li><p>协议 6 中，滑动窗口长度 W 的选择</p><p>接收窗口：W=（MAX_SEQ+1）/2</p><p>发送窗口通常小于接收窗口</p></li><li><p>3 个协议的窗口大小</p></li></ul><table><thead><tr><th></th><th>协议 4：滑动窗口</th><th>协议 5：回退 n 帧</th><th>协议 6：选择性重传</th></tr></thead><tbody><tr><td>发送窗口（SWnd）</td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>S</mi><mi>W</mi><mi>n</mi><mi>d</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>0&lt;SWnd\leq1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68354em;vertical-align:-.0391em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83041em;vertical-align:-.13597em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>S</mi><mi>W</mi><mi>n</mi><mi>d</mi><mo>≤</mo><mi>M</mi><mi>A</mi><msub><mi>X</mi><mi>S</mi></msub><mi>E</mi><mi>Q</mi></mrow><annotation encoding=application/x-tex>0&lt;SWnd\leq MAX_SEQ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68354em;vertical-align:-.0391em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83041em;vertical-align:-.13597em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05764em>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class="mord mathdefault">Q</span></span></span></span></td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mo>≤</mo><mi>S</mi><mi>W</mi><mi>n</mi><mi>d</mi><mo>≤</mo><mi>R</mi><mi>w</mi><mi>n</mi><mi>d</mi></mrow><annotation encoding=application/x-tex>0\leq SWnd\leq Rwnd</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78041em;vertical-align:-.13597em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83041em;vertical-align:-.13597em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class="mord mathdefault" style=margin-right:.02691em>w</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span></span></span></span></td></tr><tr><td>接收窗口（Rwnd）</td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi><mi>W</mi><mi>n</mi><mi>d</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>RWnd=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi><mi>W</mi><mi>n</mi><mi>d</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>RWnd=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi><mi>W</mi><mi>n</mi><mi>d</mi><mo>=</mo><mo stretchy=false>(</mo><mi>M</mi><mi>A</mi><msub><mi>X</mi><mi>S</mi></msub><mi>E</mi><mi>Q</mi><mo>+</mo><mn>1</mn><mo stretchy=false>)</mo><mi mathvariant=normal>/</mi><mn>2</mn></mrow><annotation encoding=application/x-tex>RWnd=(MAX_SEQ+1)/2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class="mord mathdefault" style=margin-right:.13889em>W</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05764em>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class=mord>/</span><span class=mord>2</span></span></span></span></td></tr></tbody></table><h2 id=介质访问控制子层><a class=markdownIt-Anchor href=#介质访问控制子层></a> 介质访问控制子层</h2><h3 id=mac-子层概述><a class=markdownIt-Anchor href=#mac-子层概述></a> MAC 子层概述</h3><ul><li>数据通信方式<ul><li>单播：一对一</li><li>广播：一对所有（局域网）</li><li>组播：一对组</li></ul></li><li>广播网络面临的问题：多路访问信道的分配</li><li>怎么分配信道（介质访问控制）<ul><li>静态分配：预先分配给各用户<ul><li>FDM 和 TDM 就是信道的静态分配的例子</li><li>缺点：资源分配不合理、有资源的浪费、延迟时间增大 N 倍</li><li>适用于：用户少且数目固定、通信量大且流量稳定的情况</li></ul></li><li>动态分配：信道开放，按需分配<ul><li>多路访问协议<ul><li>随机访问协议</li><li>受控访问协议</li></ul></li></ul></li></ul></li></ul><h3 id=aloha-协议><a class=markdownIt-Anchor href=#aloha-协议></a> ALOHA 协议</h3><ul><li>ALOHA 协议是随机访问协议</li></ul><h4 id=纯-aloha-协议><a class=markdownIt-Anchor href=#纯-aloha-协议></a> 纯 ALOHA 协议</h4><ul><li><p>工作原理</p><ul><li>生成帧后即可发送</li><li>检测信道，判断是否发送成功</li><li>如果冲突，则重发</li><li><strong>任性，想法就发</strong></li></ul></li><li><p>信道衡量指标</p><ul><li>吞吐率 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi></mrow><annotation encoding=application/x-tex>S</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span></span> ：在发送时间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>T</mi></mrow><annotation encoding=application/x-tex>T</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span></span> 内发送成功的平均帧数</li><li>运载负载 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span>：时间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>T</mi></mrow><annotation encoding=application/x-tex>T</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span></span> 内所有通信站总共发送的帧的平均值</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>P_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>：一帧发送成功的概率<ul><li>冲突危险期：<ul><li>时间长度：<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>2</mn><mi>t</mi></mrow><annotation encoding=application/x-tex>2t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span><span class="mord mathdefault">t</span></span></span></span></li><li>生成帧的均值：<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>2</mn><mi>G</mi></mrow><annotation encoding=application/x-tex>2G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>2</span><span class="mord mathdefault">G</span></span></span></span></li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mo>=</mo><mi>G</mi><mo>∗</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>S=G*P_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></li><li>在 2t 的时间内都不产生新帧： <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>G</mi></mrow></msup></mrow><annotation encoding=application/x-tex>P_0=e^{-2G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8413309999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413309999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span><span class="mord mathdefault mtight">G</span></span></span></span></span></span></span></span></span></span></span></span><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi><mo>=</mo><mn>0.5</mn><mspace width=1em><msub><mi>S</mi><msub><mn>0</mn><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></msub><mo>=</mo><mn>18.4</mn></mspace></mrow><annotation encoding=application/x-tex>G=0.5\quad S_{0_{max}}=18.4%</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.93343em;vertical-align:-.2501em></span><span class=mord>0</span><span class=mord>.</span><span class=mord>5</span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285719em><span style=top:-2.357em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mord>8</span><span class=mord>.</span><span class=mord>4</span></span></span></span></li></ul></li></ul></li></ul></li></ul></li></ul><h4 id=分隙-aloha><a class=markdownIt-Anchor href=#分隙-aloha></a> 分隙 ALOHA</h4><ul><li><p>工作原理</p><ul><li><p>把时间分成时隙——时隙长度对应一帧的传输时间</p></li><li><p>新帧随机产生，但是<strong>不允许随机发送</strong>，发送必须在<strong>时隙的起点</strong></p><ul><li>所以冲突发送只会发生在起点</li></ul></li></ul></li><li><p>性能分析</p><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>G</mi></mrow></msup></mrow><annotation encoding=application/x-tex>P_0=e^{-G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8413309999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413309999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">G</span></span></span></span></span></span></span></span></span></span></span></span><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi><mo>=</mo><mn>1</mn><mspace width=1em><msub><mi>S</mi><msub><mn>0</mn><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></msub><mo>=</mo><mn>36.8</mn></mspace></mrow><annotation encoding=application/x-tex>G=1\quad S_{0_{max}}=36.8%</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.93343em;vertical-align:-.2501em></span><span class=mord>1</span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285719em><span style=top:-2.357em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>3</span><span class=mord>6</span><span class=mord>.</span><span class=mord>8</span></span></span></span></li></ul></li></ul></li></ul><h3 id=csma-协议><a class=markdownIt-Anchor href=#csma-协议></a> CSMA 协议</h3><ul><li>改进的 ALOHA 协议</li><li>特点：先听后发</li></ul><h4 id=非持续式载波侦听多路访问协议><a class=markdownIt-Anchor href=#非持续式载波侦听多路访问协议></a> 非持续式——载波侦听多路访问协议</h4><ul><li>侦听介质空闲：发帧</li><li>侦听介质繁忙：等待随机时间后<strong>重新侦听</strong></li></ul><h4 id=非持续式载波侦听多路访问协><a class=markdownIt-Anchor href=#非持续式载波侦听多路访问协></a> 非持续式——载波侦听多路访问协</h4><ul><li><p>侦听介质空闲：发帧</p></li><li><p>侦听介质繁忙：<strong>持续侦听</strong></p></li><li><p>问题：如果同时侦听，那么空闲时后会同时发送导致冲突</p></li></ul><h5 id=p-持续式><a class=markdownIt-Anchor href=#p-持续式></a> p-持续式</h5><ul><li><p>侦听介质空闲：以 p 的概率发帧</p></li><li><p>侦听介质繁忙：<strong>持续侦听</strong></p></li><li><p>问题：如果同时侦听，那么空闲时后会同时发送导致冲突</p></li></ul><h4 id=冲突窗口><a class=markdownIt-Anchor href=#冲突窗口></a> 冲突窗口</h4><ul><li><p>定义：发送冲突时间的上限，即发送站发出帧后能检测到碰撞的最长时间，数值上等于最远两站的传播时间的两倍</p></li><li><p>公式：</p><p>物理信道长度 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span></p><p>信道在物理信道上的传播速度 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>v</mi></mrow><annotation encoding=application/x-tex>v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03588em>v</span></span></span></span></p><p>网卡延时 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>t</mi><mrow><mi>P</mi><mi>H</mi><mi>Y</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{PHY}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76508em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span><span class="mord mathdefault mtight" style=margin-right:.08125em>H</span><span class="mord mathdefault mtight" style=margin-right:.22222em>Y</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>N</mi></mrow><annotation encoding=application/x-tex>N</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>N</span></span></span></span> 个中继器，每个中继器延迟时间位 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>t</mi><mtext>中继器</mtext></msub></mrow><annotation encoding=application/x-tex>t_{\text{中继器}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76508em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">中继器</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p><p>则冲突窗口时间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mi>l</mi><mi>o</mi><mi>t</mi><mspace width=1em><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>=</mo><mn>2</mn><mo>∗</mo><mo stretchy=false>(</mo><mi>s</mi><mi mathvariant=normal>/</mi><mi>v</mi><mo>+</mo><msub><mi>t</mi><mrow><mi>P</mi><mi>H</mi><mi>Y</mi></mrow></msub><mo>+</mo><mi>N</mi><mo>∗</mo><msub><mi>t</mi><mtext>中继器</mtext></msub><mo stretchy=false>)</mo></mspace></mrow><annotation encoding=application/x-tex>Slot\quad time =2*(s/v+t_{PHY}+N*t_{\text{中继器}})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class=mspace style=margin-right:1em></span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">s</span><span class=mord>/</span><span class="mord mathdefault" style=margin-right:.03588em>v</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.76508em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span><span class="mord mathdefault mtight" style=margin-right:.08125em>H</span><span class="mord mathdefault mtight" style=margin-right:.22222em>Y</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">中继器</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p></li></ul><h4 id=csmacd-1-持续><a class=markdownIt-Anchor href=#csmacd-1-持续></a> CSMA/CD (1-持续)</h4><ul><li>先听后发，变发边听</li><li>工作原理<ul><li>侦听介质空闲：发帧</li><li>侦听介质繁忙：持续侦听，一旦空闲立即发送</li><li>如果发生冲突，等待一个随机分布的时间再重新侦听</li></ul></li><li>特点<ul><li>所有工作站在发送的同时也接收自己的信号，监测发送的情况，一旦收到的信号与发出的<strong>不一致</strong>，就说明发生了冲突</li><li>发送站感知冲突后立即停止帧的发送，并且发一个简短的<strong>堵塞信号（强化冲突信号）</strong>，通知各工作站已经发生冲突，所有站都等待一段随机分布的时间，然后再按 CSMA/CD 方式重发帧</li></ul></li></ul><h4 id=冲突的检测和处理><a class=markdownIt-Anchor href=#冲突的检测和处理></a> 冲突的检测和处理</h4><ul><li>冲突检测的要求<ol><li>时隙宽度=最大冲突检测时间：保证一个时隙内能够检测到最远距离的冲突</li><li>发送有效帧的时间 &gt;= 最大冲突检测时间：防止因在发生冲突时已完成短帧发送而造成的异常情况</li></ol></li></ul><h3 id=以太网概述><a class=markdownIt-Anchor href=#以太网概述></a> 以太网概述</h3><ul><li>经典以太网</li><li>交换式以太网：广泛使用</li></ul><h4 id=ieee-以太网命名规则><a class=markdownIt-Anchor href=#ieee-以太网命名规则></a> IEEE 以太网命名规则</h4><ul><li><p>10Base2</p><ul><li>10：传输带宽（Mbps）</li><li>Base：基带传输</li><li>2：支持的分段长度</li></ul></li><li><p>10Base-TX</p><ul><li>T：铜制非屏蔽双绞线</li><li>F：表示光缆</li></ul></li></ul><h4 id=以太网工作站接收数据流程图><a class=markdownIt-Anchor href=#以太网工作站接收数据流程图></a> 以太网工作站接收数据流程图</h4><p><img src=img%5C%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%B7%A5%E4%BD%9C%E7%AB%99%E6%8E%A5%E6%94%B6%E6%95%B0%E6%8D%AE%E6%B5%81%E7%A8%8B%E5%9B%BE.png alt=以太网工作站接收数据流程图></p><h4 id=二进制指数后退算法><a class=markdownIt-Anchor href=#二进制指数后退算法></a> 二进制指数后退算法</h4><p><strong>Q：发送方在检测到冲突后，双方（或多方）都将延时一段时间，那么这段时间到底是多长？</strong></p><p>A：冲突检测到后，时间被分成离散的时隙</p><ul><li>时隙的长度等于信号在介质上来回传输时间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>51.2</mn><mi>μ</mi><mi>s</mi><mi>h</mi><mi>e</mi></mrow><annotation encoding=application/x-tex>51.2μshe</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord>5</span><span class=mord>1</span><span class=mord>.</span><span class=mord>2</span><span class="mord mathdefault">μ</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span></span></span></span></li><li>一般地，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span></span></span></span> 次冲突后，等待的时隙数将从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>（</mi><mn>0</mn><mo>∼</mo><msup><mn>2</mn><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=normal>）</mi><mo>×</mo><mn>51.2</mn><mi>μ</mi><mi>s</mi></mrow><annotation encoding=application/x-tex>（0 ∼2^{i-1}）×51.2μs</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class="mord cjk_fallback">（</span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∼</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.907994em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.824664em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">）</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>5</span><span class=mord>1</span><span class=mord>.</span><span class=mord>2</span><span class="mord mathdefault">μ</span><span class="mord mathdefault">s</span></span></span></span> 中随机选择。</li></ul><h3 id=以太网帧><a class=markdownIt-Anchor href=#以太网帧></a> 以太网帧</h3><h4 id=ieee-8023和以太网帧的比较><a class=markdownIt-Anchor href=#ieee-8023和以太网帧的比较></a> IEEE 802.3和以太网帧的比较</h4><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/IEEE802.3%E5%92%8C%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%B8%A7%E7%9A%84%E6%AF%94%E8%BE%83.png alt=IEEE802.3和以太网帧的比较></p><h4 id=帧结构的各个字段含义><a class=markdownIt-Anchor href=#帧结构的各个字段含义></a> 帧结构的各个字段含义</h4><ul><li><p>前导码与帧起始字段</p><ul><li>前导码：7个字节，10101010…101010比特序列</li><li>帧起始符：1字节，10101011</li></ul></li><li><p>目的地址和源地址字段</p><ul><li><p>地址字段长度：48位（6个字节）</p></li><li><p>目的地址类型：</p><ul><li>单一结点地址（unicast address）</li><li>组播地址（multicast address）</li><li>广播地址（broadcast address）</li></ul></li><li><p>物理地址（MAC地址）</p><ul><li><p>地址数约 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>7</mn><mi>X</mi><mn>1</mn><msup><mn>0</mn><mn>13</mn></msup></mrow><annotation encoding=application/x-tex>7 X 10^{13}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord>7</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mord>1</span><span class=mord><span class=mord>0</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span>，7万亿个。</p></li><li><p>Ethernet地址= Manufacture ID + NIC ID=24bit (OUI)+ 24bit</p></li><li><p>表示方法：- : .</p></li><li><p>具有<strong>全球唯一性</strong></p></li></ul></li></ul></li><li><p>长度字段（DIX以太帧中变为：类型）</p><ul><li>帧的最小长度为64字节，最大长度为1518字节，不包括前导码</li><li>在DIX以太帧中，type 字段指明上层网络协议的了类型</li><li>在IEEE 802.3帧中，length 字段指明了携带的数据的长度</li></ul></li><li><p>数据字段</p><ul><li>LLC数据字段是帧的数据字段，长度最小为46个字节<ul><li>如果少于46个字节，需要填充。</li></ul></li></ul></li><li><p>帧校验字段：采用32位的CRC校验</p><ul><li>校验范围：目的/源地址、长度、LLC数据等字段</li></ul></li></ul><blockquote><p><strong>Q：怎么区分到底代表类型还是长度呢？</strong></p><p>A：检查这个字段的数值：如果小于等于1536(0x600)，则是长度（802.3）字段，如果大于1536，则表示类型（以太帧）</p><p><strong>Q：为什么有效帧长度最小为64 Byte</strong></p><p>A：CSMA/CD的要求——最短帧的发送时间&gt;=争用时隙 2t，以太网（802.3）规定，在10Mbps局域网中：时隙：2t= 51.2 微秒，最短帧长度：10Mbps×2t/8 = 64 Byte</p></blockquote><h3 id=二层交换><a class=markdownIt-Anchor href=#二层交换></a> 二层交换</h3><h4 id=问题引入><a class=markdownIt-Anchor href=#问题引入></a> 问题引入</h4><blockquote><p><strong>Q：为什么需要二层交换</strong></p><p>A：有很多LAN，可用网桥（bridges）将它们连接起来</p></blockquote><ul><li>网桥工作在DLL层，通过检查MAC地址做出转发帧的决策，不会检查网络层</li></ul><blockquote><p><strong>Q：谁来完成二层交换？</strong></p><p>A：网桥/交换机</p></blockquote><h4 id=透明的网桥><a class=markdownIt-Anchor href=#透明的网桥></a> 透明的网桥</h4><ul><li>通过透明网桥将多个LAN连接起来，硬件和软件不需要做任何的变化</li><li>透明网桥工作在<strong>混杂模式</strong>，它接收所有跟它相联的LAN的帧</li><li>当一个帧到达网桥时，它必须作出丢弃还是转发的决策，如果是转发，它还要知道向哪个LAN转发<ul><li>决策是通过在网桥内部的一张地址表中查找目的MAC地址而作出的</li></ul></li><li><strong>网桥/交换机隔离了冲突域</strong></li></ul><h5 id=维护转发表><a class=markdownIt-Anchor href=#维护转发表></a> 维护转发表</h5><ul><li>初始时，这张表是空的</li><li>扩散算法（泛洪算法）：当网桥不知道目的地址时（表中查不到），它会将这帧从除来的LAN外的所有LAN转发出去</li><li>逆向学习：网桥从到达帧的源地址认识到源地址对应的那台机是在帧来的那个LAN上，所以，把它写入MAC地址表</li></ul><p>※：<strong>但是拓扑是变化的，网桥怎样适应这种变化？</strong></p><ul><li>无论何时，凡往表中加入记录，也必须同时打下<strong>时戳</strong></li><li>到达帧的源地址在表中已有记录，将时戳<strong>更新</strong>为当前时间</li><li>网桥周期性地扫描表，将那些超时的记录从表中<strong>删除</strong></li></ul><h4 id=网桥工作原理><a class=markdownIt-Anchor href=#网桥工作原理></a> 网桥工作原理</h4><ul><li>当一帧到达时，网桥启动如下算法<ol><li>如果源LAN和目的LAN相同，则丢弃该帧；</li><li>如果源LAN和目的LAN不同，则转发该帧；</li><li>如果目的LAN未知，则广播该帧。</li><li>每当一帧到达，上述算法都将执行一遍</li></ol></li></ul><h3 id=生成树协议><a class=markdownIt-Anchor href=#生成树协议></a> 生成树协议</h3><ul><li><p>为了可靠，采用冗余结构；但是透明网桥会产生无休止循环的问题</p><ul><li>冗余交换拓扑可能带来的问题<ol><li>广播风暴</li><li>多帧传送</li><li>MAC地址库不稳定</li></ol></li></ul></li><li><p>生成树协议：STP（spanningtree protocol）</p><ul><li>新标准：RSTP</li></ul></li><li><p>STP的运作</p><ul><li>每个网络一个根网桥</li><li>每个网桥一个根端口</li><li>每网段一个指定端口</li><li>非指定端口不被使用</li></ul></li></ul><p>※：生成树算法，生成在逻辑上无回路的树，即生成树</p><ul><li><p>生成树算法能在有物理回路的网络中，生成一棵没有逻辑回路的生成树，但并<strong>不能保证其中的路径是最优的</strong></p></li><li><p>当逻辑STP树上的某点出故障了，非指定端口将会被重新启用</p></li></ul><h3 id=虚拟局域网><a class=markdownIt-Anchor href=#虚拟局域网></a> 虚拟局域网</h3><ul><li><p>虚拟局域网（VLAN）：一组<strong>逻辑上</strong>的设备或用户，这些设备和用户<strong>不受物理位置的限制</strong>，相互之间的通信就好像它们在同一个网段中一样</p><ul><li>一个VLAN对应一个广播域</li><li>有了VLAN，可使用二层交换机实现广播域的分割</li></ul></li><li><p>实现方法</p><ul><li>基于端口（最常用）</li><li>基于MAC地址</li><li>基于三层协议</li></ul></li><li><p>IEEE 802.1Q 标准：1998年颁布的一种帧标记方法：VLAN ID</p><ul><li>通过trunk的时候使用</li></ul></li></ul><h3 id=二层设备><a class=markdownIt-Anchor href=#二层设备></a> 二层设备</h3><h4 id=nic-网卡><a class=markdownIt-Anchor href=#nic-网卡></a> NIC 网卡</h4><ul><li><p>NeworkInterface Card</p><ul><li><p>为主机提供介质的访问</p></li><li><p>MAC地址烧在网卡的ROM中</p></li></ul></li><li><p>功能</p><ul><li>Logical link control (LLC): 和上层通信</li><li>Naming: 提供一个独特的MAC 地址标识符</li><li>Framing: 封装过程的一部分，为传输比特流打包</li><li>Media Access Control (MAC): 为访问共享介质提供访问策略</li><li>Signaling:创建信号和与介质的接口</li></ul></li><li><p>运作</p><ul><li>第一层设备<ul><li>创建信号和与介质的接口</li><li>内建转发器</li></ul></li><li>主要是第二层的设备<ul><li>在计算机中与上层通信</li><li>烧入芯片的 MAC 地址</li><li>封装数据城帧</li><li>提供介质访问</li></ul></li></ul></li></ul><h4 id=网桥><a class=markdownIt-Anchor href=#网桥></a> 网桥</h4><ul><li>连接不同的 LAN 网段。</li><li>通过过滤部分交通流量，减少冲突的机会，改善网络性能。</li><li>以 LAN 段分流交通，基于 MAC 地址过滤流量</li></ul><h4 id=交换机><a class=markdownIt-Anchor href=#交换机></a> 交换机</h4><ul><li>交换机：多端口的网桥</li></ul><h5 id=lan交换机中地址表的维护><a class=markdownIt-Anchor href=#lan交换机中地址表的维护></a> LAN交换机中地址表的维护</h5><ul><li>动态更新<ul><li>直接读取数据包中的源地址信息，存入CAM，如在CAM中没有找到所需的地址，添加到CAM中删除过时的地址记录：</li></ul></li><li>时间标记<ul><li>每增加一条记录，为它打上时间标记</li><li>每引用或找到某条记录，为它打上新的时间标记</li><li>当某条地址记录超过一定时间没被引用，则删除它</li></ul></li></ul><h5 id=交换机的工作原理><a class=markdownIt-Anchor href=#交换机的工作原理></a> 交换机的工作原理</h5><ul><li>flooding：当目的地址未知或为广播地址时，桥发送帧到除源端口之外的每个端口</li><li>learning：通过读取每个帧的源地址和对应源端口来学习连在网段上的每个设备的地址</li><li>forwarding：对于已学到的目的地址，桥将直接发送帧到对应的目的设备所在端口</li><li>filtering：如果目的地址和源地址在同一端口，桥将丢掉帧</li></ul><h5 id=交换机的作用><a class=markdownIt-Anchor href=#交换机的作用></a> 交换机的作用</h5><ul><li>使网络段处于无冲突环境</li><li>LAN 交换机利用现有硬件设备</li><li>使配置和管理更加灵活方便</li></ul><h5 id=交换机的特点><a class=markdownIt-Anchor href=#交换机的特点></a> 交换机的特点</h5><ul><li>无冲突域<ul><li>微分段：LAN 被交换机分隔开的网段，在一个大的冲突域中产生无冲突域</li><li>虚拟线路：在交换机内部把段连接成一个虚拟网络的电路，只在需要时才成立</li></ul></li></ul><h5 id=交换机的交换模式><a class=markdownIt-Anchor href=#交换机的交换模式></a> 交换机的交换模式</h5><ul><li>存储转发：读完，计算校验再发送<ul><li>延迟大</li><li>出错率小</li></ul></li><li>直通交换（贯穿）：读到目的 MAC 地址就发送<ul><li>延迟小</li><li>出错率大</li></ul></li><li>无分片交换：读完字节满 64 个再发送<ul><li>折中</li></ul></li></ul><h4 id=一层-二层设备比较><a class=markdownIt-Anchor href=#一层-二层设备比较></a> 一层、二层设备比较</h4><table><thead><tr><th>功能</th><th>网桥</th><th>中继器</th></tr></thead><tbody><tr><td>再生信号</td><td>Yes</td><td>Yes</td></tr><tr><td>连接采用不同 MAC 协议的网段</td><td>Yes</td><td>No</td></tr><tr><td>隔离冲突域</td><td>Yes</td><td>No</td></tr><tr><td>根据帧头的物理地址转发帧</td><td>Yes</td><td>No</td></tr><tr><td>丢弃损坏帧</td><td>Yes</td><td>No</td></tr></tbody></table><h2 id=网络层><a class=markdownIt-Anchor href=#网络层></a> 网络层</h2><h3 id=网络层概述><a class=markdownIt-Anchor href=#网络层概述></a> 网络层概述</h3><ul><li><p>网络层的作用：将源端数据包（分组）一路送到接收方</p><ul><li>封装源数据</li><li>识别目的机</li><li>找到一根好的路径（路由）</li></ul></li><li><p>源和目的之间的网络</p><ul><li>数据包网络：无连接的服务</li><li>虚电路网络：面向连接的服务</li></ul></li></ul><table><thead><tr><th>比较项目</th><th>数据报子网（无连接服务）</th><th>虚电路子网（面向连接服务）</th></tr></thead><tbody><tr><td>建立电路</td><td>不需要</td><td>要求</td></tr><tr><td>地址信息</td><td>每个分组含完整的SA和DA</td><td>每个VC包含一个很短的VC号码</td></tr><tr><td>状态信息</td><td>路由器不保留任何连接状态信息</td><td>每个VC都要求路由器建立表项</td></tr><tr><td>路由</td><td>每个分组独立选择路由</td><td>每个分组沿建立VC时确定的路由</td></tr><tr><td>路由器失效影响</td><td>没有，只有系统崩溃时丢失分组</td><td>所有经过失效R的VC都终止</td></tr><tr><td>服务质量/拥塞控制</td><td>很难实现</td><td>总资源（带宽、缓存）足够的情况下，采用提前给每个VC分配资源的方法，很容易实现</td></tr></tbody></table><h3 id=ip-互联网协议><a class=markdownIt-Anchor href=#ip-互联网协议></a> IP 互联网协议</h3><ul><li>IP 的任务：提供一种尽力而为（best-effort）地把数据从源端传输到接收方的方法</li><li>封装的格式：Internet Protocol</li><li>标识收发数据机</li></ul><h4 id=ip-地址><a class=markdownIt-Anchor href=#ip-地址></a> IP 地址</h4><ul><li><p>ICANN域名和地址分配机构负责总池：层级分配</p></li><li><p>点分十进制表示</p><ul><li>32位被分成了4个8位组</li></ul></li><li><p>相邻8位组之间用“.”分隔</p><ul><li>每个8位组转换成十进制数，从0到255</li></ul></li></ul><h5 id=a-类地址><a class=markdownIt-Anchor href=#a-类地址></a> A 类地址</h5><ul><li><p>前 1 字节标识网络地址部分，后 3 字节标识主机地址部分</p></li><li><p>每个网络最多可容纳 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>24</mn></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding=application/x-tex>2^{24}-2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span></span></span></span> 台主机</p></li><li><p>第1字节用十进制表示的取值范围为0－127</p></li><li><p>具有 A 类地址特征的网络总数为 128 个</p></li></ul><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/A%E7%B1%BB%E5%9C%B0%E5%9D%80.png alt=A类地址></p><h5 id=b-类地址><a class=markdownIt-Anchor href=#b-类地址></a> B 类地址</h5><ul><li><p>前 2 字节标识网络地址部分，后 2 字节标识主机地址部分</p></li><li><p>每个网络最多可容纳 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding=application/x-tex>2^{16}-2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span></span></span></span> 台主机</p></li><li><p>第1字节用十进制表示的取值范围为 128－191</p></li><li><p>具有 B 类地址特征的网络总数为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>14</mn></msup></mrow><annotation encoding=application/x-tex>2^{14}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span> 个</p></li></ul><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/B%E7%B1%BB%E5%9C%B0%E5%9D%80.png alt=B类地址></p><h5 id=c-类地址><a class=markdownIt-Anchor href=#c-类地址></a> C 类地址</h5><ul><li><p>前 3 字节标识网络地址部分，后 1 字节标识主机地址部分</p></li><li><p>每个网络最多可容纳 254 台主机</p></li><li><p>第 1 字节用十进制表示的取值范围为 192－223</p></li><li><p>具有 C 类地址特征的网络总数为 221 个</p></li></ul><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/C%E7%B1%BB%E5%9C%B0%E5%9D%80.png alt=C类地址></p><h5 id=三类ip地址的比较><a class=markdownIt-Anchor href=#三类ip地址的比较></a> 三类IP地址的比较</h5><table><thead><tr><th>类别</th><th>网络数</th><th>主机数/网络</th><th>最高字节取值范围</th><th>网络规模</th></tr></thead><tbody><tr><td>A 类</td><td>128</td><td>1600 万</td><td>0-127</td><td>大型</td></tr><tr><td>B 类</td><td>1.6 万</td><td>6.5 万</td><td>128-191</td><td>中型</td></tr><tr><td>C 类</td><td>200 万</td><td>254</td><td>192-223</td><td>小型</td></tr></tbody></table><h5 id=保留的-ip-地址><a class=markdownIt-Anchor href=#保留的-ip-地址></a> 保留的 IP 地址</h5><ul><li>D类（224.0.0.0~239.0.0.0）【多址传送地址】和 E类（240.0.0.0~254.0.0.0）【保留将来使用】</li><li>网络地址：主机部分全为 0 的IP 地址</li><li>广播地址：主机部分全为 1 的IP 地址</li><li>32位全为0，0.0.0.0<ul><li>这个主机、这个网络</li><li>Cisco路由器指定的默认路由</li></ul></li><li>32位全为1，255.255.255.255<ul><li>泛洪广播（Flood Broadcast）= 本地广播（Local Broadcast）</li></ul></li><li>127.0.0.0 Lookback Network</li><li>127.0.0.1 Lookback test</li><li>169.254.x.x，非正常地址</li></ul><h4 id=子网><a class=markdownIt-Anchor href=#子网></a> 子网</h4><ul><li><p>局域网不断增长，越来越难于管理，必须将它分割成子网</p></li><li><p>一个网络被分隔成几个部分（子网），但是<strong>在外界看来，该网络仍被看成一个整体</strong>(体现在路由表例上，就是外部的路由器只对应一条路由）</p></li><li><p><strong>主/边界路由器</strong>和外部联系，然后转发给子网</p></li></ul><h5 id=子网掩码><a class=markdownIt-Anchor href=#子网掩码></a> 子网掩码</h5><ul><li><p>路由器使用子网掩码决定分组往哪个子网转发，是<strong>子网</strong>的重要属性</p></li><li><p>子网掩码可用点分十进制表示（1表示网络位，0表示主机位），也可用“/网络位数+子网位数”表示</p></li><li><p>路由器采用 AND 操作（目的IP和子网掩码），得到目的网络地址</p><ul><li>减少了路由器的存储压力</li></ul></li><li><p>默认子网掩码</p><ul><li>A：/8</li><li>B：/16</li><li>C：/24</li></ul></li></ul><h5 id=构建子网><a class=markdownIt-Anchor href=#构建子网></a> 构建子网</h5><ul><li><p>构建子网是通过从网络地址的主机部分借位来进行</p><ul><li>从主机域的高位开始借位</li><li>主机域至少保留 2 位</li></ul></li><li><p>可用主机数量的公式 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding=application/x-tex>2^n-2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.747722em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span></span></span></span></p></li></ul><h4 id=ip-寻址><a class=markdownIt-Anchor href=#ip-寻址></a> IP 寻址</h4><ul><li><p>定位到目的机：通常要定位到目的机，是先通过<strong>IP寻址</strong>找到目的网络，再通过<strong>MAC寻址</strong>找到目的机</p></li><li><p>路由器的主要功能</p><ul><li>打开分组</li><li>确定目标网络 （AND），查找路由表</li><li>重新封装，转发</li></ul></li><li><p>路由器转发数据的依据：路由表</p><ul><li>主要包括：目的网络地址，接口，代价metric (f.g. hop)，子网掩码，网关</li></ul></li></ul><h3 id=ip-分组><a class=markdownIt-Anchor href=#ip-分组></a> IP 分组</h3><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/IP%E5%88%86%E7%BB%84.png alt=IP分组></p><ul><li><p>协议版本</p><ul><li>4 bits</li><li>标明IP协议的版本号<ul><li>IPv4 : 0100</li><li>IPv6 : 0110</li></ul></li></ul></li><li><p>报头长度</p><ul><li>4 bits</li><li>以 4 bytes 为单位标明报文长度，可指向数据开始处</li><li>最小为 20 bytes，最大为 60 bytes，其中的 40 bytes 供IP选项使用</li></ul></li><li><p>服务类型</p><ul><li>8 bits</li><li>上层协议表明该分组的重要程度<ul><li>Precedence</li><li>Reliability</li><li>ECN.</li></ul></li></ul></li><li><p>数据报总长度</p><ul><li>16 bits</li><li>指明整个数据分组的总长度，包括数据头和数据。单位 bytes</li></ul></li><li><p>数据报标识号</p><ul><li>16 bits</li><li>标识当前数据报的序列号</li><li>由发送者分配，以便接收方可以依据来做重组</li></ul></li><li><p>标志</p><ul><li>3 bits</li><li>标志分组是否分片</li></ul></li><li><p>分片偏移</p><ul><li>13 bits</li><li>帮助收方重组</li></ul></li><li><p>生存时间</p><ul><li>8 bits</li><li>TTL 维护一个计数器，递减为零时，数据报被丢弃，防止分组在网络中无限循环</li></ul></li><li><p>用户协议</p><ul><li>8 bits</li><li>用来指定传输层协议<ul><li>17(UDP)</li><li>6(TCP)</li></ul></li></ul></li><li><p>报头检验和</p><ul><li>16 bits</li><li>针对头部计算校验和，验证分组头部的正确性</li></ul></li><li><p>源/目的站点IP地址</p><ul><li>源和目的地址都是32位（IPv4）</li></ul></li><li><p>数据报选项（可选）</p><ul><li>可变长字段</li><li>允许 IP 支持一些安全、时间戳等可选项</li></ul></li><li><p>填充</p><ul><li>可变长字段</li><li>确保 IP 头是 32 位的整数倍</li></ul></li></ul><h3 id=ipv6><a class=markdownIt-Anchor href=#ipv6></a> IPv6</h3><p><strong>Q：为什么需要 IPv6？</strong></p><ul><li>IPv4 先天不足，自带危机——安全问题、<strong>地址缺乏</strong>、端到端业务模式、配置复杂，路由表的膨胀等<ul><li>地址匮乏可以使用 NAT 来缓解，但是这将 “端——端” 变成了 “端——转换器——端”</li></ul></li></ul><h4 id=ipv6-地址><a class=markdownIt-Anchor href=#ipv6-地址></a> IPv6 地址</h4><ul><li><p>最显著的变化——地址空间</p><ul><li>IPv4：约40亿</li><li>IPv6：约340涧</li></ul></li><li><p>IPv6 地址表示：冒分十六进制</p><ul><li>把 128 位的二进制数，分成 8 组，然后每组转换为 4 位 16 进制数</li><li>规则 1：省略每组的前导 0（0001→1）</li><li>规则2：忽略全 0，用双冒号表示（1:0:0:2→1::2）<ul><li>一个地址最多一个双冒号</li></ul></li><li>地址前缀长度用 “/xx” 来表示</li></ul></li><li><p>IPv6 地址分类</p><ul><li>单播地址</li><li>组播地址</li><li>任播地址</li><li>特殊地址</li></ul></li></ul><table><thead><tr><th>地址类型</th><th>二进制前缀</th><th>IPv6标识</th></tr></thead><tbody><tr><td>未指定</td><td>00…0 (128 bits)</td><td>::/128</td></tr><tr><td>环回地址</td><td>00…1 (128 bits)</td><td>::1/128</td></tr><tr><td>组播</td><td>11111111</td><td>FF00::/8</td></tr><tr><td>链路本地地址</td><td>1111111010</td><td>FE80::/10</td></tr><tr><td>网点本地地址</td><td>1111111011</td><td>FEC0::/10</td></tr><tr><td>全局单播</td><td>（其他）</td><td></td></tr></tbody></table><ul><li><p>单播地址</p><ul><li>应用范围：用在单一链路上</li><li>带有链路-本地源或目的地址的数据包不转发到其他链路</li></ul></li><li><p>链路本地地址</p><ul><li>应用范围：只在同一本地链路节点之间使用</li><li>节点启动时，自动配置一个本地链路地址</li><li>生成链路本地地址<ul><li>前 64 位：FE80:0:0:0</li><li>后 64 位：EUI-64 地址<ul><li>先将 MAC 地址写成二进制形式，一分为二</li><li>然后在中间添加 11111111 11111110，将第一组的第一个 0 转化为 1</li></ul></li></ul></li></ul></li><li><p>站点本地地址</p><ul><li>应用范围：站点内，与 IPv4 私人地址类似</li><li>FEC0:0:0:SID::/64</li><li>不是自动生成的</li></ul></li><li><p>可聚合全球单播地址</p><ul><li>提供商分配的前缀：/48</li><li>Site拓扑：由组织机构划分子网</li><li>接口ID：64</li></ul></li><li><p>组播地址</p></li><li><p>任播地址</p><ul><li>用于标识一组网络接口</li><li>目标地址为任播地址的数据报将发送给最近的一个接口</li></ul></li></ul><p><strong>Q：IPv6 如何做到即插即用的？</strong></p><p>A：</p><ul><li>启动时，生成链路本地地址</li><li>该地址可和网关通信，获得全球IP地址前缀，利用手工、EUI-64地 址、随机生成的方法生成后缀</li><li>也可利用DHCP获得上网所需的资源</li></ul><h5 id=各类地址的应用范围><a class=markdownIt-Anchor href=#各类地址的应用范围></a> 各类地址的应用范围</h5><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/IPv6%E5%90%84%E7%B1%BB%E5%9C%B0%E5%9D%80%E5%BA%94%E7%94%A8%E8%8C%83%E5%9B%B4.png alt=IPv6各类地址应用范围></p><h4 id=ipv6地址子网规划><a class=markdownIt-Anchor href=#ipv6地址子网规划></a> IPv6地址子网规划</h4><ul><li>IPv6 子网划分是根据路由器的数量及它们所支持的网络来构建寻址分层结构</li></ul><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/IPv6%E5%AD%90%E7%BD%91%E8%A7%84%E5%88%92.png alt=IPv6子网规划></p><h4 id=ipv6-分组><a class=markdownIt-Anchor href=#ipv6-分组></a> IPv6 分组</h4><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/IPv6%E5%88%86%E7%BB%84.png alt=IPv6分组></p><ul><li>版本号<ul><li>4 bits</li></ul></li><li>业务服务<ul><li>8 bits</li><li>提供区分服务，表明该分组的重要长度、优先级等</li></ul></li><li>流标记<ul><li>20 bits</li><li>表示分组的业务需求标记，提供服务质量</li></ul></li><li>净荷长度<ul><li>16 bits</li><li>指明了搭载数据的长度（不含报头）</li></ul></li><li>下一个头<ul><li>8 bits</li><li>指明了紧跟的扩展头类型</li><li>最后一个扩展头或无扩展头，退化为用户协议<ul><li>6：TCP</li><li>17：UDP</li></ul></li></ul></li><li>跳数限制<ul><li>8 bits</li><li>和 TTL 的功能完全一样</li></ul></li><li>源/目的站点IP地址<ul><li>源和目的地址都是128位（IPv6）</li></ul></li></ul><h5 id=ipv6-扩展头><a class=markdownIt-Anchor href=#ipv6-扩展头></a> Ipv6 扩展头</h5><ul><li><p>目前，已经定义了6种扩展头</p></li><li><p>扩展头是可选的，<strong>可以有多个扩展头</strong>，但是必须按一定的顺序排列</p></li><li><p>扩展头有固定的格式</p></li><li><p>其他扩展头包含可变数目的可变长度域</p><ul><li>每个可变项都被编码成(Type，Length，Value) 三元组</li></ul></li><li><p>每一种扩展报头其实也有自己特定的协议号（下一个头NextHeader），例如：路由报头为43，AH报头为51</p></li></ul><h3 id=路由表><a class=markdownIt-Anchor href=#路由表></a> 路由表</h3><ul><li><p>路由器分组转发的依据：路由表</p></li><li><p>路由表从何而来：直连路由、静态路由、动态路由</p></li><li><p>直连路由：开启了路由器接口后，自动发现</p></li><li><p>静态路由：管理员手工配置的路由</p><ul><li>一种常用的静态路由：默认/缺省路由<ul><li>是默认的路径，找不到路的时候可以从这里通过</li></ul></li></ul></li><li><p>动态路由：由路由选择协议动态地建立、更新和维护的路由</p><ul><li><p>适合大型的、经常变动的网络，需要维护开销</p></li><li><p>减少了网络管理员的负担</p></li><li><p>动态路由从何而来？</p><ul><li>距离矢量路由选择（DV）：RIP：路由信息协议</li><li>链路状态路由选择（LS）：OSPF：开放的最短路径优先</li></ul></li><li><p>怎么量度路径的优劣？</p><ul><li>路径长度、可靠性、延迟、带宽、负载、通信代价</li></ul></li></ul></li></ul><h4 id=距离矢量路由选择><a class=markdownIt-Anchor href=#距离矢量路由选择></a> 距离矢量路由选择</h4><ul><li>D-V 算法是动态的和分布式的，它常被用于小型网络<ul><li>RIP是一个典型的DV</li></ul></li></ul><h5 id=dv的工作原理><a class=markdownIt-Anchor href=#dv的工作原理></a> DV的工作原理</h5><ol><li>每个路由器（节点）维护两个向量，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>D_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>S_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，分别表示从该路由器到所有其它路由器的距离及相应的下一跳</li><li>在邻居路由器之间交换路由信息（矢量）</li><li>每个路由器（节点）根据收到的矢量信息，更新自己的路由表<ul><li>更新规则：选择 i 到 j 最短的距离的路径</li></ul></li></ol><h5 id=d-v算法的特点><a class=markdownIt-Anchor href=#d-v算法的特点></a> D-V算法的特点</h5><ul><li>优点：简单</li><li>缺点：交换的信息太大了；路由信息传播慢，可能导致路径信息不一致；收敛慢，度量计数到无穷；不适合大型网络</li></ul><h5 id=路由选择信息协议-rip><a class=markdownIt-Anchor href=#路由选择信息协议-rip></a> 路由选择信息协议 RIP</h5><ul><li><p>种类</p><ul><li>RIPv1：有类的路由选择协议</li><li>RIPv2：无类的路由选择协议，支持 CIDR、VLSM 等</li><li>RIPng：支持 IPv6</li></ul></li><li><p>主要特点</p><ul><li>RIP 是一种典型的D-V 路由选择协议</li><li>RIP 采用了跳数（hop）作为量度（metric）</li><li>当量度超过15 跳，目的被认为不可达</li><li>默认地，每30秒钟交换一次矢量（全部路由表）</li></ul></li><li><p>主要缺陷</p><ul><li>不能到达量度超过15跳的目标网络</li><li>RIP的度量（代价）是跳数，有时候不能真正反映网络的状况</li><li>实际运行中，会遇到度量计数到无穷、形成路由环、收敛慢等问题<ul><li>因为路由器只能<strong>直接获取近邻信息</strong>，所以有可能传播、学习到<strong>错误的路由信息</strong></li></ul></li></ul></li><li><p>解决办法</p><ul><li>定义路径度量（代价）的最大值</li><li>提高收敛速度<ul><li>水平分割</li><li>毒性逆转</li><li>抑制定时器</li><li>触发更新</li></ul></li></ul></li></ul><h4 id=链路状态路由选择><a class=markdownIt-Anchor href=#链路状态路由选择></a> 链路状态路由选择</h4><ul><li><p>优点</p><ul><li>每个路由器的认识一致</li><li>收敛快</li><li>适合在大型网络中使用</li></ul></li><li><p>缺点</p><ul><li>路由器需要较大的储存空间</li><li>计算负担大</li></ul></li><li><p>主要思想</p><ul><li><strong>发现</strong>它的邻居节点们，了解它们的网络地址</li><li><strong>设置</strong>到它的每个邻居的成本度量</li><li><strong>构造</strong>一个分组，包含它所了解到的所有信息</li><li><strong>发送</strong>这个分组给所有其他的路由器</li><li><strong>计算</strong>到每个路由器的最短路径</li></ul></li></ul><h5 id=发现><a class=markdownIt-Anchor href=#发现></a> 发现</h5><ul><li>一个路由器启动的时候，在每个点到点的线路发送一个特别的 HELLO 分组</li><li>收到HELLO分组的路由器回送一个应答，应答中有它自己<strong>全球唯一</strong>的名字</li></ul><h5 id=设置><a class=markdownIt-Anchor href=#设置></a> 设置</h5><ul><li>为了决定线路的开销，路由器发送一个特别的ECHO 分组，另一端立刻回送一个应答</li><li>通过测量往返时间（round-trip time），发送路由器可以获得一个合理的延迟估计值</li></ul><h5 id=构造><a class=markdownIt-Anchor href=#构造></a> 构造</h5><ul><li>链路状态分组构造后被发送给其他的路由器</li><li>周期性地构造和发送，或者有<strong>特别的事件</strong>发生时构造，比如某条线路或邻居down掉了</li></ul><h5 id=发布><a class=markdownIt-Anchor href=#发布></a> 发布</h5><ul><li><p>基本算法</p><ul><li>每个分组都包含一个序列号，序列号随着新分组产生而递增</li><li>路由器记录下他看见的所有(源路由器，序列号)对</li><li>当一个的新的分组到达时，路由器根据它的记录：<ul><li>如果该分组是新的，就被从除了来线路外的所有其他线路<strong>广播</strong></li><li>如果是重复分组，即被丢弃</li><li>如果该分组的序列号比对应的源路由器发送的到过此地的分组的最大序列号还小，则该分组被当作<strong>过时的信息</strong>而被拒绝</li></ul></li></ul></li><li><p>可能遇见的问题及解决方法</p><ul><li>序列号回转：采用 32-bit 序列号</li><li>序列号传输时出错：利用 Age 丢弃</li></ul></li><li><p>进一步的改进使基本算法更加健壮：使用保留区</p></li></ul><h5 id=计算><a class=markdownIt-Anchor href=#计算></a> 计算</h5><ul><li>一个路由器获得了<strong>全部的</strong>链路状态分组就可以构造出全网络图来了<ul><li><strong>所有路由器的链路状态分组是一样的</strong></li></ul></li><li>使用最短路径算法来计算路由器之间的最短路径</li></ul><h5 id=l-s路由协议的实例ospf><a class=markdownIt-Anchor href=#l-s路由协议的实例ospf></a> L-S路由协议的实例—OSPF</h5><ul><li><p>OSPF 是一种基于开放标准的链路状态路由协议，是目前IGP中应用最广、性能最优的一个协议</p></li><li><p>必须划分区域，所有子区域必须连接到区域 0 上</p></li></ul><h6 id=单区域ospf><a class=markdownIt-Anchor href=#单区域ospf></a> 单区域OSPF</h6><ul><li>RouterID：一台路由器的唯一标识，在整个自治系统内唯一</li><li>协议号：IP头代表 OSPF 报文的协议号是 89</li><li>TTL=1：通常 OSPF 报文不转发，只被传递一条</li></ul><h6 id=ospf包类型><a class=markdownIt-Anchor href=#ospf包类型></a> OSPF包类型</h6><ul><li>Hell：o与邻居建立和维护毗邻关系。</li><li>数据库描述包（DD）：描述一个OSPF路由器的链路状态数据库内容</li><li>链路状态请求（LSR）：请求相邻路由器发送其链路状态数据库中的具体条目</li><li>链路状态更新（LSU）：向邻居路由器发送链路状态通告</li><li>链路状态确认（LSA）：确认收到了邻居路由器的LSU</li></ul><h6 id=ospf的运行步骤><a class=markdownIt-Anchor href=#ospf的运行步骤></a> OSPF的运行步骤</h6><ol><li>建立路由器毗邻关系</li><li>选举DR和BDR</li><li>发现路由</li><li>选择最佳路由</li><li>维护路由信息</li></ol><h3 id=无类域间路由cidr><a class=markdownIt-Anchor href=#无类域间路由cidr></a> 无类域间路由CIDR</h3><ul><li><p>目的：缓解了地址枯竭的趋势；控制甚至缩减了路由表的开销</p></li><li><p>基本思想：分配IP地址的时候不再以类别来分，而是按照可变长的地址块来分配（<strong>按需分配</strong>）</p><ul><li>路由表必须扩展，增加一个32-bit 的子网掩码</li></ul></li><li><p>当一个分组到来到的时候</p><ol><li>分组中的目标IP地址被检查</li><li>目标IP和子网掩码进行与操作，获得目标网络地址，以查找路由表</li><li>如果路由表中有多个表项匹配（这些表项有不同的子网掩码），使用子网掩码最长的那个表项</li></ol></li><li><p>CIDR 可以路由聚合，形成超网</p></li><li><p>CIDR 的好处</p><ul><li>缩减路由表规模</li><li>隔离路由翻动</li></ul></li></ul><h3 id=网络地址翻译-nat><a class=markdownIt-Anchor href=#网络地址翻译-nat></a> 网络地址翻译 NAT</h3><ul><li><p>目的：缓解地址枯竭的趋势</p></li><li><p>NAT：私有IP地址和公有IP地址之间的转换</p></li><li><p>PAT：将多个私有IP地址影射到同一个公有IP地址的不同端口</p></li></ul><p>※概括：<strong>内部网络使用私人地址，当内网需要和外网通信的时候，私人地址转换成合法的 global 的地址</strong></p><ul><li><p>原理</p><ol><li>由NAT转换器（盒子）完成这种转换；NAT转换器能够转换并且维护一个地址转换表，以便回来的分组找到它的去处</li><li>当回来的分组到达NAT转换器的时候，它查找地址转换表（以源端口作索引），获得目标机的私人地址，并转换地之后发往目标机</li></ol></li><li><p>NAT 带来的问题</p><ul><li><p>违背了IP的结构模型——每个IP地址唯一地标识了一台机器</p></li><li><p>将互联网改变成了“面向连接”的网络，NAT转换器维护着连接的状态，一旦它崩溃，连接也没有了</p></li><li><p>违背了最基本的协议分层原则（涉及端口，这是传输层）</p></li><li><p>如果传输层不是采用TCP或UDP，而是采用了其它的协议，NAT将不再工作</p></li><li><p>有些应用会在payload中插入IP地址，然后接收方会提取出该IP地址并使用，但是NAT转换器对此一无所知，导致该类应用不再有效</p></li></ul></li></ul><h3 id=互联网控制协议icmp><a class=markdownIt-Anchor href=#互联网控制协议icmp></a> 互联网控制协议ICMP</h3><ul><li>目的：IP分组传送不可靠，可能遭遇各种问题。ICMP 用来向源报告这些问题或状况，ICMP也能用来测试网络</li><li>消息格式</li></ul><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/ICMP%E6%A0%BC%E5%BC%8F.png alt=ICMP格式></p><ul><li><p>应用</p><ul><li>ping：发送ICMP回声请求报文</li><li>tracert：利用 ICMP 超时报文来获得一张<strong>途径</strong>的路由器列表</li><li>PMTU：获得途经的最小 MTU</li></ul></li><li><p>规定：<strong>ICMP 消息不生成自己的报告差错</strong></p></li></ul><h3 id=地址解析协议arp><a class=markdownIt-Anchor href=#地址解析协议arp></a> 地址解析协议ARP</h3><ul><li><p>目的：找到一个给定IP地址所对应的MAC地址</p></li><li><p>ARP请求/ARP应答</p></li><li><p>优化措施</p><ul><li>缓存ARP 结果</li><li>在ARP请求中包括源机的IP-to-MAC 地址的映射</li><li>每台机器在启动的时候，广播它的IP-MAC地址对</li></ul></li><li><p>免费ARP</p><ul><li>当一台主机启动时，发送要给一个免费ARP<ul><li>如果意外收到一个应答，即是IP地址发生了冲突</li></ul></li><li>当一个接口（interface）的配置发生了改变，会发送一个免费ARP</li></ul></li><li><p>缺省网关（代理ARP）</p><ul><li>当源设备需要的<strong>目的地址与自己不在同一个网络</strong>时，如果源不知道目的MAC地址，它必须使用路由器的服务使它的数据达到目的，当路由器在这种方式下使用时，称为缺省网关</li><li>缺省网关是与源设备所处的网段相连的路由器接口上的IP地址</li></ul></li><li><p>ARP table</p><ul><li>IP地址到MAC地址的映射表</li><li>为了减少ARP请求的次数，每个设备拥有自己的ARP表，包括路由器</li><li>储存在存储器（RAM）中，自动维护（<strong>掉电消失</strong>）</li></ul></li><li><p>ARP具有<strong>安全隐患</strong></p></li></ul><h3 id=拥塞控制><a class=markdownIt-Anchor href=#拥塞控制></a> 拥塞控制</h3><ul><li><p>拥塞：当一个子网或子网的一部分出现太多分组的时候，网络的性能急剧下降（负载&gt;资源）</p></li><li><p>处理策略</p><ul><li>开环（Open loop）：试图用良好的设计来解决问题，本质是从一开始就保证问题不会发生</li><li>闭环：建立在反馈环路的概念上，进行：检测、传递、调整</li></ul></li><li><p>【闭环|检测】拥塞量度：衡量拥塞程度</p></li><li><p>【闭环|传递】拥塞休息传播</p></li><li><p>对于拥塞采取的措施</p><ul><li>抑制分组：收到抑制分组后，会减少它发向目标的流量</li><li>逐跳抑制分组：让分组路径的每个路由器都采取相应措施</li><li>负载丢弃/载荷脱落：最极端的方法<ul><li>随机丢弃</li><li>葡萄酒策略：丢弃新的，适合文件传输类</li><li>牛奶策略：丢弃旧的，适合多媒体类</li><li>丢弃不重要的：需要表明优先级</li></ul></li><li>随机早期检测：防患于未然</li></ul></li></ul><h3 id=流量整形><a class=markdownIt-Anchor href=#流量整形></a> 流量整形</h3><ul><li>目的：调节数据传输的平均速率</li></ul><h4 id=漏桶算法><a class=markdownIt-Anchor href=#漏桶算法></a> 漏桶算法</h4><ul><li><p>算法描述</p><ol><li>每个主机连接到网络的接口中都有一个漏桶，即一个优先长度的内部队列</li><li>当桶中有分组的时候，输出速率是恒定的，当桶空的时候，输出速率是0</li><li>当一个分组到达满的桶的时候，分组将被丢弃（<strong>满则溢</strong>）</li><li>每个时钟嘀嗒( tick)，仅允许一个分组或固定数量的分组发送出去</li></ol></li><li><p>效果：让输出到网路的分组流变成一个<strong>稳定流</strong>，抹平了突发尖峰，极大地<strong>减少了发生拥塞的机会</strong></p></li><li><p>缺点：不能大量地突发数据（满则溢）</p></li></ul><h4 id=令牌桶算法><a class=markdownIt-Anchor href=#令牌桶算法></a> 令牌桶算法</h4><ul><li><p>算法描述</p><ol><li>当大量数据突发的时候，令牌桶算法允许输出加快到某种程度</li><li>令牌桶拥有令牌（tokens），且以每 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>Δ</mi><mi>T</mi></mrow><annotation encoding=application/x-tex>\Delta T</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>Δ</span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span></span> 秒产生一个令牌的速度往桶中输入令牌</li><li>一个分组要发送的时候，它必要从桶中取出和获取到一个令牌</li><li>令牌桶算法允许累积令牌，但最多可以累积 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>（令牌桶的容量）个令牌</li></ol></li><li><p>对比漏桶算法</p><ul><li>允许突发，但是最大突发受制于令牌桶容量</li><li>桶满时，丢掉的是令牌而不是分组</li></ul></li><li><p>计算最大突发时间</p><ul><li>突发时间：S 秒</li><li>令牌桶容量：B字节</li><li>令牌到达的速率：R字节/秒</li><li>最大输出速率：M字节/秒</li></ul><p>则 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>B</mi><mo>+</mo><mi>R</mi><mi>S</mi><mo>=</mo><mi>M</mi><mi>S</mi><mspace linebreak=newline></mspace><mi>S</mi><mo>=</mo><mi>B</mi><mi mathvariant=normal>/</mi><mo stretchy=false>(</mo><mi>M</mi><mo>−</mo><mi>R</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>B+RS=MS\\S=B/(M-R)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault" style=margin-right:.05764em>S</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=mord>/</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mclose>)</span></span></span></span></p></li></ul><h2 id=传输层><a class=markdownIt-Anchor href=#传输层></a> 传输层</h2><h3 id=传输层概述><a class=markdownIt-Anchor href=#传输层概述></a> 传输层概述</h3><ul><li>传输层是整个协议栈（TCP/IP）的核心</li><li>传输层的协议主要两个：UDP、TCP</li><li>传输层的人物是提供可靠的、高效的数据传输<ul><li>向上提供标准的传输服务</li><li>向下屏蔽不同的通信子网</li></ul></li><li>与网络层类似，传输层有两种传输层服务<ul><li>面向连接的服务</li><li>无连接的服务 Connectionless</li></ul></li></ul><p><strong>Q：既然如此，为什么需要两个独立的不同的层（网络层和传输层）？</strong></p><p>A：网络层运行再承运商操作的路由器上，用户不能真正控制网络层；</p><p>​ 把另一层放在网络层之上，可以让用户能够控制到服务质量；</p><p>​ 传输层原语独立于网络层原语，而网络层原语会因为网络的不同而不同</p><ul><li><p>传输层提供的功能</p><ul><li>端点标识</li><li>传输服务<ul><li>面向连接：端到端的连接管理、流控制、差错控制</li><li>无连接</li></ul></li></ul></li><li><p>传输服务和网络服务的两个主要差别</p><ul><li>网络服务试图按照实际网络提供的服务来建模（不可靠的），而面向连接的传输服务是可靠的</li><li>网络服务仅被传输实体所使用；而传输服务直接被应用程序所使用，必须方便易用</li></ul></li></ul><h4 id=数据段-tpdu传输层协议数据单元><a class=markdownIt-Anchor href=#数据段-tpdu传输层协议数据单元></a> 数据段 （TPDU，传输层协议数据单元）</h4><ul><li>TPDU(Transport Protocol Data Unit) 是从传输实体发到对端传输实体的信息</li><li>TPDUs 被封装在分组（packet）中，由网络层交换</li><li>分组被封装在帧（frames）中，由数据链路层交换</li></ul><h3 id=用户数据报协议-udp><a class=markdownIt-Anchor href=#用户数据报协议-udp></a> 用户数据报协议 UDP</h3><ul><li><p>UDP 是一个无连接的传输层协议</p></li><li><p>UDP不提供数据传输的可靠保证，追求<strong>简洁高效</strong></p></li><li><p>UDP 数据段包括8字节的头部和数据两个部分</p></li></ul><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/UDP.png alt=UDP></p><ul><li>其中的<strong>长度域</strong>表示的长度包括<strong>头部和数据总共的长度</strong></li><li>校验和是<strong>可选的</strong>，如果不计算校验和，则该域置为0</li><li>UDP比IP好的地方在于<strong>它可以使用源端口和目的端口</strong></li></ul><h4 id=端口-port><a class=markdownIt-Anchor href=#端口-port></a> 端口 port</h4><ul><li>16位，共有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup></mrow><annotation encoding=application/x-tex>2^{16}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 个端口</li><li>端口的范围：0~65535</li></ul><table><thead><tr><th>端口</th><th>作用</th></tr></thead><tbody><tr><td>&lt;1023</td><td>用于公共应用</td></tr><tr><td>1024~49151</td><td>用户端口，注册端口</td></tr><tr><td>&gt;49152</td><td>动态端口，私人端口</td></tr></tbody></table><h4 id=tcpudp伪头部pseudo-header><a class=markdownIt-Anchor href=#tcpudp伪头部pseudo-header></a> TCP/UDP伪头部(pseudo header)</h4><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/UDP%E4%BC%AA%E5%A4%B4%E9%83%A8.png alt=UDP伪头部></p><h3 id=通信模型><a class=markdownIt-Anchor href=#通信模型></a> 通信模型</h3><ul><li><p>套接字 Socket：（IP，Port）</p></li><li><p>通信5元组</p><ul><li>源IP</li><li>源端口</li><li>目的IP</li><li>目的端口</li><li>协议</li></ul></li></ul><p>※：此端口 port 和路由器的端口 interface 不一样！</p><ul><li>传输层的PDU不仅仅送达主机，而且送达端点</li></ul><h3 id=tcp数据段><a class=markdownIt-Anchor href=#tcp数据段></a> TCP数据段</h3><ul><li><p>TCP是专门为了在不可靠的互联网络上提供<strong>可靠</strong>的端到端字节流而设计的</p></li><li><p>支持 TCP 的机器都有一个 TCP 实体，或者是用户进程或者是操作系统内核，都可以管理 TCP 流和跟 IP 层的接口</p><ul><li>发：分片封装</li><li>收：解封装，重构字节流</li></ul></li><li><p>TCP软件决定数据段的大小，有两个因素限制了数据段的长度</p><ul><li>TCP数据段必须适合IP的65515(65535-头部<strong>20</strong>)的载荷限制</li><li>每个TCP数据段必须适合于下层网络的MTU（如，1500 字节–以太网载荷大小）</li></ul></li><li><p>TCP使用的基本协议具有动态窗口大小的滑动窗口协议</p></li></ul><h4 id=tcp-数据段tpdu格式><a class=markdownIt-Anchor href=#tcp-数据段tpdu格式></a> TCP 数据段（TPDU）格式</h4><p><img src=/img/post/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%87%E5%BF%98/TCP%E5%88%86%E7%BB%84.png alt=TCP分组></p><ul><li><p>源端口和目的端口字段：标明了一个连接的两个端点</p><ul><li>用来跟踪同一时间内通过网络的不同会话</li><li>一般每个端口对应一个应用程序</li></ul></li><li><p>序列号：字节号(32 位)</p><ul><li><p>初始序列号ISNs(initial sequence numbers )：随机产生</p></li><li><p>SYN：携带了ISNs 和SYN 控制位的数据段</p></li></ul></li><li><p>确认号：期望接收的字节号(32位）</p></li><li><p>TCP 段头长度：TCP段头长度，单位32位（4字节）</p></li><li><p>保留域/字段</p></li><li><p>URG：当紧急指针使用的时候，URG 被置为1。紧急指针是一个对于当前序列号的字节偏移量，标明紧急数据从哪里开始（1字节）</p></li><li><p>ACK：1表示确认号有效，0标明确认号无效（1字节）</p></li><li><p>PSH：表示这是带有PUSH标志的数据接收方收到这样的数据，应该立刻送到上层，而不需要缓存它（1字节）</p></li><li><p>RST：用来重置一个已经混乱的连接（1字节）</p></li><li><p>SYN ：用在连接建立的过程（1字节）</p><ul><li>SYN=1，ACK=0连接请求；当SYN=1，ACK=1连接接受</li></ul></li><li><p>FIN被用来释放连接，它表示发送方已经没有数据要传输了，但是可以继续接收数据（1字节）</p></li></ul><p>※：TCP中的流控(Flow control)使用一个可变长的滑动窗口来完成的</p><ul><li><p>Window size：告诉对方可以发送的数据字节数</p><ul><li>从确认字节号开始（决定于接收方）</li></ul></li><li><p>Checksum：提供额外的可靠性</p></li><li><p>选项域提供了一种增加基本头没有包含内容的方法</p></li></ul><h3 id=tcp-连接的建立><a class=markdownIt-Anchor href=#tcp-连接的建立></a> TCP 连接的建立</h3><ul><li>采用三次握手建立连接</li></ul><div align=center><img src=/img/post/计算机网络备忘/TCP三次握手.png style=zoom:50%></div><ul><li>SYN泛洪导致DoS攻击（伪造源IP）</li></ul><h3 id=tcp-连接释放><a class=markdownIt-Anchor href=#tcp-连接释放></a> TCP 连接释放</h3><ul><li><p>两军队问题：最后信息的发送者，永远无法知道这个信息是否到达</p><ul><li>解决方法：定时器</li></ul></li><li><p>TCP 连接释放的步骤</p><ol><li><p>任何一方在没有数据要传送的时候，都可以发送一个FIN置位了的TCP</p></li><li><p>数据段当FIN被确认的时候，该方向的连接被关闭</p></li><li><p>当双向连接都关闭了的时候，连接释放</p></li><li><p>如果一方发送了FIN数据段出去却在一个设定的时间没有收到应答，释放连接</p></li><li><p>另一方最终会注意到连接的对方已经不在了，超时后连接释放</p></li></ol></li><li><p>半开放连接</p><ul><li>理论上讲，如果初始DR的和重传都丢了，协议失败</li><li>发送者将放弃发送且释放连接，但是，另外一端却不知道这些情况，仍然处于活跃的状态</li><li>这种情形导致半开放连接</li></ul></li><li><p>杀死半开放连接的方式</p><ul><li>如果在一定的时间内，没有TPDUs 到达的话，连接自动释放</li><li>如果这样，传输实体在发送一个TPDU的时候必须启动定时器，定时器超期，将发动一个哑TPDU，以免被断掉</li></ul></li></ul><h3 id=tcp-传输策略><a class=markdownIt-Anchor href=#tcp-传输策略></a> TCP 传输策略</h3><ul><li><p>窗口尺寸受制于接收方</p></li><li><p>当窗口数为0 时，发送者不能正常发送数据段，除非:</p><ol><li>Urgent数据。比如，用户想杀掉远端机器上的进程的时候，可以发送数据</li><li>发送者可以发送<strong>一个字节</strong>的数据段，以便让接收者再次发送期待接收的字节号和窗口数（避免死锁）</li></ol></li><li><p>如果每一字符进行一次响应，那么对带宽的要求会非常高，对应的解决方法</p><ul><li>优化接收端：推迟发送确认分组和窗口更新窗口</li><li>优化发送端：Nagle 算法</li></ul></li><li><p>傻瓜窗口综合症：Clark解决方案</p></li></ul><h3 id=tcp-拥塞控制><a class=markdownIt-Anchor href=#tcp-拥塞控制></a> TCP 拥塞控制</h3><ul><li><p>虽然网络层也试图管理拥塞，但是，大多数繁重的任务是由TCP来完成的，因为针对拥塞的真正解决方案是<strong>减慢数据率</strong></p></li><li><p>分组守恒：当有一个老的分组离开之后才允许新的分组注入网络</p></li><li><p>TCP希望通过动态维护窗口大小来实现这个目标</p></li><li><p>两种因素引起拥塞警报</p><ul><li>接收方处理不过来</li><li>通信子网中出现拥塞</li></ul></li><li><p>处理拥塞的具体方法</p><ul><li>接收者窗口：大小反映了目前窗口的容量（容易控制）</li><li>拥塞窗口：大小反映了网络目前的容量（难于控制）</li></ul></li><li><p>CWND通过慢起动方法尝试而来</p><ul><li>拥塞窗口二进制指数增长至接收窗口大小或超时</li></ul></li><li><p>通过阈值调节CWND尝试的精度</p></li></ul><h3 id=tcp-定时器><a class=markdownIt-Anchor href=#tcp-定时器></a> TCP 定时器</h3><ul><li><p>最重要的定时器：重传定时器</p></li><li><p>持续定时器：用来接收方发出避免窗口数为零的确认后，再次发送更新窗口的数据段丢失导致的死锁</p></li><li><p>保活定时器：用来检查连接是否存活</p></li><li><p>在关闭时刻处于TIMED WAIT 状态中使用的定时器：运行两倍的最大分组生存时间，以确保连接关闭之后，该连接上的所有分组都完全消失</p></li></ul><h3 id=tcp-和-udp-对比><a class=markdownIt-Anchor href=#tcp-和-udp-对比></a> TCP 和 UDP 对比</h3><ul><li>TCP<ul><li>可靠传输方式</li><li>可让应用程序简单化，程序员可以不必进行错误检查、修正等工作</li></ul></li><li>UDP<ul><li>为了降低对计算机资源的需求（DNS）</li><li>应用程序本身已提供数据完整性的检查机制，勿须依赖传输层的协议来保证</li><li>应用程序传输的并非关键性的数据（路由器周期性的路由信息交换）</li><li>一对多方式，必须使用UDP（TCP限于一对一的传送）（视频传播）</li></ul></li></ul><table><thead><tr><th>性能</th><th>TCP</th><th>UDP</th></tr></thead><tbody><tr><td>可靠性</td><td>√</td><td>×</td></tr><tr><td>传输建立</td><td>不确定</td><td>网络延迟</td></tr><tr><td>拥塞控制</td><td>√</td><td>×</td></tr></tbody></table><h2 id=应用层><a class=markdownIt-Anchor href=#应用层></a> 应用层</h2><h3 id=应用层概述><a class=markdownIt-Anchor href=#应用层概述></a> 应用层概述</h3><ul><li><p>位置：没有上一层供它服务，直接服务于模型外的用户</p></li><li><p>主要功能：向应用程序提供网络通信</p></li><li><p>网络应用程序可被分为两大类</p><ul><li>直接网络应用程序</li><li>间接网络应用程序：依赖于重定向器</li></ul></li></ul><h3 id=dns概述><a class=markdownIt-Anchor href=#dns概述></a> DNS概述</h3><ul><li><p>在互联网中，使用IP地址作为机器的绝对地址，是行不通的，有两个原因：</p><ol><li>计算机可能常常地更换IP地址</li><li>IP地址难于记忆</li></ol></li><li><p>域名系统DNS</p><ul><li>DNS是分层次的，基于域的命名方案，且采用了分布式数据库系统来实现</li><li>互联网被分成200多个顶级域每个域被分成若干子域，子域还可进一步划分</li></ul></li><li><p>域名</p><ul><li><p>每个域的名字是：从它向上到根（未命名）的路径，各个部分间用圆点隔开</p></li><li><p>域名可以是绝对的，也可以是相对的，绝对域名总是以圆点结束</p><ul><li>相对域名必须在一定的上下文环境中被解释出来才有意义，从而唯一地确定其真实的含义</li><li>绝对域名和相对域名都引用了域名树中一个特定的节点，以及它下面的所有节点</li></ul></li><li><p>域名是大小写无关的</p></li><li><p>各组成部分的名字最多有63个字符长，整个路径不超过255 个字符</p></li><li><p>没有规则限制同时在两个或多个顶级域名下的注册——域名抢注</p></li><li><p>每个域自己控制它下面的域（子域）的划分</p></li><li><p>要创建一个新的域，创建者必须得到该新域的上级域的许可，一旦创建成功，该新域可以创建子域，而无需征得上级域的同意</p></li></ul></li><li><p>资源记录</p><ul><li><p>每个域，无论是单主机域还是顶级域，都可以有一组跟它相关联的资源记录</p></li><li><p>当一个解析器把域名传递给DNS时，DNS所返回的是与该域名相关联的资源记录。所以DNS的主要功能是将域名映射到资源记录上</p></li><li><p>一个资源记录包括5个部分</p><ul><li>域名：指出这条记录适用于哪个域</li><li>生存期：指示该条记录的稳定程度</li><li>类别：对于互联网信息，它总是IN</li><li>类型：指出了这是什么类型的记录 eg：A（IPV4），AAAA（IPV6）</li><li>值</li></ul></li></ul></li><li><p>域名服务器：资源记录储存的地方</p><ul><li>DNS名字空间被分割成不相交的区域，每个区域包含域名树的一部分，也包含一台主域名服务器</li><li>主域名服务器从自己硬盘的一个文件中读取信息，次域名服务器分享这些信息</li></ul></li><li><p>根域服务器：最高级域名服务器，存储所有顶级域名的名字和 IP</p><ul><li>全球有 13 个根域服务器</li></ul></li></ul><h3 id=域名解析><a class=markdownIt-Anchor href=#域名解析></a> 域名解析</h3><ul><li><p>域名解析：将域名映射为IP地址的方法和过程</p></li><li><p>DNS的使用方法</p><ul><li>为了将一个名字映射为IP地址，应用程序调用一个叫解析器的库过程，把名字作为参数传递给这个过程</li><li>解析器发送一个UDP分组给本地DNS服务器，它会负责查找该名字，然后将对应的IP地址返回给解析器</li><li>解析器返回结果给应用程序，然后应用程序即可开始工作了</li></ul></li><li><p>域名解析的种类</p><ul><li>递归查询：主机向本地域名服务器一般采用这种方法<ul><li>主机所询问的本地域名服务器不知道被查询域名的IP<ul><li>地址本地域名服务器以DNS 客户的身份，向其他根域名服务器继续发出查询请求报文</li></ul></li></ul></li><li>迭代查询：本地域名服务器向根域名服务器一般采用这种方法<ul><li>根域名服务器收到本地域名服务器的迭代查询请求报文<ul><li>给出所要查询的IP 地址</li><li>告诉本地域名服务器：“你下一步应当向哪一个域名服务器<ul><li>进行查询”本地域名服务器进行后续的查询</li></ul></li></ul></li></ul></li></ul></li><li><p>域名解析的优化：高速缓存——减少查询环节，提高效率，但是<strong>缓存中的内容不具有权威性</strong></p></li><li><p>DNS 的信息传递</p><ul><li><p>使用 UDP</p></li><li><p>使用 TCP：报文超过512Byte、从服务器的数据更新</p></li></ul></li></ul><h3 id=电子邮件><a class=markdownIt-Anchor href=#电子邮件></a> 电子邮件</h3><ul><li><p>电子邮件系统通常由两部分组成：</p><ul><li>用户代理(UA)：让用户能够阅读和发送邮件<ul><li>本地程序，提供命令行或图形界面，让用户和电子邮件系统交互</li></ul></li><li>消息传输代理(MTA)：将消息从源端送到目标端<ul><li>通常是系统守护进程，即运行在后台的进程，在系统中传递电子邮件</li></ul></li></ul></li><li><p>电子邮件消息格式：RFC 822、MIME</p><ul><li>MIME –the Multipurpose Internet Mail Extensions，多用途互联网邮件扩展<ul><li>解决这些问题：带有重音符的语言（如法语）、非拉丁字母（如俄语）、不带字母的语言（如汉语）、完全不包含文本的消息（如视频）</li></ul></li></ul></li><li><p>Email 消息传输：SMTP</p><ul><li>源机与目标机（SMTP守护进程在监听）的25端口建立TCP连接</li><li>SMTP 的一些问题<ul><li>没有认证</li><li>传输的是ASCII消息而不是二进制数据，需要编码，效率低下</li><li>邮件是明文</li></ul></li></ul></li><li><p>最后传递：在ISP的一台机器上运行一个消息传输代理；这台机器可以一天24小时运行，随时都可以接收邮件</p><ul><li>POP3、IMAP、Webmail</li></ul></li></ul><h3 id=万维网><a class=markdownIt-Anchor href=#万维网></a> 万维网</h3><ul><li><p>WWW的组成部分</p><ul><li>资源</li><li>统一资源定位器：URL</li><li>通信协议：http,https,ftp,etc.</li></ul></li><li><p>Web 页面由 URL (Uniform Resource Locators)标识</p><ul><li><p>eg：<a target=_blank rel=noopener href=http://www.abcd.com/products.html>http://www.abcd.com/products.html</a></p><ul><li>协议：http</li><li>页面所在的机器的 DNS 域名：<a target=_blank rel=noopener href=http://www.abcd.com>www.abcd.com</a></li><li>包含web页面的文件的名字：products.html</li></ul></li><li><p>当用户单击一个超级链接（URL）时，客户端：</p><ol><li>浏览器检查 URL (读取浏览器的输入)</li><li>浏览器向 DNS 服务器询问域名的 IP 地址</li><li>DNS 返回对应的 IP 地址</li><li>浏览器和 Web 服务器建立 <strong>TCP 连接</strong>（在端口80）</li><li>浏览器发送请求，要求获取文件 products.html</li><li>Web 服务器返回被请求的文件</li><li>TCP 连接被释放</li><li>浏览器解释显示下载到本地的文件</li></ol></li><li><p>当用户单击一个超级链接（URL）时，服务器端：</p><ol><li>接收来自客户的TCP连接</li><li>获取所需文件的名字</li><li>从本地磁盘上获取文件（静态页面）</li><li>将文件返回给客户</li><li>释放TCP连接</li></ol><ul><li>改进：在内存维护一个缓存，保存最近用过的 n 个文件；多线程服务器</li></ul></li></ul></li><li><p>客户的TCP连接中止于前端，所以应答也必须经过前端</p><ul><li>一种解决的方法是TCP移交，TCP端点被传递给处理节点，所以应答可以直接向客户端发送</li></ul></li><li><p>浏览器解释资源的不同方式：内嵌插件或外挂</p></li><li><p>代理服务器(proxy server)：又称为万维网高速缓存(Web cache)，它代表浏览器发出HTTP 请求</p><ul><li>万维网高速缓存把最近的一些请求和响应暂存在本地磁盘中。</li><li>当与暂时存放的请求相同的新请求到达时，万维网高速缓存就把暂存的响应发送出去，而不需要按URL 的地址再去因特网访问该资源。</li></ul></li><li><p>服务器如何辨别用户？</p><ul><li>Cookie：一个小于4kB的命名串</li><li>当客户请求时，web服务器除了应答外，附送一个cookie，存储在客户机磁盘；客户再访问同一个web服务器时，同时发送cookie</li></ul></li></ul><h3 id=其它应用><a class=markdownIt-Anchor href=#其它应用></a> 其它应用</h3><h4 id=文件传输><a class=markdownIt-Anchor href=#文件传输></a> 文件传输</h4><ul><li><p>FTP：一种可靠的面向连接的服务，采用 TCP 在支持 FTP 的系统间传输文件，它支持双向二进制文件和 ASCII 文件传输</p></li><li><p>TFTP：一种无连接的不可靠的服务，采用 UDP 在支持 TFTP 的系统间传输文件。</p></li><li><p>FTP 使用两条 TCP 链接</p><ul><li>21 端口：控制进程</li><li>20 端口：数据传送进程</li></ul></li></ul><h4 id=远程登陆><a class=markdownIt-Anchor href=#远程登陆></a> 远程登陆</h4><ul><li><p>Telnet：不要求远地系统创建众多的服务器，只需为每个远程登陆用户建立一个进程，这个进程再通过创建子进程为远程登陆用户提供各种允许的服务</p><ul><li>它提供与本地登陆几乎完全相同的用户界面</li></ul></li><li><p>Telnet 工作 在23端口</p><ul><li>SSH 工作 在22端口</li></ul></li></ul><h4 id=多媒体应用><a class=markdownIt-Anchor href=#多媒体应用></a> 多媒体应用</h4><ul><li>实时：CiscoTele-Presence，华为智真</li><li>非实时</li></ul></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class=category-chains><span class=category-chain><a href=/categories/%E5%A4%87%E5%BF%98/ class=category-chain-item>备忘</a></span></span></div><div class=post-meta><i class="iconfont icon-tags"></i> <a href=/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/ class=print-no-link>#计算机</a> <a href=/tags/%E7%BD%91%E7%BB%9C/ class=print-no-link>#网络</a></div></div><div class="license-box my-3"><div class=license-title><div>计算机网络备忘</div><div>https://justloseit.top/计算机网络备忘/</div></div><div class=license-meta><div class=license-meta-item><div>作者</div><div>Mobilis In Mobili</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2020年10月24日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2023年3月3日</div></div><div class=license-meta-item><div>许可协议</div><div><a class=print-no-link target=_blank href=https://creativecommons.org/licenses/by/4.0/ ><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href=/%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E8%BF%81%E7%A7%BB%E4%BB%A5%E5%8F%8A%E4%B8%80%E4%BA%9B%E6%9D%82%E8%B0%88/ title=博客主题迁移以及一些杂谈><i class="iconfont icon-arrowleft"></i> <span class=hidden-mobile>博客主题迁移以及一些杂谈</span> <span class=visible-mobile>上一篇</span></a></article><article class="post-next col-6"><a href=/%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90%E5%A4%87%E5%BF%98/ title=复杂网络分析备忘><span class=hidden-mobile>复杂网络分析备忘</span> <span class=visible-mobile>下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id=comments><div id=valine></div><script type=text/javascript>Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",function(){var i=Object.assign({appId:"t4w421aIGl2GXkT0tSGoap5I-gzGzoHsz",appKey:"BpNeeVt0v3tKAbF1L6RTf94X",path:"window.location.pathname",placeholder:"说点什么",avatar:"retro",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!1,serverURLs:"https://t4w421ai.lc-cn-n1-shared.com",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class=sidebar style=margin-left:-1rem><div id=toc><p class=toc-header><i class="iconfont icon-list"></i> <span>目录</span></p><div class=toc-body id=toc-body></div></div></aside></div></div></div><a id=scroll-top-button aria-label=TOP href=# role=button><i class="iconfont icon-arrowup" aria-hidden=true></i></a><div class="modal fade" id=modalSearch tabindex=-1 role=dialog aria-labelledby=ModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-lg" role=document><div class=modal-content><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type=button id=local-search-close class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type=text id=local-search-input class="form-control validate"> <label data-error=x data-success=v for=local-search-input>关键词</label></div><div class=list-group id=local-search-result></div></div></div></div></div></main><footer><div class=footer-inner><div class=footer-content><a href=https://hexo.io target=_blank rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href=https://github.com/fluid-dev/hexo-theme-fluid target=_blank rel="nofollow noopener"><span>Fluid</span></a></div><div class=statistics><span id=leancloud-site-pv-container style=display:none>总访问量 <span id=leancloud-site-pv></span> 次 </span><span id=leancloud-site-uv-container style=display:none>总访客数 <span id=leancloud-site-uv></span> 人</span></div><div class=beian><span><a href=http://beian.miit.gov.cn/ target=_blank rel="nofollow noopener"><a target=_blank rel=noopener href=https://beian.miit.gov.cn>京ICP备2021006744号-1</a> </a></span><span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802034644" rel="nofollow noopener" class=beian-police target=_blank><span style=visibility:hidden;width:0>|</span> <img src=/img/police_beian.png alt=police-icon> <span>京公网安备 11010802034644号</span></a></span></div></div></footer><script src=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js></script><link rel=stylesheet href=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src=https://lib.baomitu.com/jquery/3.6.4/jquery.min.js></script><script src=https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js></script><script src=/js/events.js></script><script src=/js/plugins.js></script><script src=https://lib.baomitu.com/typed.js/2.0.12/typed.min.js></script><script>(t=>{var e=Fluid.plugins.typing;(t=t.getElementById("subtitle"))&&e&&e(t.getAttribute("data-typed-text"))})((window,document))</script><script src=/js/img-lazyload.js></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script defer=defer src=/js/leancloud.js></script><script src=/js/local-search.js></script><script src=/js/boot.js></script><noscript><div class=noscript-warning>博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>