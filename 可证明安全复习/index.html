<!DOCTYPE html><html lang=zh-CN data-default-color-scheme=auto><head><meta charset=UTF-8><link rel=apple-touch-icon sizes=76x76 href=/img/favicon/favicon.png><link rel=icon href=/img/favicon/favicon.png><link rel=canonical href=https://justloseit.top/可证明安全复习/ ><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content=#2f4154><meta name=author content="Mobilis In Mobili"><meta name=keywords content=""><meta name=description content=之前写过前两章英文版的笔记，现在把这门课的复习备忘整理了一下。><meta property=og:type content=article><meta property=og:title content=可证明安全复习><meta property=og:url content=https://justloseit.top/%E5%8F%AF%E8%AF%81%E6%98%8E%E5%AE%89%E5%85%A8%E5%A4%8D%E4%B9%A0/index.html><meta property=og:site_name content=动中之动><meta property=og:description content=之前写过前两章英文版的笔记，现在把这门课的复习备忘整理了一下。><meta property=og:locale content=zh_CN><meta property=og:image content=https://justloseit.top/img/index/%E5%8F%AF%E8%AF%81%E6%98%8E%E5%AE%89%E5%85%A8%E5%A4%8D%E4%B9%A0.jpg><meta property=article:published_time content=2021-10-03T06:35:25.000Z><meta property=article:modified_time content=2023-03-03T06:49:24.759Z><meta property=article:author content="Mobilis In Mobili"><meta property=article:tag content=密码学><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=https://justloseit.top/img/index/%E5%8F%AF%E8%AF%81%E6%98%8E%E5%AE%89%E5%85%A8%E5%A4%8D%E4%B9%A0.jpg><title>可证明安全复习 - 动中之动</title><link rel=stylesheet href=https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css><link rel=stylesheet href=https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css><link rel=stylesheet href=https://lib.baomitu.com/hint.css/2.7.0/hint.min.css><link rel=stylesheet href=https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css><link rel=stylesheet href=https://lib.baomitu.com/KaTeX/0.16.2/katex.min.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css><link rel=stylesheet href=/css/main.css><link id=highlight-css rel=stylesheet href=/css/highlight.css><link id=highlight-css-dark rel=stylesheet href=/css/highlight-dark.css><script id=fluid-configs>var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"justloseit.top",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:60,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:"§"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:"snI2XNrHrhyx5g84m3Uim3EC-gzGzoHsz",app_key:"x2YseXJIHmvnsM4v9y9UAlvu",server_url:"https://sni2xnrh.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src=/js/utils.js></script><script src=/js/color-schema.js></script><meta name=generator content="Hexo 5.4.2"><link rel=alternate href=/atom.xml title=动中之动 type=application/atom+xml></head><body><header><div class=header-inner style=height:70vh><nav id=navbar class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=/ ><strong>Mobilis In Mobili</strong> </a><button id=navbar-toggler-btn class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"><div class=animated-icon><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto text-center"><li class=nav-item><a class=nav-link href=/ target=_self><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class=nav-item><a class=nav-link href=/archives/ target=_self><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class=nav-item><a class=nav-link href=/categories/ target=_self><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class=nav-item><a class=nav-link href=/tags/ target=_self><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class=nav-item><a class=nav-link href=/about/ target=_self><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class=nav-item><a class=nav-link href=/links/ target=_self><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class=nav-item id=search-btn><a class=nav-link target=_self href=javascript:; data-toggle=modal data-target=#modalSearch aria-label=Search><i class="iconfont icon-search"></i></a></li><li class=nav-item id=color-toggle-btn><a class=nav-link target=_self href=javascript:; aria-label="Color Toggle"><i class="iconfont icon-dark" id=color-toggle-icon></i></a></li></ul></div></div></nav><div id=banner class=banner parallax=true style="background:url(/img/banner/%E5%8F%AF%E8%AF%81%E6%98%8E%E5%AE%89%E5%85%A8%E5%A4%8D%E4%B9%A0.jpg) no-repeat center center;background-size:cover"><div class=full-bg-img><div class="mask flex-center" style=background-color:rgba(0,0,0,.3)><div class="banner-text text-center fade-in-up"><div class=h2><span id=subtitle data-typed-text=可证明安全复习></span></div><div class=mt-3><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden=true></i> Mobilis In Mobili </span><span class=post-meta><i class="iconfont icon-date-fill" aria-hidden=true></i> <time datetime="2021-10-03 14:35" pubdate>2021年10月3日 下午</time></span></div><div class=mt-1><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 9.6k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 81 分钟 </span><span id=leancloud-page-views-container class=post-meta style=display:none><i class="iconfont icon-eye" aria-hidden=true></i> <span id=leancloud-page-views></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id=board-ctn><div id=board><article class="post-content mx-auto"><h1 id=seo-header>可证明安全复习</h1><p id=updated-time class="note note-info">本文最后更新于 2023年3月3日 下午</p><div class=markdown-body><ul><li>之前写过前两章英文版的笔记，现在把这门课的复习备忘整理了一下。</li></ul><span id=more></span><ul><li>相关的参考教程是《Introduction To Modern Cryptography》（Second Edition），其中文版是《现代密码学——原理与协议》。中文版的翻译一言难尽，尤其是到了后面的规约部分。因此建议还是优先考虑英文版。</li><li>前两章的英文笔记可以参见 <a href=https://justloseit.top/Introduction%20To%20Modern%20Cryptography/ >Introduction To Modern Cryptography</a></li></ul><h1 id=可证明安全><a class=markdownIt-Anchor href=#可证明安全></a> 可证明安全</h1><h2 id=第一章引言><a class=markdownIt-Anchor href=#第一章引言></a> 第一章：引言</h2><h3 id=掌握现代密码学的三个原则><a class=markdownIt-Anchor href=#掌握现代密码学的三个原则></a> 掌握现代密码学的<strong>三个原则</strong></h3><ul><li>原则 1——形式化定义：解决任何密码学问题的第一步是形式化的表述严格且精确的安全定义<ul><li>如果特定的敌手不能完成特定的攻破，则对任务的一个密码学方案是安全的</li></ul></li><li>原则 2——精确假设：当密码学构造方案的安全性依赖于某个违背证明的假设时，这种假设必须精确地陈述，而且，所假设的要尽可能地少</li><li>原则 3——安全证明：密码学构造方案应当伴随有严格的安全证明，跟随符合原则 1 的安全定义，以及与原则 2 陈述的假设有关<ul><li>规约：若给定假设 X 是正确的，根据给定的定义，构造方案 Y 是安全的</li></ul></li></ul><h3 id=理解可证明安全的含义区分可证明安全和现实安全的关系><a class=markdownIt-Anchor href=#理解可证明安全的含义区分可证明安全和现实安全的关系></a> 理解可证明安全的<strong>含义</strong>，区分<strong>可证明安全</strong>和<strong>现实安全</strong>的关系</h3><h2 id=第二章完美保密><a class=markdownIt-Anchor href=#第二章完美保密></a> 第二章：完美保密</h2><h3 id=掌握完美保密-完美不可区分两种概念及等价性><a class=markdownIt-Anchor href=#掌握完美保密-完美不可区分两种概念及等价性></a> 掌握完美保密、完美不可区分两种概念及<strong>等价性</strong></h3><ul><li><p>完美保密：</p><ul><li>当明文和密文上的分布是<strong>独立</strong>的，方案才是完美保密的</li></ul><div class="note note-primary"><p>（完美保密）对明文空间为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>M</mi></mrow><annotation encoding=application/x-tex>\mathcal{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">M</span></span></span></span></span> 的加密方案 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Enc</mtext><mo separator=true>,</mo><mtext>Dec</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\text{Gen}, \text{Enc}, \text{Dec})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Enc</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Dec</span></span><span class=mclose>)</span></span></span></span> 若下列条件成立：<br>若对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>M</mi></mrow><annotation encoding=application/x-tex>\mathcal{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">M</span></span></span></span></span> 上任意的概率分布，任何明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><mi mathvariant=script>M</mi></mrow><annotation encoding=application/x-tex>m\in \mathcal{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">M</span></span></span></span></span>，任何密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>∈</mo><mi mathvariant=script>C</mi></mrow><annotation encoding=application/x-tex>c\in \mathcal{C}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal" style=margin-right:.05834em>C</span></span></span></span></span> 且 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi>C</mi><mo>=</mo><mi>c</mi><mo stretchy=false>]</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>\Pr{[C=c]} &gt; 0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">c</span><span class=mclose>]</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span>，有</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi>M</mi><mo>=</mo><mi>m</mi><mi mathvariant=normal>∣</mi><mi>C</mi><mo>=</mo><mi>c</mi><mo stretchy=false>]</mo></mrow><mo>=</mo><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi>M</mi><mo>=</mo><mi>m</mi><mo stretchy=false>]</mo></mrow></mrow><annotation encoding=application/x-tex>\Pr{[M=m|C=c]}=\Pr{[M=m]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">m</span><span class=mord>∣</span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">c</span><span class=mclose>]</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">m</span><span class=mclose>]</span></span></span></span></span></span></p><p>则该方案是完美保密的。</p></div></li><li><p>完美不可区分：</p><div class="note note-info"><p>（窃听不可区分实验）<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup></mrow><annotation encoding=application/x-tex>\text{PrivK}^{eav}_{\mathcal{A},\Pi}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.12073em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span></span></span></span>：</p><ol><li>敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 输出一对信息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub><mo>∈</mo><mi mathvariant=script>M</mi></mrow><annotation encoding=application/x-tex>m_0,m_1\in \mathcal{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7335400000000001em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">M</span></span></span></span></span>；</li><li>由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext></mrow><annotation encoding=application/x-tex>\text{Gen}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span></span></span></span> 产生一个随机密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>，并且从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span></span></span></span> 中<strong>随机</strong>选择一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>。然后，一个挑战密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>←</mo><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c\leftarrow \text{Enc}_k(m_b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 被计算出来并交给 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>；</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 输出一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>b&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>；</li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>b&#x27;=b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>，定义实验输出为 1，否则为 0。当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\text{PrivK}^{eav}_{\mathcal{A},\Pi}=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.12073em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 时，称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 成功。</li></ol></div><div class="note note-primary"><p>（完美不可区分）对明文空间为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 的加密方案 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Enc</mtext><mo separator=true>,</mo><mtext>Dec</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\text{Gen}, \text{Enc}, \text{Dec})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Enc</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Dec</span></span><span class=mclose>)</span></span></span></span> 若下列条件成立：<br>若对所有敌手都满足：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding=application/x-tex>\Pr{[\text{PrivK}^{eav}_{\mathcal{A},\Pi}=1]}=\frac{1}{2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.00744em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.32144em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>则该方案是完美不可区分的。</p></div></li><li><p><strong>等价性</strong>：完美保密和完美不可区分的定义<strong>等价</strong>，具体的证明可见英文版习题 2.5</p></li></ul><h3 id=掌握一次一密的原理><a class=markdownIt-Anchor href=#掌握一次一密的原理></a> 掌握一次一密的原理</h3><ul><li><p>一次一密方案</p><div class="note note-primary"><p>（一次一密）</p><ol><li>令整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>l &gt; 0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span>，设明文空间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>M</mi></mrow><annotation encoding=application/x-tex>\mathcal{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">M</span></span></span></span></span>，密钥空间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>K</mi></mrow><annotation encoding=application/x-tex>\mathcal{K}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal" style=margin-right:.01445em>K</span></span></span></span></span> 和密文空间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>C</mi></mrow><annotation encoding=application/x-tex>\mathcal{C}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal" style=margin-right:.05834em>C</span></span></span></span></span> 都等于 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}^l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.2390079999999999em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9890079999999999em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span></span></span></span></span></span></span>（即长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi></mrow><annotation encoding=application/x-tex>l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 的二进制比特串的集合）；</li><li>密钥产生算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext></mrow><annotation encoding=application/x-tex>\text{Gen}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span></span></span></span> 从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>k=\left\{0,1\right\}^l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.2390079999999999em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9890079999999999em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span></span></span></span></span></span></span> 中依据<strong>均匀分布</strong>选择一个二进制比特串。；</li><li>加密算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Enc</mtext></mrow><annotation encoding=application/x-tex>\text{Enc}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Enc</span></span></span></span></span>：给定一个密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>k\in \left\{0,1\right\}^l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.2390079999999999em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9890079999999999em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span></span></span></span></span></span></span> 和一个明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>m \in \left\{0,1\right\}^l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.2390079999999999em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9890079999999999em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span></span></span></span></span></span></span>，输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>:</mo><mo>=</mo><mi>k</mi><mo>⊕</mo><mi>m</mi></mrow><annotation encoding=application/x-tex>c:=k\oplus m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span>；</li><li>解密算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Dec</mtext></mrow><annotation encoding=application/x-tex>\text{Dec}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Dec</span></span></span></span></span>：给定一个密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>k\in \left\{0,1\right\}^l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.2390079999999999em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9890079999999999em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span></span></span></span></span></span></span> 和一个密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>c \in \left\{0,1\right\}^l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.2390079999999999em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9890079999999999em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span></span></span></span></span></span></span>，输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>:</mo><mo>=</mo><mi>k</mi><mo>⊕</mo><mi>c</mi></mrow><annotation encoding=application/x-tex>m:=k\oplus c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span>。</li></ol></div></li><li><p>安全性证明</p><ul><li>利用完美保密定义</li><li>利用香农定理</li></ul><div class="note note-secondary"><p>（香农定理）设加密方案 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Enc</mtext><mo separator=true>,</mo><mtext>Dec</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\text{Gen}, \text{Enc}, \text{Dec})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Enc</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Dec</span></span><span class=mclose>)</span></span></span></span> 的明文空间为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>M</mi></mrow><annotation encoding=application/x-tex>\mathcal{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">M</span></span></span></span></span>，且 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi mathvariant=script>K</mi><mi mathvariant=normal>∣</mi><mo>=</mo><mi mathvariant=normal>∣</mi><mi mathvariant=script>M</mi><mi mathvariant=normal>∣</mi><mo>=</mo><mi mathvariant=normal>∣</mi><mi mathvariant=script>C</mi><mi mathvariant=normal>∣</mi></mrow><annotation encoding=application/x-tex>|\mathcal{K}|=|\mathcal{M}|=|\mathcal{C}|</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class=mord><span class="mord mathcal" style=margin-right:.01445em>K</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class=mord><span class="mord mathcal">M</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class=mord><span class="mord mathcal" style=margin-right:.05834em>C</span></span><span class=mord>∣</span></span></span></span>，则当且仅当下列条件成立时，此方案是完美保密：</p><ol><li>由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext></mrow><annotation encoding=application/x-tex>\text{Gen}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span></span></span></span> 产生的任意密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>∈</mo><mi mathvariant=script>K</mi></mrow><annotation encoding=application/x-tex>k\in \mathcal{K}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal" style=margin-right:.01445em>K</span></span></span></span></span> 的概率都是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mfrac><mn>1</mn><mrow><mi mathvariant=normal>∣</mi><mi mathvariant=script>K</mi><mi mathvariant=normal>∣</mi></mrow></mfrac></mrow><annotation encoding=application/x-tex>\frac{1}{|\mathcal{K}|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.365108em;vertical-align:-.52em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.845108em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:.01445em>K</span></span><span class="mord mtight">∣</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.52em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>；</li><li>对任意明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><mi mathvariant=script>M</mi></mrow><annotation encoding=application/x-tex>m \in \mathcal{M}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">M</span></span></span></span></span> 和任意密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>∈</mo><mi mathvariant=script>C</mi></mrow><annotation encoding=application/x-tex>c\in \mathcal{C}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal" style=margin-right:.05834em>C</span></span></span></span></span>，只存在唯一的密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>∈</mo><mi mathvariant=script>K</mi></mrow><annotation encoding=application/x-tex>k\in \mathcal{K}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal" style=margin-right:.01445em>K</span></span></span></span></span> 使得 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class="mord mathdefault">n</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span> 输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span>。</li></ol></div></li></ul><h3 id=掌握一次一密的优缺点><a class=markdownIt-Anchor href=#掌握一次一密的优缺点></a> 掌握一次一密的优缺点</h3><ul><li>优点：一次一密是完美保密</li><li>缺点：<ul><li>密钥要和密文有一样的长度，因此在应用中的<strong>存储</strong>和<strong>共享</strong>都是很困难的</li><li>如果重用密钥，就会泄露两条消息异或的结果。<p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable rowspacing=0.24999999999999992em columnalign="right left" columnspacing=0em><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mi>c</mi><mo>⊕</mo><msup><mi>c</mi><mo mathvariant=normal>′</mo></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mo stretchy=false>(</mo><mi>m</mi><mo>⊕</mo><mi>k</mi><mo stretchy=false>)</mo><mo>⊕</mo><mrow><mo fence=true>(</mo><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo>⊕</mo><mi>k</mi><mo fence=true>)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>m</mi><mo>⊕</mo><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned}c \oplus c^{\prime} &amp;=(m \oplus k) \oplus\left(m^{\prime} \oplus k\right) \\&amp;=m \oplus m^{\prime}\end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:3.0000000000000004em;vertical-align:-1.2500000000000002em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.7500000000000002em><span style=top:-3.91em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.801892em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style=top:-2.41em><span class=pstrut style=height:3em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2500000000000002em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.7500000000000002em><span style=top:-3.91em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.801892em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class="mclose delimcenter" style=top:0>)</span></span></span></span><span style=top:-2.41em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.801892em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2500000000000002em><span></span></span></span></span></span></span></span></span></span></span></span></p></li></ul></li></ul><h2 id=第三章单钥加密><a class=markdownIt-Anchor href=#第三章单钥加密></a> 第三章：单钥加密</h2><h3 id=掌握具体方法和渐近方法的含义><a class=markdownIt-Anchor href=#掌握具体方法和渐近方法的含义></a> 掌握具体方法和渐近方法的含义</h3><ul><li><p>具体方法 Concrete Approach</p><ul><li>通过<strong>明确限定</strong>任意敌手在最多某个特定时间内的最大成功概率，对一个给定的密码学方案的安全性进行量化。</li></ul><div class="note note-primary"><p>（具体方法）如果每个运行时问最多为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.61508em;vertical-align:0></span><span class="mord mathdefault">t</span></span></span></span> 的敌手以最多为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>ε</mi></mrow><annotation encoding=application/x-tex>\varepsilon</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">ε</span></span></span></span> 的概率成功攻破一个方案，则称该方案为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>t</mi><mo separator=true>,</mo><mi>ε</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(t, \varepsilon)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">t</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">ε</span><span class=mclose>)</span></span></span></span> 安全。</p></div></li><li><p>渐进方法 Asymptotic Approach</p><ul><li>来源于复杂性理论（相关知识备忘可见<a href=https://justloseit.top/%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA%E5%A4%A7%E7%BA%B2/ >计算理论备忘</a>，将敌手的运行时间以及成功的概率视为<strong>某个参数的函数</strong>，而非具体数值。</li><li>如果每个 PPT（<strong>概率多项式时间</strong>）的敌手以<strong>可忽略的概率</strong>成功攻破一个方案，那么该方案是安全的。</li></ul><div class="note note-primary"><p>（渐进方法）如果每个概率多项式时间的敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 执行某个特定类型的攻击，对于每个多项式 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>p(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">p</span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>，存在一个整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>N</mi></mrow><annotation encoding=application/x-tex>N</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>N</span></span></span></span>：对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>&gt;</mo><mi>N</mi><mo separator=true>,</mo><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>n&gt;N, \mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 在这次攻击中成功的概率小于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mfrac><mn>1</mn><mrow><mi>p</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow></mfrac></mrow><annotation encoding=application/x-tex>\frac{1}{p(n)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.365108em;vertical-align:-.52em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.845108em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.52em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，则这个方案是安全的。</p></div></li><li><p>规约证明：对任意消息长度大于密钥长度加密方案的安全性的<strong>无条件</strong>证明意味着需要 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>P</mi><mi mathvariant=normal>≠</mi><mrow><mi mathvariant=script>N</mi><mi mathvariant=script>P</mi></mrow></mrow><annotation encoding=application/x-tex>\mathcal{P}\neq \mathcal{NP}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathcal" style=margin-right:.08222em>P</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal" style=margin-right:.14736em>N</span><span class="mord mathcal" style=margin-right:.08222em>P</span></span></span></span></span>。（😵）因此，比起简单地假设给定的方案是正确的，更好的策略是假设某个<strong>低层次难题</strong>很难解决，然后证明<strong>基于这个假设构造</strong>的构造的方案是安全的。</p></li></ul><h3 id=掌握窃听不可区分安全两种定义等价性><a class=markdownIt-Anchor href=#掌握窃听不可区分安全两种定义等价性></a> 掌握窃听不可区分安全两种<strong>定义等价性</strong></h3><blockquote><p><em>这里的方案均考虑的对称加密体制</em></p></blockquote><ul><li><p>不可区分安全 EAV-secure</p><div class="note note-info"><p>（窃听不可区分实验）<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>给定输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^{n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> 给敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>， <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 输出一对<strong>长度相等</strong>的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>m_{0}, m_{1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；</li><li>由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 产生一个随机密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>，并且从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span></span></span></span> 中<strong>随机</strong>选择一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>。然后，一个挑战密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>←</mo><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c\leftarrow \text{Enc}_k(m_b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 被计算出来并交给 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>；</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 输出一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>b&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>；</li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>b&#x27;=b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>，定义实验输出为 1，否则为 0。当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n)=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 时，称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 成功。</li></ol></div></li><li><p>定义1：</p><ul><li>说明了 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 不能判断哪一个明文被加密的概率<strong>明显</strong>大于<strong>随机猜测成功</strong>的概率</li></ul><div class="note note-primary"><p>（窃听不可区分安全定义 1）如果对于所有的 PPT 敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 使得：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n)=1]}|\leq \frac{1}{2} + negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.00744em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.32144em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则称该方案存在不可区分性。</p></div></li><li><p>定义2：定义 3.9</p><ul><li>说明了 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 无法判断实验是在 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mn>0</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n,0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>0</span><span class=mclose>)</span></span></span></span> 还是 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mn>1</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n,1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mclose>)</span></span></span></span> 中运行。</li></ul><div class="note note-secondary"><p>（扩展窃听不可区分实验的符号定义）<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n,b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class=mclose>)</span></span></span></span>，是指使用了一个固定比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span> 而非随机选择的窃听不可区分实验。<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy=false>(</mo><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>output(\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n,b))</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class=mopen>(</span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class=mclose>)</span><span class=mclose>)</span></span></span></span> 表示 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 在 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n,b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class=mclose>)</span></span></span></span> 中的输出比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>b&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>。</p></div><div class="note note-primary"><p>（不可区分安全定义 2）如果对于所有的 PPT 敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 使得：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy=false>(</mo><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mn>0</mn><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mo>−</mo><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy=false>(</mo><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mn>1</mn><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[output(\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n,0))=1]}-\Pr{[output(\text{PrivK}^{eav}_{\mathcal{A},\Pi}(n,1))=1]}|\leq negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class=mopen>(</span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>0</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class=mopen>(</span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则称该方案存在不可区分性。</p></div></li><li><p>等价性：不可区分安全定义 1 和不可区分安全定义 2 <strong>等价</strong>，具体的证明可见英文版习题 3.4</p></li></ul><h3 id=cpa-安全-cca安全><a class=markdownIt-Anchor href=#cpa-安全-cca安全></a> CPA 安全、CCA安全</h3><ul><li><p>CPA（选择密文攻击）安全</p><ul><li>任何确定加密方案<strong>都不能</strong>抵御选择密文攻击。任何 CPA 安全的加密方案必须是<strong>概率性</strong>的，即必须将随机性作为加密过程中的一部分来确保<strong>相同消息的加密可能是不同的</strong>。</li></ul><div class="note note-info"><p>（CPA 不可区分实验）<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>p</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PrivK}^{cpa}_{\mathcal{A},\Pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.211939em;vertical-align:-.429639em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.7823em><span style=top:-2.4064690000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1809080000000005em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.429639em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 生成密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>；</li><li>输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 给敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>可以访问预言机 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Enc}_k(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span></strong>，输出一对<strong>长度相等</strong>的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>m_0,m_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；</li><li>从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span></span></span></span> 中<strong>随机</strong>选择一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>。然后，一个挑战密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>←</mo><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c\leftarrow \text{Enc}_k(m_b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 被计算出来并交给 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>；</li><li>敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>继续访问预言机 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Enc}_k(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span></strong>，输出一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>b&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>；</li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>b&#x27;=b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>，定义实验输出为 1，否则为 0。当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>p</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\text{PrivK}^{cpa}_{\mathcal{A},\Pi}(n)=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.211939em;vertical-align:-.429639em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.7823em><span style=top:-2.4064690000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1809080000000005em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.429639em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 时，称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 成功。</li></ol></div><div class="note note-primary"><p>（选择明文攻击条件下的不可区分）如果对于所有的 PPT 敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 使得：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>p</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{PrivK}^{cpa}_{\mathcal{A},\Pi}(n)=1]}|\leq \frac{1}{2} + negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.211939em;vertical-align:-.429639em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.7823em><span style=top:-2.4064690000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1809080000000005em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.429639em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.00744em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.32144em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则称该方案存在不可区分性。</p></div></li><li><p>CCA（选择密文攻击） 安全</p><div class="note note-info"><p>（CCA 不可区分实验）<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>c</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PrivK}^{cca}_{\mathcal{A},\Pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 生成密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>；</li><li>输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 给敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>可以访问预言机 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Enc}_k(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Dec</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Dec}_k(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Dec</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span></strong>，输出一对<strong>长度相等</strong>的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>m_0,m_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；</li><li>从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span></span></span></span> 中<strong>随机</strong>选择一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>。然后，一个挑战密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>←</mo><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c\leftarrow \text{Enc}_k(m_b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 被计算出来并交给 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>；</li><li>敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>继续访问预言机 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Enc}_k(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Dec</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Dec}_k(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Dec</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span></strong>（但是不允许用挑战密文本身来询问 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Dec</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Dec}_k(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Dec</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>），输出一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>b&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>；</li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>b&#x27;=b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>，定义实验输出为 1，否则为 0。当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>c</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\text{PrivK}^{cca}_{\mathcal{A},\Pi}(n)=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 时，称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 成功。</li></ol></div><div class="note note-primary"><p>（选择密文攻击条件下的不可区分）如果对于所有的 PPT 敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 使得：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msubsup><mtext>PrivK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>c</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{PrivK}^{cca}_{\mathcal{A},\Pi}(n)=1]}|\leq \frac{1}{2} + negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>PrivK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.737622em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.00744em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.32144em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则称该方案存在不可区分性。</p></div></li></ul><h3 id=掌握伪随机生成器和伪随机函数的概念-安全性><a class=markdownIt-Anchor href=#掌握伪随机生成器和伪随机函数的概念-安全性></a> 掌握伪随机生成器和伪随机函数的概念、安全性</h3><ul><li>伪随机性：一个伪随机的字符串是<strong>多项式时间内均匀分布</strong>的字符串。<ul><li>是真随机性在计算上的松弛。</li><li>没有固定的字符串能够被认为是“伪随机的”，伪随机性指的是<strong>字符串的分布</strong>。</li><li>这样，就实现了短密钥（相对短的随机种子）加密一个长消息（长的伪随机字符串）</li></ul></li><li>伪随机生成器：<div class="note note-primary"><p>（伪随机生成器）令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>l(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span> 为多项式，令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span> 为多项式时间算法，该算法满足：对于任何输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>s\in \left\{0,1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span> 输出一个长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>l(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> 的字符串。如果满足下面两个条件，则称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span> 是一个伪随机生成器：</p><ol><li>（扩展性）对于每个 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 来说，满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>l(n) &gt; n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>。</li><li>（伪随机性）对所有 PPT 的区分器 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>D</mi></mrow><annotation encoding=application/x-tex>D</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>D</span></span></span></span> 来说，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span>，满足</li></ol><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi>D</mi><mo stretchy=false>(</mo><mi>r</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mo>−</mo><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi>D</mi><mo stretchy=false>(</mo><mi>G</mi><mo stretchy=false>(</mo><mi>s</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[D(r)=1]}-\Pr{[D(G(s))=1]}|\leq negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=mopen>(</span><span class="mord mathdefault">G</span><span class=mopen>(</span><span class="mord mathdefault">s</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><ul><li>其中，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span> 是从 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>l</mi></msup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}^l(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.2390079999999999em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9890079999999999em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> 中均匀随机选择，种子 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 是从 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 中均匀随机选择的。</li><li>函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>l(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span> 被称为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span> 的扩展系数。</li></ul></div></li><li>伪随机函数：<ul><li>从伪随机生成器的<strong>字符串分布</strong>的随机性，扩展到<strong>函数分布</strong>的随机性</li><li>这里的区分器 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>D</mi></mrow><annotation encoding=application/x-tex>D</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>D</span></span></span></span> 事实上已经涉及到 <code>Random Oracle</code>，为了方便理解，这里先不做展开</li></ul><div class="note note-primary"><p>（伪随机函数）令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mo>∗</mo></msup><mo>×</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mo>∗</mo></msup><mo>→</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>F:\{0,1\}^{*} \times\{0,1\}^{*} \rightarrow\{0,1\}^{*}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>→</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> 是有效的、长度保留的、带密钥的函数。如果对所有多项式时间区分器 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>D</mi></mrow><annotation encoding=application/x-tex>D</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>D</span></span></span></span>，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span>，满足：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msup><mi>D</mi><mrow><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow></msup><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mo>−</mo><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msup><mi>D</mi><mrow><mi>f</mi><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow></msup><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[D^{F_k(\cdot)}(1^n)=1]}-\Pr{[D^{f(\cdot)}(1^n)=1]}|\leq negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.188em;vertical-align:-.25em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3487714285714287em;margin-left:-.13889em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15122857142857138em><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">⋅</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.188em;vertical-align:-.25em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.10764em>f</span><span class="mopen mtight">(</span><span class="mord mtight">⋅</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 是一个伪随机函数。</p><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 是从 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 中均匀随机选择的。</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi></mrow><annotation encoding=application/x-tex>f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span></span></span></span> 是从将 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 比特字符串映射到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 比特字符串的<strong>函数集合</strong>中中均匀随机选择的。</li></ul></div></li></ul><h3 id=掌握如何构造cpa安全加密方案><a class=markdownIt-Anchor href=#掌握如何构造cpa安全加密方案></a> 掌握如何构造CPA安全加密方案</h3><ul><li>从<strong>任意</strong>伪随机函数构造 CPA 安全的加密方案<ul><li>直接使用 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>F_k(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span> 是不行的，因为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Enc</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo><mo>=</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>cot</mi><mo>⁡</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Enc}_k(\cdot)=F_k(\cot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mop>cot</span><span class=mclose>)</span></span></span></span> 是一个确定的函数。因此，需要概率性构造——思路是利用<strong>伪随机填充 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>r</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>F_k(r)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mclose>)</span></span></span></span></strong> 模仿一次一密</li></ul><div class="note note-warning"><p>（构造方法）令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 是伪随机函数，定义一个消息长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的对称密钥加密方案如下：</p><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext></mrow><annotation encoding=application/x-tex>\text{Gen}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span></span></span></span>：输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，均匀随机地选择 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>←</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k\leftarrow \left\{0,1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，并将其作为密钥输出。</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Enc</mtext></mrow><annotation encoding=application/x-tex>\text{Enc}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Enc</span></span></span></span></span>：输入一个密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k\in \left\{0,1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 以及一个消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>m\in \left\{0,1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，均匀随机地选择 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi><mo>←</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>r\leftarrow \left\{0,1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，并输出密文</li></ul><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>:</mo><mo>=</mo><mrow><mo fence=true>⟨</mo><mi>r</mi><mo separator=true>,</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>r</mi><mo stretchy=false>)</mo><mo>⊕</mo><mi>m</mi><mo fence=true>⟩</mo></mrow></mrow><annotation encoding=application/x-tex>c:=\left\langle r, F_{k}(r) \oplus m\right\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>⟨</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">m</span><span class="mclose delimcenter" style=top:0>⟩</span></span></span></span></span></span></p><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow><mi>D</mi><mi>e</mi><mi>c</mi></mrow></mrow><annotation encoding=application/x-tex>text{Dec}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span></span></span></span></span>: 输入一个密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k \in\{0,1\}^{n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>，以及一个密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>=</mo><mo stretchy=false>⟨</mo><mi>r</mi><mo separator=true>,</mo><mi>s</mi><mo stretchy=false>⟩</mo></mrow><annotation encoding=application/x-tex>c=\langle r, s\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⟨</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class=mclose>⟩</span></span></span></span>，输出明文消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>:</mo><mo>=</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>r</mi><mo stretchy=false>)</mo><mo>⊕</mo><msub><mi>s</mi><mo>∘</mo></msub></mrow><annotation encoding=application/x-tex>m:=F_{k}(r) \oplus s_{\circ}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16111499999999998em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></li></ul></div></li></ul><h3 id=理解-cbc-模式-ctr-模式-理解-padding-oracle-攻击><a class=markdownIt-Anchor href=#理解-cbc-模式-ctr-模式-理解-padding-oracle-攻击></a> 理解 CBC 模式、CTR 模式、 理解 Padding Oracle 攻击</h3><ul><li><p>CBC 模式</p><ul><li>由公式 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>:</mo><mo>=</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><msub><mi>c</mi><mn>0</mn></msub><mo>:</mo><mo>=</mo><mi>I</mi><mi>V</mi></mrow><annotation encoding=application/x-tex>c_i:=F_k(c_{i-1}\oplus m_i), c_0:=IV</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class="mord mathdefault" style=margin-right:.22222em>V</span></span></span></span> 得到密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>⟨</mo><msub><mi>c</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true>,</mo><msub><mi>c</mi><mi>l</mi></msub><mo stretchy=false>⟩</mo></mrow><annotation encoding=application/x-tex>\langle c_0, c_1, \cdots, c_l \rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⟨</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>⟩</span></span></span></span></li><li>从公式上来看，如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 为伪随机置换，那么 CBC 加密模式是 <strong>CPA 安全</strong>的<ul><li>同理，OFB 模式也是 CPA 安全的</li></ul></li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>I</mi><mi>V</mi></mrow><annotation encoding=application/x-tex>IV</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class="mord mathdefault" style=margin-right:.22222em>V</span></span></span></span> <strong>必须</strong>是随机的，如果仅仅是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>I</mi><mi>V</mi><mo>+</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>IV += 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=mord>+</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>，是不安全的。</li></ul></li><li><p>CTR 模式</p><ul><li>由公式 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>:</mo><mo>=</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>c</mi><mi>t</mi><mi>r</mi><mo>+</mo><mi>i</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><msub><mi>c</mi><mi>i</mi></msub><mo>:</mo><mo>=</mo><msub><mi>r</mi><mi>i</mi></msub><mo>⊕</mo><msub><mi>m</mi><mi>I</mi></msub></mrow><annotation encoding=application/x-tex>r_i:=F_k(ctr + i), c_i:=r_i \oplus m_I</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">i</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07847em>I</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 得到密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>⟨</mo><msub><mi>c</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true>,</mo><msub><mi>c</mi><mi>l</mi></msub><mo stretchy=false>⟩</mo></mrow><annotation encoding=application/x-tex>\langle c_0, c_1, \cdots, c_l \rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⟨</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>⟩</span></span></span></span></li><li>和 OFB 模式一样，对解密不要求 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 可逆，甚至不要求是置换</li><li>从公式上来看，如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 为伪随机置换，那么 CTR 加密模式也是 <strong>CPA 安全</strong>的</li></ul></li></ul><div class="note note-danger"><p>尽管流密码更有效，但是在实践中，分组密码不仅更好理解，而且可以防止因为乱用导致的不安全问题（例如相同的伪随机序列被使用两次）。因此，推荐使用分组密码。</p></div><ul><li>Padding Oracle 攻击<ul><li><strong>CBC 模式</strong>对密码块链接进行解密需要先解密所有密文组，再验证填充，随后移除填充，最后再返回解密后的明文信息。</li><li>若服务器返回**“填充无效”信息**而非“解密失败”错误，则攻击者可利用服务器本身进行密文填塞来解密（或加密）信息。</li><li>攻击方式：<ol><li>假设攻击者拥有密文块 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>C_1,C_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，且欲解密 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>C_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 得到明文块 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>P_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>。攻击者可以更改 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>C_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的最后一个字节，得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>C</mi><mn>1</mn><mo mathvariant=normal>′</mo></msubsup></mrow><annotation encoding=application/x-tex>C_1&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-2.4518920000000004em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span>，此时块 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>P_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 中的对应字节也会被修改。</li><li>攻击者发送 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>I</mi><mi>V</mi><mo separator=true>,</mo><msubsup><mi>C</mi><mn>1</mn><mrow><mo mathvariant=normal>′</mo><mo mathvariant=normal>′</mo></mrow></msubsup><mo separator=true>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(IV, C_1&#x27;&#x27;,C_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-2.4518920000000004em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 至服务器，服务器随后将返回最后一个解密块的填充是否正确（是否等于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mi>x</mi><mn>01</mn></mrow><annotation encoding=application/x-tex>0x01</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class="mord mathdefault">x</span><span class=mord>0</span><span class=mord>1</span></span></span></span>）</li><li>如果填充正确，攻击者则能确定 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>D</mi><mi>K</mi></msub><mo stretchy=false>(</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy=false>)</mo><mo>⊕</mo><msubsup><mi>C</mi><mn>1</mn><mo mathvariant=normal>′</mo></msubsup></mrow><annotation encoding=application/x-tex>D_K(C_i)\oplus C_1&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-2.4518920000000004em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span> 的最后一个字节是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mi>x</mi><mn>01</mn></mrow><annotation encoding=application/x-tex>0x01</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class="mord mathdefault">x</span><span class=mord>0</span><span class=mord>1</span></span></span></span>，即 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>D</mi><mi>K</mi></msub><mo stretchy=false>(</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo>=</mo><msubsup><mi>C</mi><mn>1</mn><mo mathvariant=normal>′</mo></msubsup><mo>⊕</mo><mn>0</mn><mi>x</mi><mn>01</mn></mrow><annotation encoding=application/x-tex>D_K(C_2)=C_1&#x27;\oplus 0x01</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-2.4518920000000004em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class="mord mathdefault">x</span><span class=mord>0</span><span class=mord>1</span></span></span></span>。</li><li>如果填充不正确，攻击者则可以将 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>C</mi><mn>1</mn><mo mathvariant=normal>′</mo></msubsup></mrow><annotation encoding=application/x-tex>C_1&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-2.4518920000000004em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span> 的最后一个字节更改为下一个可能的值。在最糟糕的情况下，需要 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>8</mn></msup></mrow><annotation encoding=application/x-tex>2^8</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span> 次来确定最后一个字节。</li><li>在确定了 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>P_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的最后一个字节后，攻击者可以使用相同的手段来获取倒数第二个字节。</li></ol></li></ul></li></ul><h2 id=第四章消息认证码><a class=markdownIt-Anchor href=#第四章消息认证码></a> 第四章：消息认证码</h2><h3 id=掌握mac定义-安全性><a class=markdownIt-Anchor href=#掌握mac定义-安全性></a> 掌握MAC定义、安全性</h3><ul><li><p>定义：定义4.1</p><div class="note note-primary"><p>（MAC 定义）消息认证码是一个 PPT 算法的三元组 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Mac</mtext><mo separator=true>,</mo><mtext>Vrfy</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\text{Gen},\text{Mac},\text{Vrfy})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Mac</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Vrfy</span></span><span class=mclose>)</span></span></span></span>，满足：</p><ol><li>密钥生成算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext></mrow><annotation encoding=application/x-tex>\text{Gen}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span></span></span></span>：输入参数 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，输出长度不小于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>。</li><li>标记生成算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Mac</mtext></mrow><annotation encoding=application/x-tex>\text{Mac}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Mac</span></span></span></span></span>：输入密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 和消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>m\in \left\{0,1\right\}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.078596em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.828596em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>，输出标记 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi><mo>←</mo><msub><mtext>Mac</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>t \leftarrow \text{Mac}_k(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.61508em;vertical-align:0></span><span class="mord mathdefault">t</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Mac</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span>。该算法具有随机性。</li><li>校验算法：输入密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>、消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 和标记 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.61508em;vertical-align:0></span><span class="mord mathdefault">t</span></span></span></span>，输出比特位 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi><mo>:</mo><mo>=</mo><msub><mtext>Vrfy</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>t</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>b:=\text{Vrfy}_k(m,t)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Vrfy</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.24196799999999993em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24414em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">t</span><span class=mclose>)</span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>b = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 表示有效，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>b = 0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span> 表示无效。</li></ol></div><ul><li>规范验证：对于确定性消息身份验证代码（即 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Mac</mtext></mrow><annotation encoding=application/x-tex>\text{Mac}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Mac</span></span></span></span></span> 是确定性算法），执行验证的规范方法是简单地<strong>重新计算标签并检查相等性</strong>。换句话说， <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><msub><mrow><mi>V</mi><mi>r</mi><mi>f</mi><mi>y</mi></mrow><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>t</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>text{Vrfy}_k(m,t)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.24196799999999993em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24414em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">t</span><span class=mclose>)</span></span></span></span> 首先计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>t</mi><mo mathvariant=normal>′</mo></msup><mo>:</mo><mo>=</mo><msub><mtext>Gen</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>t&#x27;:= \text{Gen}_k(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Gen</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span> 然后当且仅当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>t</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>t</mi></mrow><annotation encoding=application/x-tex>t&#x27; = t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.61508em;vertical-align:0></span><span class="mord mathdefault">t</span></span></span></span> 时输出 1。<ul><li>然而，即使对于确定性 MAC，定义单独的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Vrfy</mtext></mrow><annotation encoding=application/x-tex>\text{Vrfy}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Vrfy</span></span></span></span></span> 算法也很有用，以便明确区分验证消息的语义与验证其真实性。</li></ul></li></ul></li><li><p>安全性：</p><div class="note note-info"><p>（消息识别码实验/适应性选择消息攻击）<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Mac-forge</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Mac-forge}_{\mathcal{A},\Pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord><span class="mord text"><span class=mord>Mac-forge</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 生成密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>；</li><li>输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 给敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>可以访问预言机 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Mac</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Mac}_k(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Mac</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span></strong>，输出一对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>t</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(m, t)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">t</span><span class=mclose>)</span></span></span></span> 的值，并用 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>Q</mi></mrow><annotation encoding=application/x-tex>\mathcal{Q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal">Q</span></span></span></span></span> 表示所有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 对预言机的询问集合；</li><li>当且仅当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Vrfy</mtext><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>t</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mi>m</mi><mi mathvariant=normal>∉</mi><mi mathvariant=script>Q</mi></mrow><annotation encoding=application/x-tex>\text{Vrfy}(m, t) = 1, m\notin \mathcal{Q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Vrfy</span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">t</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mord><span class=mrel>∈</span></span><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.75em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=llap><span class=strut style=height:1em;vertical-align:-.25em></span><span class=inner><span class=mord><span class=mord>/</span><span class=mspace style=margin-right:.05555555555555555em></span></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.25em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal">Q</span></span></span></span></span> 时，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Mac-forge</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\text{Mac-forge}_{\mathcal{A},\Pi}(n) = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord><span class="mord text"><span class=mord>Mac-forge</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>；</li></ol></div><div class="note note-primary"><p>（消息识别码安全性）一个消息识别码 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>Π</mi><mo>=</mo><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Mac</mtext><mo separator=true>,</mo><mtext>Vrfy</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi = (\text{Gen},\text{Mac},\text{Vrfy})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>Π</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Mac</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Vrfy</span></span><span class=mclose>)</span></span></span></span>，如果对所有多项式时间敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span>， 满足</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msub><mtext>Mac-forge</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{Mac-forge}_{\mathcal{A},\Pi}(n) = 1]}|\leq negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>Mac-forge</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则该消息识别码是适应性选择消息攻击下安全的。</p></div><ul><li>strong MAC：安全消息识别码保证了敌手不能对新的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 伪造有效的标记 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.61508em;vertical-align:0></span><span class="mord mathdefault">t</span></span></span></span>，但并未限制敌手不能对已验证过的 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>m_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 伪造有效的标记 t^'。因此，我们将消息识别码实验 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Mac-forge</mtext></mrow><annotation encoding=application/x-tex>\text{Mac-forge}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Mac-forge</span></span></span></span></span> 扩展为强消息识别码实验 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Mac-sforge</mtext></mrow><annotation encoding=application/x-tex>\text{Mac-sforge}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Mac-sforge</span></span></span></span></span>。<ul><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Mac-sforge</mtext></mrow><annotation encoding=application/x-tex>\text{Mac-sforge}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Mac-sforge</span></span></span></span></span> 的变化：将 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>Q</mi></mrow><annotation encoding=application/x-tex>\mathcal{Q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal">Q</span></span></span></span></span> 由询问集合变成了询问集合及其相关的回应。即：如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 查询 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Mac</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Mac}_k(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Mac</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span> ，收到标记 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.61508em;vertical-align:0></span><span class="mord mathdefault">t</span></span></span></span>，则 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>t</mi><mo stretchy=false>)</mo><mo>∈</mo><mi mathvariant=script>Q</mi></mrow><annotation encoding=application/x-tex>(m, t)\in \mathcal{Q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">t</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal">Q</span></span></span></span></span>。 当且仅当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Vrfy</mtext><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>t</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>t</mi><mo stretchy=false>)</mo><mi mathvariant=normal>∉</mi><mi mathvariant=script>Q</mi></mrow><annotation encoding=application/x-tex>\text{Vrfy}(m, t) = 1, (m, t)\notin \mathcal{Q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Vrfy</span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">t</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">t</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mord><span class=mrel>∈</span></span><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.75em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=llap><span class=strut style=height:1em;vertical-align:-.25em></span><span class=inner><span class=mord><span class=mord>/</span><span class=mspace style=margin-right:.05555555555555555em></span></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.25em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal">Q</span></span></span></span></span> 时，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Mac-sforge</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\text{Mac-sforge}_{\mathcal{A},\Pi}(n) = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord><span class="mord text"><span class=mord>Mac-sforge</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>；</p><div class="note note-info"><p>（消息识别码强安全性）一个消息识别码 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>Π</mi><mo>=</mo><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Mac</mtext><mo separator=true>,</mo><mtext>Vrfy</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi = (\text{Gen},\text{Mac},\text{Vrfy})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>Π</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Mac</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Vrfy</span></span><span class=mclose>)</span></span></span></span>，如果对所有多项式时间敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span>， 满足</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msub><mtext>Mac-sforge</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{Mac-sforge}_{\mathcal{A},\Pi}(n) = 1]}|\leq negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>Mac-sforge</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则该消息识别码是适应性选择消息攻击下强安全的。</p></div><div class="note note-secondary"><p>（从安全到强安全）如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>Π</mi><mo>=</mo><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Mac</mtext><mo separator=true>,</mo><mtext>Vrfy</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi = (\text{Gen},\text{Mac},\text{Vrfy})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>Π</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Mac</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Vrfy</span></span><span class=mclose>)</span></span></span></span> 是使用规范验证的安全消息识别码，那么它也是强安全的。</p></div></li></ul></li></ul></li></ul><h3 id=掌握cbc-mac以及安全性><a class=markdownIt-Anchor href=#掌握cbc-mac以及安全性></a> <strong>掌握CBC-MAC，以及安全性</strong></h3><ul><li><p>构造</p><div class="note note-warning"><p>（构造方法）令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 是一个伪随机函数，固定的长度函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi></mrow><annotation encoding=application/x-tex>l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span>。基本的 CBC-MAC 构造如下：</p><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext></mrow><annotation encoding=application/x-tex>\text{Gen}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span></span></span></span>：输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，均匀选择 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>←</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k\leftarrow \left\{0, 1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>；</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Mac</mtext></mrow><annotation encoding=application/x-tex>\text{Mac}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Mac</span></span></span></span></span>：输入密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 和长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>⋅</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>l(n)\cdot n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span>，进行：<ol><li>将 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 分块为 $m_1, \cdots, m_l，每个 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>m_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>，并令 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>:</mo><mo>=</mo><msup><mn>0</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>t_0 := 0 ^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76508em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>0</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>；</li><li>对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true>,</mo><mi>l</mi></mrow><annotation encoding=application/x-tex>i = 1, \cdots,l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span>，令 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>t</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>t_i = F_k(t_{i - 1} \oplus m_i)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76508em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>；</li><li>输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>t_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76508em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 作为标记。</li></ol></li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Vrfy</mtext></mrow><annotation encoding=application/x-tex>\text{Vrfy}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Vrfy</span></span></span></span></span>：输入密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k\in \left\{0, 1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>、长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>⋅</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>l(n)\cdot n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 和 长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的标记 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.61508em;vertical-align:0></span><span class="mord mathdefault">t</span></span></span></span>，当且仅当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi><mo>=</mo><msub><mtext>Mac</mtext><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>t=\text{Mac}_k(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.61508em;vertical-align:0></span><span class="mord mathdefault">t</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Mac</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span> 时，输出 1。</li></ul></div></li><li><p>安全性</p><div class="note note-primary"><p>（CBC-MAC 的安全性）令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi></mrow><annotation encoding=application/x-tex>l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 是一个多项式。如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 是一个伪随机函数，那么上述构造方法就是一个长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>⋅</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>l(n)\cdot n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 消息的定长 MAC。该 MAC 是适应性选择消息攻击下安全的。</p></div></li></ul><h2 id=第五章杂凑函数><a class=markdownIt-Anchor href=#第五章杂凑函数></a> 第五章：杂凑函数</h2><h3 id=掌握杂凑函数的安全性包括preimage-resistance-second-preimage-resistance-collision-resistance-定义以及三者之间的关系><a class=markdownIt-Anchor href=#掌握杂凑函数的安全性包括preimage-resistance-second-preimage-resistance-collision-resistance-定义以及三者之间的关系></a> 掌握杂凑函数的安全性，包括Preimage Resistance、 Second preimage resistance、collision resistance 定义以及三者之间的关系</h3><ul><li><p>碰撞</p><div class="note note-info"><p>（碰撞发现实验）<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Hash-coll</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mtext> </mtext><mi>p</mi><mi>i</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Hash-coll}_{\mathcal{A},\ pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>Hash-coll</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mspace mtight"><span class=mtight> </span></span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 生成密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span>；</li><li>敌手输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 并输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>x&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>；</li><li>当且仅当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mi mathvariant=normal>≠</mi><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>x \neq x&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 且 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>H</mi><mi>s</mi></msup><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><msup><mi>H</mi><mi>s</mi></msup><mo stretchy=false>(</mo><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H^s(x) = H^s(x&#x27;)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 时，实验的输出被定义为 1.这种情况下，称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 发现了一个碰撞。</li></ol></div><div class="note note-primary"><p>（抗碰撞定义）对散列函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>Π</mi><mo>=</mo><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mi>H</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi=(\text{Gen}, H)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>Π</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mclose>)</span></span></span></span>，如果对于所有的概率多项式时间敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在着一个可忽略的函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span>，满足</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msub><mtext>Hash-coll</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mtext> </mtext><mi>p</mi><mi>i</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{Hash-coll}_{\mathcal{A},\ pi}(n) = 1]}|\leq negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>Hash-coll</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mspace mtight"><span class=mtight> </span></span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则该散列函数是抗碰撞的。</p></div></li><li><p>抗原像的非公式化定义</p><ul><li>抗原像：如果给定输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>H</mi><mi>s</mi></msup><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>y = H^s(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span>，对概率多项式时间的敌手来说，能够找到一个 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>x&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 使得 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>H</mi><mi>s</mi></msup><mo stretchy=false>(</mo><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo><mo>=</mo><mi>y</mi></mrow><annotation encoding=application/x-tex>H^s(x&#x27;) = y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span> 是不可行的，就称该散列函数的抗原像的。</li><li>抗第二原像：如果给定输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span>，对于概率多项式时间的敌手来说，找到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mi mathvariant=normal>≠</mi><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>x \neq x&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>H</mi><mi>s</mi></msup><mo stretchy=false>(</mo><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo><mo>=</mo><msup><mi>H</mi><mi>s</mi></msup><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H^s(x&#x27;) = H^s(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 是不可行的，就称该散列函数的抗第二原像的。</li></ul></li><li><p><strong>三者的关系</strong></p><ul><li>任何<code>抗碰撞</code>的散列函数都是<code>抗二次原像</code>的</li><li>任何<code>抗二次原像</code>的散列函数不一定是<code>抗原像</code>的。<ul><li>一个非常好的<code>抗二次原像</code>但是不<code>抗原像</code>的例子：<a target=_blank rel=noopener href=https://crypto.stackexchange.com/a/9690>Pre-image resistant but not 2nd pre-image resistant?——Reid 's Answer</a></li></ul></li></ul></li></ul><h3 id=掌握随机预言模型以及如何在rom下设计密码方案><a class=markdownIt-Anchor href=#掌握随机预言模型以及如何在rom下设计密码方案></a> 掌握随机预言模型以及如何在ROM下设计密码方案</h3><p>（完美的哈希函数）</p><ul><li>定义：随机预言机是一部预言机，对任何输入都回传一个真正均匀随机的输出，不过对相同的输入，该预言机每次都会用同一方法输出。</li><li>性质<ol><li>均匀分布：预言机的输出在取值空间内均匀分布，无碰撞</li><li>一致性：<strong>相同</strong>的输入必有<strong>相同</strong>的输出</li><li>可计算性：输入的计算可在多项式时间内完成</li></ol></li><li>设计密码方案<ul><li>利用随机语言模型构建<strong>伪随机函数</strong> <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover><mi>H</mi><mo stretchy=false>(</mo><mi>k</mi><mi mathvariant=normal>∥</mi><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>F_{k}(x) \stackrel{\text { def }}{=} H(k \| x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.402978em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class="mop op-limits"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.152978em><span style=top:-3em><span class=pstrut style=height:3em></span><span><span class=mop>=</span></span></span><span style=top:-3.5668699999999998em;margin-left:0><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mord>∥</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span></li></ul></li></ul><h2 id=第九章密码学难题><a class=markdownIt-Anchor href=#第九章密码学难题></a> 第九章：密码学难题</h2><ul><li>掌握DL、CDH、DDH难题/假设，及相互关系<ul><li><p>DL</p><ul><li>通俗理解：给定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>g</mi></mrow><annotation encoding=application/x-tex>\mathbb{G}, g</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.88333em;vertical-align:-.19444em></span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi><mo>=</mo><msup><mi>g</mi><mi>a</mi></msup></mrow><annotation encoding=application/x-tex>h = g^a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.858832em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span></span></span></span>，寻找 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span></span></span></span>。</li><li>公式化定义：</li></ul><div class="note note-info"><p>（离散对数实验） <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Dlog</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=script>G</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Dlog}_{\mathcal{A}, \mathcal{G}}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord><span class="mord text"><span class=mord>Dlog</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:.0593em>G</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>G</mi><mrow><mo fence=true>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>\mathcal{G}\left(1^{n}\right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathcal" style=margin-right:.0593em>G</span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span></span></span></span> 而得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\mathbb{G}, q, g)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mclose>)</span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>G</mi></mrow><annotation encoding=application/x-tex>\mathbb{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">G</span></span></span></span></span> 是一个阶为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 的循环群 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>∥</mi><mi>q</mi><mi mathvariant=normal>∥</mi><mo>=</mo><mi>n</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>g</mi></mrow><annotation encoding=application/x-tex>(\|q\|=n), g</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>∥</span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mord>∥</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span></span></span></span> 为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>G</mi></mrow><annotation encoding=application/x-tex>\mathbb{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">G</span></span></span></span></span> 的一个生 成元。</li><li>选择 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi><mo>←</mo><mi mathvariant=double-struck>G</mi></mrow><annotation encoding=application/x-tex>h \leftarrow \mathbb{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">G</span></span></span></span></span> (可以通过选择 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup><mo>←</mo><msub><mi mathvariant=double-struck>Z</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>x^{\prime} \leftarrow \mathbb{Z}_{q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.974998em;vertical-align:-.286108em></span><span class=mord><span class=mord><span class="mord mathbb">Z</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span>，并且设置 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi><mo>:</mo><mo>=</mo><msup><mi>g</mi><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup></msup></mrow><annotation encoding=application/x-tex>h:=g^{x^{\prime}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.13692em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> 来完成)。</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 给定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><mi>h</mi></mrow><annotation encoding=application/x-tex>\mathbb{G}, q, g, h</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">h</span></span></span></span>，输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>∈</mo><msub><mi mathvariant=double-struck>Z</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>x \in \mathbb{Z}_{q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.974998em;vertical-align:-.286108em></span><span class=mord><span class=mord><span class="mord mathbb">Z</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 。</li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>g</mi><mi>x</mi></msup><mo>=</mo><mi>h</mi></mrow><annotation encoding=application/x-tex>g^{x}=h</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.858832em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span></span></span></span>，定义实验输出为 1,其他情况下输出为 0。</li></ol></div><div class="note note-primary"><p>（离散对数问题定义）如果对于任意概率多项式算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在一个可忽略函数negl满足</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msub><mtext>DLog</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=script>G</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mo>≤</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pr{[\text{DLog}_{\mathcal{A}, \mathcal{G}}(n)=1]} \leq negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>DLog</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:.0593em>G</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则离散对数问题与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>G</mi></mrow><annotation encoding=application/x-tex>\mathcal{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal" style=margin-right:.0593em>G</span></span></span></span></span> 相关是困难的。</p></div></li><li><p>CDH</p><ul><li>通俗理解：给定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><msup><mi>g</mi><mi>a</mi></msup><mo separator=true>,</mo><msup><mi>g</mi><mi>b</mi></msup></mrow><annotation encoding=application/x-tex>\mathbb{G}, g,g^a,g^b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.043548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span></span></span></span></span></span></span></span>，寻找 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>g</mi><mrow><mi>a</mi><mi>b</mi></mrow></msup></mrow><annotation encoding=application/x-tex>g^{ab}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.043548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span></span></span></span></span></span></span></span>。</li><li>公式化定义：</li></ul><div class="note note-primary"><p>选定循环群 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>G</mi></mrow><annotation encoding=application/x-tex>\mathbb{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">G</span></span></span></span></span>，以及一个生成元 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi><mo>∈</mo><mi mathvariant=double-struck>G</mi></mrow><annotation encoding=application/x-tex>g \in \mathbb{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7335400000000001em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">G</span></span></span></span></span>。给定两个元素 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>h_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>h_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，定义 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>DH</mtext><mi>g</mi></msub><mo stretchy=false>(</mo><msub><mi>h</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>h</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover><msup><mi>g</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>g</mi></msub><msub><mi>h</mi><mn>1</mn></msub><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>g</mi></msub><msub><mi>h</mi><mn>2</mn></msub></mrow></msup></mrow><annotation encoding=application/x-tex>\text{DH}_g(h_1,h_2) \stackrel{\text { def }}{=} g^{\log_g{h_1}\cdot\log_g{h_2}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.439086em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>DH</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>g</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class="mop op-limits"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.152978em><span style=top:-3em><span class=pstrut style=height:3em></span><span><span class=mop>=</span></span></span><span style=top:-3.5668699999999998em;margin-left:0><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.071626em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8771859999999999em><span style=top:-3.0910780000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight">lo<span style=margin-right:.01389em>g</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.04167428571428572em><span style=top:-2.2341314285714287em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>g</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.40475428571428573em><span></span></span></span></span></span></span><span class="mspace mtight" style=margin-right:.19516666666666668em></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mop mtight"><span class="mop mtight">lo<span style=margin-right:.01389em>g</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.04167428571428572em><span style=top:-2.2341314285714287em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>g</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.40475428571428573em><span></span></span></span></span></span></span><span class="mspace mtight" style=margin-right:.19516666666666668em></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>。<br>即，当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup><mo separator=true>,</mo><msub><mi>h</mi><mn>2</mn></msub><mo>=</mo><msup><mi>g</mi><mi>y</mi></msup></mrow><annotation encoding=application/x-tex>h_1=g^x,h_2=g^y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.858832em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span></span></span> 时，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>DH</mtext><mi>g</mi></msub><mo stretchy=false>(</mo><msub><mi>h</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>h</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mover><mo><mo>=</mo></mo><mtext> def </mtext></mover><msup><mi>g</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>g</mi></msub><msub><mi>h</mi><mn>1</mn></msub><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>g</mi></msub><msub><mi>h</mi><mn>2</mn></msub></mrow></msup><mo>=</mo><msup><mi>g</mi><mrow><mi>x</mi><mi>y</mi></mrow></msup><mo>=</mo><msubsup><mi>h</mi><mn>1</mn><mi>y</mi></msubsup><mo>=</mo><msubsup><mi>h</mi><mn>2</mn><mi>x</mi></msubsup></mrow><annotation encoding=application/x-tex>\text{DH}_g(h_1,h_2) \stackrel{\text { def }}{=} g^{\log_g{h_1}\cdot\log_g{h_2}} = g^{xy} = h_1^y = h_2^x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.439086em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>DH</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>g</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class="mop op-limits"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.152978em><span style=top:-3em><span class=pstrut style=height:3em></span><span><span class=mop>=</span></span></span><span style=top:-3.5668699999999998em;margin-left:0><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight"> def </span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.071626em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8771859999999999em><span style=top:-3.0910780000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight">lo<span style=margin-right:.01389em>g</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.04167428571428572em><span style=top:-2.2341314285714287em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>g</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.40475428571428573em><span></span></span></span></span></span></span><span class="mspace mtight" style=margin-right:.19516666666666668em></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mop mtight"><span class="mop mtight">lo<span style=margin-right:.01389em>g</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.04167428571428572em><span style=top:-2.2341314285714287em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>g</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.40475428571428573em><span></span></span></span></span></span></span><span class="mspace mtight" style=margin-right:.19516666666666668em></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.858832em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.048608em;vertical-align:-.266308em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.7823em><span style=top:-2.433692em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style=top:-3.1809080000000005em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.266308em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.9425479999999999em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span>。<br>（计算 Diffie-Hellman 问题定义）当随机选定 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>h_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>h_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 时计算出 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>DH</mtext><mi>g</mi></msub><mo stretchy=false>(</mo><msub><mi>h</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>h</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{DH}_g(h_1,h_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>DH</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>g</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>。</p></div></li><li><p>DDH</p><ul><li>通俗理解：给定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><msup><mi>g</mi><mi>a</mi></msup><mo separator=true>,</mo><msup><mi>g</mi><mi>b</mi></msup></mrow><annotation encoding=application/x-tex>\mathbb{G}, g, g^{a}, g^{b}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.043548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span></span></span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>T</mi><mi>x</mi></msub></mrow><annotation encoding=application/x-tex>T_{x}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>。令 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>T_{0}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>G</mi></mrow><annotation encoding=application/x-tex>\mathbb{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">G</span></span></span></span></span> 中随机的一个元素, <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><msup><mi>g</mi><mrow><mi>a</mi><mi>b</mi></mrow></msup></mrow><annotation encoding=application/x-tex>T_{1}=g^{a b}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.043548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span></span></span></span></span></span></span></span>。同时 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 被随机均匀的从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span></span></span></span> 中选择，令敌手<strong>找出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span></strong>。</li><li>公式化定义：</li></ul><div class="note note-primary"><p>（决策性 Diffie-Hellman 问题定义）如果对任意概率多项式时间算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 存在一个可忽略函数negl, 满足</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi mathvariant=script>A</mi><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><msup><mi>g</mi><mi>x</mi></msup><mo separator=true>,</mo><msup><mi>g</mi><mi>y</mi></msup><mo separator=true>,</mo><msup><mi>g</mi><mi>z</mi></msup><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mo>−</mo><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><mi mathvariant=script>A</mi><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><msup><mi>g</mi><mi>x</mi></msup><mo separator=true>,</mo><msup><mi>g</mi><mi>y</mi></msup><mo separator=true>,</mo><msup><mi>g</mi><mrow><mi>x</mi><mi>y</mi></mrow></msup><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>⩽</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\mathcal{A}(\mathbb{G}, q, g, g^{x}, g^{y}, g^{z})=1]}-\Pr{[\mathcal{A}(\mathbb{G}, q, g, g^{x}, g^{y}, g^{x y})=1]}| \leqslant negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord mathcal">A</span></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714392em><span style=top:-3.1130000000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.04398em>z</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord mathcal">A</span></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714392em><span style=top:-3.1130000000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714392em><span style=top:-3.1130000000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mrel amsrm">⩽</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>DDH</mtext></mrow><annotation encoding=application/x-tex>\text{DDH}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>DDH</span></span></span></span></span> 与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>G</mi></mrow><annotation encoding=application/x-tex>\mathcal{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal" style=margin-right:.0593em>G</span></span></span></span></span> 相关是困难的。<br>概率来源于实验中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>G</mi><mrow><mo fence=true>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>\mathcal{G}\left(1^{n}\right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathcal" style=margin-right:.0593em>G</span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span></span></span></span> 的输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\mathbb{G}, q, g)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mclose>)</span></span></span></span>，以及随机选择的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo separator=true>,</mo><mi>z</mi><mo>∈</mo><msub><mi mathvariant=double-struck>Z</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>x, y, z \in \mathbb{Z}_{q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7335400000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.04398em>z</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.974998em;vertical-align:-.286108em></span><span class=mord><span class=mord><span class="mord mathbb">Z</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span>。</p></div></li><li><p>强度：<strong>DL&gt;CDH&gt;DDH</strong></p></li></ul></li></ul><h2 id=第十一章公钥加密><a class=markdownIt-Anchor href=#第十一章公钥加密></a> 第十一章：公钥加密</h2><h3 id=掌握pke安全定义-cpa安全和cca安全><a class=markdownIt-Anchor href=#掌握pke安全定义-cpa安全和cca安全></a> 掌握PKE安全定义、CPA安全和CCA安全</h3><ul><li><p>PKE 安全</p><div class="note note-info"><p>（窃听不可区分实验）<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PubK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PubK}^{eav}_{\mathcal{A},\Pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PubK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.748732em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1473400000000002em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 生成密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>p</mi><mi>k</mi><mo separator=true>,</mo><mi>s</mi><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(pk, sk)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>；</li><li>输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>pk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 给敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，输出一对<strong>长度相等</strong>的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>m_0,m_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；</li><li>从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span></span></span></span> 中<strong>随机</strong>选择一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>。然后，一个挑战密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>←</mo><msub><mtext>Enc</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c\leftarrow \text{Enc}_{pk}(m_b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 被计算出来并交给 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>；</li><li>敌手输出一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>b&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>；</li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>b&#x27;=b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>，定义实验输出为 1，否则为 0。</li></ol></div><div class="note note-primary"><p>（公钥体制的窃听不可区分定义）如果对于所有的 PPT 敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 使得：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msubsup><mtext>PubK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>e</mi><mi>a</mi><mi>v</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{PubK}^{eav}_{\mathcal{A},\Pi}(n)=1]}|\leq \frac{1}{2} + negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>PubK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.748732em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1473400000000002em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.00744em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.32144em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则称该公钥加密方案存在不可区分性。</p></div></li><li><p>CPA 安全</p><div class="note note-info"><p>（CPA 不可区分实验）<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PubK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>p</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PubK}^{cpa}_{\mathcal{A},\Pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.211939em;vertical-align:-.429639em></span><span class=mord><span class="mord text"><span class=mord>PubK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.7823em><span style=top:-2.4064690000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1809080000000005em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.429639em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 生成密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>p</mi><mi>k</mi><mo separator=true>,</mo><mi>s</mi><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(pk, sk)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>；</li><li>输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>pk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 给敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>可以访问预言机 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Enc</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Enc}_{pk}(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span></strong>，输出一对<strong>长度相等</strong>的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>m_0,m_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；</li><li>从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span></span></span></span> 中<strong>随机</strong>选择一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>。然后，一个挑战密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>←</mo><msub><mtext>Enc</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c\leftarrow \text{Enc}_{pk}(m_b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 被计算出来并交给 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>；</li><li>敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>继续访问预言机 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Enc</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Enc}_{pk}(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span></strong>，输出一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>b&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>；</li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>b&#x27;=b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>，定义实验输出为 1，否则为 0。</li></ol></div><div class="note note-primary"><p>（公钥体制选择明文攻击条件下的不可区分定义）如果对于所有的 PPT 敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 使得：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msubsup><mtext>PubK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>p</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{PubK}^{cpa}_{\mathcal{A},\Pi}(n)=1]}|\leq \frac{1}{2} + negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.211939em;vertical-align:-.429639em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>PubK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.7823em><span style=top:-2.4064690000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1809080000000005em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.429639em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.00744em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.32144em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则称该公钥加密方案存在不可区分性。</p></div></li><li><p>CCA 安全</p><div class="note note-info"><p>（CCA 不可区分实验）<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mtext>PubK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>c</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{PubK}^{cca}_{\mathcal{A},\Pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord><span class="mord text"><span class=mord>PubK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.748732em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1473400000000002em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 生成密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>p</mi><mi>k</mi><mo separator=true>,</mo><mi>s</mi><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(pk, sk)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>；</li><li>输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>pk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 给敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>可以访问预言机 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Dec</mtext><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Dec}(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Dec</span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span></strong>，输出一对<strong>长度相等</strong>的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>m_0,m_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；</li><li>从 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><annotation encoding=application/x-tex>\left\{0,1\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span></span></span></span> 中<strong>随机</strong>选择一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>。然后，一个挑战密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>←</mo><msub><mtext>Enc</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c\leftarrow \text{Enc}_{pk}(m_b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 被计算出来并交给 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>；</li><li>敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> <strong>继续访问解密预言机</strong>（但是不能问询挑战密文本身），输出一个比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>b&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>；</li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>b</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>b&#x27;=b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>，定义实验输出为 1，否则为 0。</li></ol></div><div class="note note-primary"><p>（公钥体制选择密文攻击条件下的不可区分定义）如果对于所有的 PPT 敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>，存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span> 使得：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msubsup><mtext>PubK</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow><mrow><mi>c</mi><mi>c</mi><mi>a</mi></mrow></msubsup><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{PubK}^{cca}_{\mathcal{A},\Pi}(n)=1]}|\leq \frac{1}{2} + negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.133108em;vertical-align:-.383108em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>PubK</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.748732em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span><span style=top:-3.1473400000000002em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.00744em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.32144em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则称该公钥加密方案存在不可区分性。</p></div></li></ul><h3 id=掌握单比特cpa安全和多比特cpa安全等价证明><a class=markdownIt-Anchor href=#掌握单比特cpa安全和多比特cpa安全等价证明></a> 掌握单比特CPA安全和多比特CPA安全等价<strong>证明</strong></h3><ul><li>证明较为<strong>复杂</strong>，可以参见《Introduction To Modern Cryptography》（Second Edition）P.382 的 <em>THEOREM 11.6</em> 的证明</li></ul><h3 id=理解hybrid-encryption的原理><a class=markdownIt-Anchor href=#理解hybrid-encryption的原理></a> 理解Hybrid Encryption的原理</h3><ul><li><p>公钥加密方案是 CPA 安全的，私钥加密方案是 EAV 安全的，那么混合加密方案是CPA 安全的公钥加密方案</p><div class="note note-warning"><p>（混合加密方案的构造方法）<br>令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>Π</mi><mo>=</mo><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Enc</mtext><mo separator=true>,</mo><mtext>Dec</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi=(\text{Gen}, \text{Enc}, \text{Dec})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>Π</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Enc</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Dec</span></span><span class=mclose>)</span></span></span></span> 为一个公钥加密方案, <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi mathvariant=normal>Π</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mo stretchy=false>(</mo><msup><mtext>Gen</mtext><mo mathvariant=normal>′</mo></msup><mo separator=true>,</mo><msup><mtext>Enc</mtext><mo mathvariant=normal>′</mo></msup><mo separator=true>,</mo><msup><mtext>Dec</mtext><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi^{\prime}=(\text{Gen}^{\prime}, \text{Enc}^{\prime}, \text{Dec}^{\prime})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.075122em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord text"><span class=mord>Gen</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.825122em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.825122em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord text"><span class=mord>Dec</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.825122em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 为一个对称密 钥加密方案, 构造一个公钥加密方案 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi mathvariant=normal>Π</mi><mtext>hy</mtext></msup><mo>=</mo><mo stretchy=false>(</mo><msup><mtext>Gen</mtext><mtext>hy</mtext></msup><mo separator=true>,</mo><msup><mtext>Enc</mtext><mtext>hy</mtext></msup><mo separator=true>,</mo><msup><mtext>Dec</mtext><mtext>hy</mtext></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi^{\text{hy}}=(\text{Gen}^{\text{hy}}, \text{Enc}^{\text{hy}}, \text{Dec}^{\text{hy}})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8491079999999999em;vertical-align:0></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hy</span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.1723379999999999em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord text"><span class=mord>Gen</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9223379999999999em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hy</span></span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9223379999999999em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hy</span></span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord text"><span class=mord>Dec</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9223379999999999em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hy</span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 如下:</p><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mtext>Gen</mtext><mtext>hy</mtext></msup></mrow><annotation encoding=application/x-tex>\text{Gen}^{\text{hy}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9223379999999999em;vertical-align:0></span><span class=mord><span class="mord text"><span class=mord>Gen</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9223379999999999em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hy</span></span></span></span></span></span></span></span></span></span></span></span></span>：输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 执行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>\text{Gen}1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，并输出公钥和私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>p</mi><mi>k</mi><mo separator=true>,</mo><mi>s</mi><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(pk, sk)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>。</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mtext>Enc</mtext><mtext>hy</mtext></msup></mrow><annotation encoding=application/x-tex>\text{Enc}^{\text{hy}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9223379999999999em;vertical-align:0></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9223379999999999em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hy</span></span></span></span></span></span></span></span></span></span></span></span></span>：输入公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>pk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 和消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>m \in \left\{0, 1\right\} ^ *</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.078596em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.828596em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>，执行以下操作<ol><li>随机选择 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>←</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k \leftarrow\{0,1\}^{n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>。</li><li>计算出 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>←</mo><msub><mtext>Enc</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c_{1} \leftarrow \text{Enc}_{p k}(k)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>←</mo><msubsup><mtext>Enc</mtext><mi>k</mi><mo mathvariant=normal>′</mo></msubsup><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c_{2} \leftarrow \text{Enc}_{k}^{\prime}(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.075122em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Enc</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.825122em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span>。</li><li>输出密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>(</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>c</mi><mn>2</mn></msub><mo fence=true>⟩</mo></mrow><annotation encoding=application/x-tex>\left(c_{1}, c_{2}\right\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>⟩</span></span></span></span></span>。</li></ol></li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><msup><mrow><mi>D</mi><mi>e</mi><mi>c</mi></mrow><mrow><mi mathvariant=normal>h</mi><mi mathvariant=normal>y</mi></mrow></msup></mrow><annotation encoding=application/x-tex>text{Dec}^{\mathrm{hy}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9223379999999999em;vertical-align:0></span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9223379999999999em><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">h</span><span class="mord mathrm mtight" style=margin-right:.01389em>y</span></span></span></span></span></span></span></span></span></span></span></span></span>：输入私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>sk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 和密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>⟨</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>c</mi><mn>2</mn></msub><mo fence=true>⟩</mo></mrow><annotation encoding=application/x-tex>\left\langle c_{1}, c_{2}\right\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>⟨</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>⟩</span></span></span></span></span>，执行以下操作<ol><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>:</mo><mo>=</mo><msub><mtext>Dec</mtext><mrow><mi>s</mi><mi>k</mi></mrow></msub><mrow><mo fence=true>(</mo><msub><mi>c</mi><mn>1</mn></msub><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>k:=\text{Dec}_{s k}\left(c_{1}\right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Dec</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span></span></span></span>。</li><li>输出消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>:</mo><mo>=</mo><msubsup><mtext>Dec</mtext><mi>k</mi><mo mathvariant=normal>′</mo></msubsup><mrow><mo fence=true>(</mo><msub><mi>c</mi><mn>2</mn></msub><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>m:=\text{Dec}_{k}^{\prime}\left(c_{2}\right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.075122em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Dec</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.825122em><span style=top:-2.4530000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span style=top:-3.1362300000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span></span></span></span></li></ol></li></ul></div></li></ul><h3 id=掌握el-gamal加密的原理和为何不是cca安全><a class=markdownIt-Anchor href=#掌握el-gamal加密的原理和为何不是cca安全></a> 掌握El Gamal加密的原理和<strong>为何不是CCA安全</strong></h3><ul><li><p>EI Gamal</p><div class="note note-warning"><p>（El Gamel 方案的构造方法）<br>定义如下的公钥加密方案:</p><ul><li>Gen: 输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^{n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>，执行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>G</mi><mrow><mo fence=true>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>\mathcal{G}\left(1^{n}\right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathcal" style=margin-right:.0593em>G</span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span></span></span></span> 来获得 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\mathbb{G}, q, g)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mclose>)</span></span></span></span>。然后选择随机的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>←</mo><msub><mi mathvariant=double-struck>Z</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>x \leftarrow \mathbb{Z}_{q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.974998em;vertical-align:-.286108em></span><span class=mord><span class=mord><span class="mord mathbb">Z</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 并且计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi><mo>:</mo><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup></mrow><annotation encoding=application/x-tex>h:=g^{x}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.858832em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>。公钥是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><mi>h</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\mathbb{G}, q, g, h)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">h</span><span class=mclose>)</span></span></span></span>，私钥是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\mathbb{G}, q, g, x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span>。</li><li>Enc: 输入公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mi>k</mi><mo>=</mo><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><mi>h</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>pk=(\mathbb{G}, q, g, h)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">h</span><span class=mclose>)</span></span></span></span> 和消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><mi mathvariant=double-struck>G</mi></mrow><annotation encoding=application/x-tex>m \in \mathbb{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">G</span></span></span></span></span>，选择随机的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>←</mo><msub><mi mathvariant=double-struck>Z</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>y \leftarrow \mathbb{Z}_{q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.974998em;vertical-align:-.286108em></span><span class=mord><span class=mord><span class="mord mathbb">Z</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span>，并且输出密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>⟨</mo><msup><mi>g</mi><mi>y</mi></msup><mo separator=true>,</mo><msup><mi>h</mi><mi>y</mi></msup><mo>⋅</mo><mi>m</mi><mo fence=true>⟩</mo></mrow><annotation encoding=application/x-tex>\left\langle g^{y}, h^{y} \cdot m\right\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>⟨</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">m</span><span class="mclose delimcenter" style=top:0>⟩</span></span></span></span></span>。</li><li>Dec: 输入私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi><mi>k</mi><mo>=</mo><mo stretchy=false>(</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>sk=(\mathbb{G}, q, g, x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 和密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mrow><mo fence=true>⟨</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>c</mi><mn>2</mn></msub><mo fence=true>⟩</mo></mrow><mo>=</mo><mrow><mo fence=true>⟨</mo><msup><mi>g</mi><mi>y</mi></msup><mo separator=true>,</mo><msup><mi>h</mi><mi>y</mi></msup><mo>⋅</mo><mi>m</mi><mo fence=true>⟩</mo></mrow></mrow><annotation encoding=application/x-tex>\left\langle c_{1}, c_{2}\right\rangle = \left\langle g^{y}, h^{y} \cdot m\right\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>⟨</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>⟩</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>⟨</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">m</span><span class="mclose delimcenter" style=top:0>⟩</span></span></span></span></span>，输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><msub><mi>c</mi><mn>2</mn></msub><mi mathvariant=normal>/</mi><msubsup><mi>c</mi><mn>1</mn><mi>x</mi></msubsup></mrow><annotation encoding=application/x-tex>m=c_{2} / c_{1}^{x}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord>/</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span>。</li></ul></div></li><li><p>安全性</p><div class="note note-secondary"><p>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>DDH</mtext></mrow><annotation encoding=application/x-tex>\text{DDH}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>DDH</span></span></span></span></span> 问题相对于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>G</mi></mrow><annotation encoding=application/x-tex>\mathcal{G}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal" style=margin-right:.0593em>G</span></span></span></span></span> 来说是困难的, 则 El Gamal 加密方案在选择明文攻击情况下有不可区分的加密。</p></div><ul><li>上述定理的证明需要使用<strong>规约</strong></li></ul></li><li><p>为何<strong>不是</strong> CCA 安全</p><ul><li>例如敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 拦截了使用公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mi>k</mi><mo>=</mo><mo stretchy=false>⟨</mo><mi mathvariant=double-struck>G</mi><mo separator=true>,</mo><mi>q</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><mi>h</mi><mo stretchy=false>⟩</mo></mrow><annotation encoding=application/x-tex>pk= \langle\mathbb{G}, q, g, h\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⟨</span><span class=mord><span class="mord mathbb">G</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">h</span><span class=mclose>⟩</span></span></span></span> 加密消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>=</mo><mrow><mo fence=true>⟨</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>c</mi><mn>2</mn></msub><mo fence=true>⟩</mo></mrow><mo>=</mo><mo>=</mo><mrow><mo fence=true>⟨</mo><msup><mi>g</mi><mi>y</mi></msup><mo separator=true>,</mo><msup><mi>h</mi><mi>y</mi></msup><mo>⋅</mo><mi>m</mi><mo fence=true>⟩</mo></mrow></mrow><annotation encoding=application/x-tex>c=\left\langle c_{1}, c_{2}\right\rangle = = \left\langle g^{y}, h^{y} \cdot m\right\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>⟨</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>⟩</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>⟨</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">m</span><span class="mclose delimcenter" style=top:0>⟩</span></span></span></span></span>。如果敌手计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>c</mi><mn>2</mn><mo mathvariant=normal>′</mo></msubsup><mo>:</mo><mo>=</mo><msub><mi>c</mi><mn>2</mn></msub><mo>⋅</mo><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>c_2&#x27;:=c_2\cdot m&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.59445em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，则很容易找到密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>c</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mrow><mo fence=true>⟨</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator=true>,</mo><msubsup><mi>c</mi><mn>2</mn><mo mathvariant=normal>′</mo></msubsup><mo fence=true>⟩</mo></mrow></mrow><annotation encoding=application/x-tex>c^{\prime}=\left\langle c_{1}, c_{2}^{\prime}\right\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>⟨</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>⟩</span></span></span></span></span> 是消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>⋅</mo><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>m \cdot m^{\prime}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.44445em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的密文。这导致了选择密文攻击的可能。</li><li>教科书式的 RSA <strong>同样不是</strong> CCA 安全</li></ul></li></ul><h2 id=第十二章电子签名><a class=markdownIt-Anchor href=#第十二章电子签名></a> 第十二章：电子签名</h2><h3 id=掌握签名安全定义><a class=markdownIt-Anchor href=#掌握签名安全定义></a> 掌握签名安全定义</h3><ul><li><p>数字签名</p><div class="note note-primary"><p>（数字签名定义）一个数字签名方案是由 PPT 算法组成的三元组 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext> </mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi></mrow><mo separator=true>,</mo><mtext>Vrfy</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\text{Gen},\ text{Sign},\text{Vrfy})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace> </span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">n</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Vrfy</span></span><span class=mclose>)</span></span></span></span>，满足下列条件：</p><ol><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext></mrow><annotation encoding=application/x-tex>\text{Gen}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span></span></span></span>：以 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 作为输入，输出一对密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>p</mi><mi>k</mi><mo separator=true>,</mo><mi>s</mi><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(pk, sk)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>，分别称为公钥和私钥。</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Sign</mtext></mrow><annotation encoding=application/x-tex>\text{Sign}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Sign</span></span></span></span></span>：以私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>sk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 和消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>m \in \left\{0, 1\right\}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.078596em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.828596em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 作为输入。输出一个签名 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>σ</mi><mo>←</mo><msub><mtext>Sign</mtext><mrow><mi>s</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\sigma \leftarrow \text{Sign}_{sk}(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>←</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord text"><span class=mord>Sign</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.24196799999999993em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24414em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span>。</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Vrfy</mtext></mrow><annotation encoding=application/x-tex>\text{Vrfy}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Vrfy</span></span></span></span></span>：以一个公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>pk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>、消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 和一个签名 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding=application/x-tex>\sigma</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span></span></span></span> 作为输入，输出一位 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi><mo>:</mo><mo>=</mo><msub><mtext>Vrfy</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>σ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>b:=\text{Vrfy}_{pk}(m, \sigma)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord><span class="mord text"><span class=mord>Vrfy</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2419679999999999em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=mclose>)</span></span></span></span>。当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>b = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 时表示签名有效。</li></ol><ul><li>该方案需要对任意 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>，对于所有由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 输出的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>p</mi><mi>k</mi><mo separator=true>,</mo><mi>s</mi><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(pk, sk)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>，以及任意 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>m\in \left\{0, 1\right\}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.078596em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.828596em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>，必须满足</li></ul><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Vrfy</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><msub><mtext>Sign</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\text{Vrfy}_{pk}(m,\text{Sign}_{pk}(m))=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord><span class="mord text"><span class=mord>Vrfy</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2419679999999999em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord text"><span class=mord>Sign</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2419679999999999em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></span></p></div></li><li><p>数字签名安全</p><div class="note note-info"><p>（数字签名实验） <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Sig-forge</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Sig-forge}_{\mathcal{A},\Pi}(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord><span class="mord text"><span class=mord>Sig-forge</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>：</p><ol><li>运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Gen}(1^n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Gen</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 得到密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>p</mi><mi>k</mi><mo separator=true>,</mo><mi>s</mi><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(pk, sk)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>。</li><li>将 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>pk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 和访问 <strong>“签名预言机”</strong> <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Sign</mtext><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{Sign}(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>Sign</span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span> 的权利给敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span>。然后敌手输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>σ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(m, \sigma)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=mclose>)</span></span></span></span>。设 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>Q</mi></mrow><annotation encoding=application/x-tex>\mathcal{Q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal">Q</span></span></span></span></span> 表示为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 在执行期间问询签名的消息的集合。</li><li>当且仅当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mtext>Vrfy</mtext><mrow><mi>p</mi><mi>k</mi></mrow></msub><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>σ</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\text{Vrfy}_{pk}(m, \sigma) = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord><span class="mord text"><span class=mord>Vrfy</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2419679999999999em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 且 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mi mathvariant=normal>≠</mi><mi mathvariant=script>Q</mi></mrow><annotation encoding=application/x-tex>m\neq \mathcal{Q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.78055em;vertical-align:-.09722em></span><span class=mord><span class="mord mathcal">Q</span></span></span></span></span> 时，实验输出定义为 1。</li></ol></div><div class="note note-primary"><p>（数字签名安全性）一个签名方案 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>Π</mi><mo>=</mo><mo stretchy=false>(</mo><mtext>Gen</mtext><mo separator=true>,</mo><mtext>Mac</mtext><mo separator=true>,</mo><mtext>Vrfy</mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi = (\text{Gen},\text{Mac},\text{Vrfy})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>Π</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord text"><span class=mord>Gen</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Mac</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord text"><span class=mord>Vrfy</span></span><span class=mclose>)</span></span></span></span>，如果对所有多项式时间敌手 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathcal">A</span></span></span></span></span> 存在一个可忽略函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi></mrow><annotation encoding=application/x-tex>negl</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span></span></span></span>， 满足</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mrow><mo stretchy=false>[</mo><msub><mtext>Sig-forge</mtext><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi mathvariant=normal>Π</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><mi mathvariant=normal>∣</mi><mo>≤</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>l</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>|\Pr{[\text{Sig-forge}_{\mathcal{A},\Pi}(n) = 1]}|\leq negl(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.130248em;vertical-align:-.380248em></span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mop>Pr</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mopen>[</span><span class=mord><span class="mord text"><span class=mord>Sig-forge</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.23419099999999998em><span style=top:-2.4558600000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span></span><span class="mpunct mtight">,</span><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.380248em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>]</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p><p>则该签名方案是适应性选择消息攻击下安全的。</p></div></li></ul><h3 id=掌握rsa-fdh原理及安全性证明要掌握归约主要步骤和概率计算><a class=markdownIt-Anchor href=#掌握rsa-fdh原理及安全性证明要掌握归约主要步骤和概率计算></a> 掌握RSA-FDH原理及安全性证明，<strong>要掌握归约主要步骤和概率计算</strong></h3><ul><li>RSA-FDH 方案<div class="note note-warning"><p>（构造方法）令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 是函数，其定义域为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>\left\{0, 1\right\}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.078596em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.828596em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>，值域为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi mathvariant=double-struck>Z</mi><mi>N</mi><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>\mathbb{Z}_N^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.964221em;vertical-align:-.275331em></span><span class=mord><span class=mord><span class="mord mathbb">Z</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.424669em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.10903em>N</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.275331em><span></span></span></span></span></span></span></span></span></span>。构造一个签名方案：</p><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Gen</mtext></mrow><annotation encoding=application/x-tex>\text{Gen}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class=mord>Gen</span></span></span></span></span>：输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>1</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>1^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，运行 <span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>GenRSA</mtext><mo stretchy=false>(</mo><msup><mn>1</mn><mi>n</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\text{GenRSA}(1 ^ n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord text"><span class=mord>GenRSA</span></span><span class=mopen>(</span><span class=mord><span class=mord>1</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 来计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>N</mi><mo separator=true>,</mo><mi>e</mi><mo separator=true>,</mo><mi>d</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(N,e,d)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">d</span><span class=mclose>)</span></span></span></span>，令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 的值域为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi mathvariant=double-struck>Z</mi><mi>N</mi><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>\mathbb{Z}_N^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.964221em;vertical-align:-.275331em></span><span class=mord><span class=mord><span class="mord mathbb">Z</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.424669em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.10903em>N</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.275331em><span></span></span></span></span></span></span></span></span></span>。公钥为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>⟨</mo><mi>N</mi><mo separator=true>,</mo><mi>e</mi><mo stretchy=false>⟩</mo></mrow><annotation encoding=application/x-tex>\langle N, e\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⟨</span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mclose>⟩</span></span></span></span>，私钥为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>⟨</mo><mi>N</mi><mo separator=true>,</mo><mi>d</mi><mo stretchy=false>⟩</mo></mrow><annotation encoding=application/x-tex>\langle N, d\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⟨</span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">d</span><span class=mclose>⟩</span></span></span></span>。</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Sign</mtext></mrow><annotation encoding=application/x-tex>\text{Sign}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Sign</span></span></span></span></span>：输入一个私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>⟨</mo><mi>N</mi><mo separator=true>,</mo><mi>d</mi><mo stretchy=false>⟩</mo></mrow><annotation encoding=application/x-tex>\langle N, d\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⟨</span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">d</span><span class=mclose>⟩</span></span></span></span> 以及一个消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><msup><mrow><mo fence=true>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo fence=true>}</mo></mrow><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>m\in \left\{0,1\right\}^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.054292em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class="mclose delimcenter" style=top:0>}</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>σ</mi><mo>:</mo><mo>=</mo><mo stretchy=false>[</mo><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><msup><mo stretchy=false>)</mo><mi>d</mi></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>N</mi><mo stretchy=false>)</mo><mo stretchy=false>]</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>\sigma:=[H(m)^d\pmod N]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class=mopen>[</span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mclose>)</span><span class=mclose>]</span></span></span></span>。</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mtext>Vrfy</mtext></mrow><annotation encoding=application/x-tex>\text{Vrfy}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord text"><span class=mord>Vrfy</span></span></span></span></span>：输入一个公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>⟨</mo><mi>N</mi><mo separator=true>,</mo><mi>e</mi><mo stretchy=false>⟩</mo></mrow><annotation encoding=application/x-tex>\langle N, e\rangle</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⟨</span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mclose>⟩</span></span></span></span>，以及一个消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 和一个签名 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding=application/x-tex>\sigma</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span></span></span></span>。当且仅当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>σ</mi><mi>e</mi></msup><mover><mo><mo>=</mo></mo><mo stretchy=false>?</mo></mover><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>N</mi></mrow><annotation encoding=application/x-tex>\sigma^{e} \stackrel{?}{=} H(m) \bmod N</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.152978em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class="mop op-limits"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.152978em><span style=top:-3em><span class=pstrut style=height:3em></span><span><span class=mop>=</span></span></span><span style=top:-3.5668699999999998em;margin-left:0><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>N</span></span></span></span> 时， 输出 1。</li></ul></div></li><li>安全性<div class="note note-primary"><p>如果 RSA 与 GenRSA 相关是困难的，并且 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 为随机预言机，那么么 RSA-FDH 的构造方案是适应性选择消息攻击下存在不可伪造的。</p></div></li></ul></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class=category-chains><span class=category-chain><a href=/categories/%E5%A4%87%E5%BF%98/ class=category-chain-item>备忘</a></span></span></div><div class=post-meta><i class="iconfont icon-tags"></i> <a href=/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/ class=print-no-link>#密码学</a></div></div><div class="license-box my-3"><div class=license-title><div>可证明安全复习</div><div>https://justloseit.top/可证明安全复习/</div></div><div class=license-meta><div class=license-meta-item><div>作者</div><div>Mobilis In Mobili</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2021年10月3日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2023年3月3日</div></div><div class=license-meta-item><div>许可协议</div><div><a class=print-no-link target=_blank href=https://creativecommons.org/licenses/by/4.0/ ><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href=/%E7%AE%97%E6%B3%95%E5%A4%87%E5%BF%98%E5%BD%95%C2%B7%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/ title=算法备忘录·数学知识><i class="iconfont icon-arrowleft"></i> <span class=hidden-mobile>算法备忘录·数学知识</span> <span class=visible-mobile>上一篇</span></a></article><article class="post-next col-6"><a href=/%E5%AF%86%E7%A0%81%E5%AD%A6%E6%95%B0%E8%AE%BA%E5%9F%BA%E7%A1%80/ title=密码学数论基础><span class=hidden-mobile>密码学数论基础</span> <span class=visible-mobile>下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id=comments><div id=valine></div><script type=text/javascript>Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",function(){var i=Object.assign({appId:"t4w421aIGl2GXkT0tSGoap5I-gzGzoHsz",appKey:"BpNeeVt0v3tKAbF1L6RTf94X",path:"window.location.pathname",placeholder:"说点什么",avatar:"hide",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!1,serverURLs:"https://t4w421ai.lc-cn-n1-shared.com",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class=sidebar style=margin-left:-1rem><div id=toc><p class=toc-header><i class="iconfont icon-list"></i> <span>目录</span></p><div class=toc-body id=toc-body></div></div></aside></div></div></div><a id=scroll-top-button aria-label=TOP href=# role=button><i class="iconfont icon-arrowup" aria-hidden=true></i></a><div class="modal fade" id=modalSearch tabindex=-1 role=dialog aria-labelledby=ModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-lg" role=document><div class=modal-content><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type=button id=local-search-close class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type=text id=local-search-input class="form-control validate"> <label data-error=x data-success=v for=local-search-input>关键词</label></div><div class=list-group id=local-search-result></div></div></div></div></div></main><footer><div class=footer-inner><div class=footer-content><a href=https://hexo.io target=_blank rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href=https://github.com/fluid-dev/hexo-theme-fluid target=_blank rel="nofollow noopener"><span>Fluid</span></a></div><div class=statistics><span id=leancloud-site-pv-container style=display:none>总访问量 <span id=leancloud-site-pv></span> 次 </span><span id=leancloud-site-uv-container style=display:none>总访客数 <span id=leancloud-site-uv></span> 人</span></div><div class=beian><span><a href=http://beian.miit.gov.cn/ target=_blank rel="nofollow noopener"><a target=_blank rel=noopener href=https://beian.miit.gov.cn>京ICP备2021006744号-1</a> </a></span><span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802034644" rel="nofollow noopener" class=beian-police target=_blank><span style=visibility:hidden;width:0>|</span> <img src=/img/police_beian.png alt=police-icon> <span>京公网安备 11010802034644号</span></a></span></div></div></footer><script src=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js></script><link rel=stylesheet href=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src=https://lib.baomitu.com/jquery/3.6.4/jquery.min.js></script><script src=https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js></script><script src=/js/events.js></script><script src=/js/plugins.js></script><script src=https://lib.baomitu.com/typed.js/2.0.12/typed.min.js></script><script>(t=>{var e=Fluid.plugins.typing;(t=t.getElementById("subtitle"))&&e&&e(t.getAttribute("data-typed-text"))})((window,document))</script><script src=/js/img-lazyload.js></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script defer=defer src=/js/leancloud.js></script><script src=/js/local-search.js></script><script src=/js/boot.js></script><noscript><div class=noscript-warning>博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>