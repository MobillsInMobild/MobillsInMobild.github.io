<!DOCTYPE html><html lang=zh-CN data-default-color-scheme=auto><head><meta charset=UTF-8><link rel=apple-touch-icon sizes=76x76 href=/img/favicon/favicon.png><link rel=icon href=/img/favicon/favicon.png><link rel=canonical href=https://justloseit.top/密码学备忘/ ><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content=#2f4154><meta name=author content="Mobilis In Mobili"><meta name=keywords content=""><meta name=description content="自己在学习密码学课程时做的总结，AES 那一部分写得比较简略"><meta property=og:type content=article><meta property=og:title content=密码学备忘><meta property=og:url content=https://justloseit.top/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%87%E5%BF%98/index.html><meta property=og:site_name content=动中之动><meta property=og:description content="自己在学习密码学课程时做的总结，AES 那一部分写得比较简略"><meta property=og:locale content=zh_CN><meta property=og:image content=https://justloseit.top/img/index/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%87%E5%BF%98.png><meta property=article:published_time content=2020-10-28T07:46:25.000Z><meta property=article:modified_time content=2023-03-03T06:49:24.758Z><meta property=article:author content="Mobilis In Mobili"><meta property=article:tag content=密码学><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=https://justloseit.top/img/index/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%87%E5%BF%98.png><title>密码学备忘 - 动中之动</title><link rel=stylesheet href=https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css><link rel=stylesheet href=https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css><link rel=stylesheet href=https://lib.baomitu.com/hint.css/2.7.0/hint.min.css><link rel=stylesheet href=https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css><link rel=stylesheet href=https://lib.baomitu.com/KaTeX/0.16.2/katex.min.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css><link rel=stylesheet href=/css/main.css><link id=highlight-css rel=stylesheet href=/css/highlight.css><link id=highlight-css-dark rel=stylesheet href=/css/highlight-dark.css><script id=fluid-configs>var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"justloseit.top",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:60,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:"§"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:"snI2XNrHrhyx5g84m3Uim3EC-gzGzoHsz",app_key:"x2YseXJIHmvnsM4v9y9UAlvu",server_url:"https://sni2xnrh.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src=/js/utils.js></script><script src=/js/color-schema.js></script><meta name=generator content="Hexo 5.4.2"><link rel=alternate href=/atom.xml title=动中之动 type=application/atom+xml></head><body><header><div class=header-inner style=height:70vh><nav id=navbar class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=/ ><strong>Mobilis In Mobili</strong> </a><button id=navbar-toggler-btn class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"><div class=animated-icon><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto text-center"><li class=nav-item><a class=nav-link href=/ target=_self><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class=nav-item><a class=nav-link href=/archives/ target=_self><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class=nav-item><a class=nav-link href=/categories/ target=_self><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class=nav-item><a class=nav-link href=/tags/ target=_self><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class=nav-item><a class=nav-link href=/about/ target=_self><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class=nav-item><a class=nav-link href=/links/ target=_self><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class=nav-item id=search-btn><a class=nav-link target=_self href=javascript:; data-toggle=modal data-target=#modalSearch aria-label=Search><i class="iconfont icon-search"></i></a></li><li class=nav-item id=color-toggle-btn><a class=nav-link target=_self href=javascript:; aria-label="Color Toggle"><i class="iconfont icon-dark" id=color-toggle-icon></i></a></li></ul></div></div></nav><div id=banner class=banner parallax=true style="background:url(/img/banner/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%87%E5%BF%98.png) no-repeat center center;background-size:cover"><div class=full-bg-img><div class="mask flex-center" style=background-color:rgba(0,0,0,.3)><div class="banner-text text-center fade-in-up"><div class=h2><span id=subtitle data-typed-text=密码学备忘></span></div><div class=mt-3><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden=true></i> Mobilis In Mobili </span><span class=post-meta><i class="iconfont icon-date-fill" aria-hidden=true></i> <time datetime="2020-10-28 15:46" pubdate>2020年10月28日 下午</time></span></div><div class=mt-1><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 28k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 235 分钟 </span><span id=leancloud-page-views-container class=post-meta style=display:none><i class="iconfont icon-eye" aria-hidden=true></i> <span id=leancloud-page-views></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id=board-ctn><div id=board><article class="post-content mx-auto"><h1 id=seo-header>密码学备忘</h1><p id=updated-time class="note note-info">本文最后更新于 2023年3月3日 下午</p><div class=markdown-body><p>自己在学习密码学课程时做的总结，AES 那一部分写得比较简略</p><span id=more></span><h1 id=密码学备忘><a class=markdownIt-Anchor href=#密码学备忘></a> 密码学备忘</h1><h2 id=引言><a class=markdownIt-Anchor href=#引言></a> 引言</h2><ul><li><p>密码学的意义</p></li><li><p>密码学基础</p><ul><li>对称密码</li><li>公钥密码</li><li>数据完整性算法</li><li>相互信任</li></ul></li></ul><h3 id=安全概述><a class=markdownIt-Anchor href=#安全概述></a> 安全概述</h3><ul><li><p>CIA三元组</p><ul><li><p>保密性（数据保密性、隐私性）</p></li><li><p>完整性（数据完整性、系统完整性）</p></li><li><p>可用性</p><p>※：真实性、可追溯性</p></li></ul></li><li><p>安全攻击</p><ul><li>安全威胁：<ul><li>自然威胁</li><li>人为威胁<ul><li>主动攻击： 拒绝服务、消息修改、伪装、重放</li><li>被动攻击（窃听）：信息内容的泄露，流量分析</li></ul></li></ul></li></ul></li><li><p>安全服务：（OSI安全体系结构）安全服务通过安全机制来实现安全策略</p><ol><li>数据保密性：防止被动攻击</li><li>认证：保证通信的真实性</li><li>数据完整性：功能与保护对象有关<br>※：满足完整性业务，不一定同时满足认证性，因为敌手可以假冒合法用户发送满足完整性的数据包</li><li>不可否认性</li><li>访问控制</li></ol></li><li><p>基本安全设计准则</p></li><li><p>攻击面和攻击树</p><ul><li>攻击面：网络由系统中一系列可访问且可利用的漏洞组成，包括网络攻击面、软件攻击面、人类攻击面</li><li>攻击树：采用分支化、层次化表示来利用安全漏洞的可能技术集合的数据结构<ul><li>根节点：攻击的目的</li><li>叶节点：发起攻击的不同方式</li><li>与节点： 该节点的所有子节点代表的字母表都必须优先完成</li><li>或节点： 需要至少完成应该子目标</li></ul></li></ul></li></ul><h3 id=网络安全模型><a class=markdownIt-Anchor href=#网络安全模型></a> 网络安全模型</h3><ul><li>信息流安全基本模型：<ul><li>消息的安全变换（基本成分）: 包括对消息的加密和认证</li><li>通信双方共享的秘密信息（基本成分）</li><li>一个可行的第三方（可选成分）：分发密钥建立安全通道、仲裁</li></ul></li><li>安全网络通信需要考虑的4个要素：<ul><li>加密、认证算法</li><li>用于算法的秘密信息：密钥、秘密参数等</li><li>秘密信息的分发与共享</li><li>使用加密、认证算法和密钥以获得安全服务所需的协议（安全协议）</li></ul></li><li>防止未授权访问的模型：守卫者和内部控制部件构成两道防线</li><li>信息安全的三个层次：系统安全、数据安全（密码技术）、内容安全（不良内容过滤）</li></ul><h2 id=传统加密技术><a class=markdownIt-Anchor href=#传统加密技术></a> 传统加密技术</h2><ul><li>密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span>（密钥空间即 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span> 的可能值范围）——加解密密钥不一定相同<ul><li>明文：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span></li><li>密文：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span></li><li>加密函数：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>K</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo>=</mo><mi>C</mi></mrow><annotation encoding=application/x-tex>E_{K}(m)=C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span></li><li>解密函数：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>D</mi><mi>K</mi></msub><mo stretchy=false>(</mo><msub><mi>E</mi><mi>K</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mi>m</mi></mrow><annotation encoding=application/x-tex>D_{K}(E_{K}(m))=m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span></li></ul></li></ul><h3 id=对称密码模型><a class=markdownIt-Anchor href=#对称密码模型></a> 对称密码模型</h3><p>（传统密码/常规密码/私钥密码/单钥密码/conventional/private-key/single-key）</p><ul><li>发送方和接收方共享同一个密钥</li><li>基本成分：明文(plaintext)、加密算法(encryption)、密钥(key)、密文(cipher)、解密算法(decryption)</li><li>保证安全的两个条件：加密算法足够强、保证密钥安全</li><li>Kerckhoff原则：系统的保密性不依赖于对加密体制或算法的保密，而依赖于对密钥的保密（这也降低了保密成本）</li></ul><h3 id=密码编码学cryptography><a class=markdownIt-Anchor href=#密码编码学cryptography></a> 密码编码学(cryptography)</h3><ul><li>特征：<ul><li>转换明文为密文的运算类型（不允许信息丢失，即运算均可逆）：代替（映射）/置换 （重新排列）</li><li>所用的密钥数：单密钥密码（基于计算安全性，运行速度快，但是不便于密钥管理）/双密钥密码（基于可证明安全性，便于密钥的管理，还可用于消息认证，但是运行速度慢）</li><li>处理明文的方法<ul><li>分组(块)密码：按组处理，l每次处理一组元素。适合数据库加密，组内有错误扩散；一般用于公开的理论研究。</li><li>序列(流)密码：连续处理输入元素，每次输出一个元素。加解密速度快，无错误扩散；一般用于实际的安全产品</li></ul></li></ul></li></ul><h3 id=密码分析学cryptanalytics><a class=markdownIt-Anchor href=#密码分析学cryptanalytics></a> 密码分析学(cryptanalytics)</h3><ul><li>典型目标：得到<strong>密钥</strong>，而不是仅仅得到单个密文对应的明文</li></ul><h4 id=攻击传统密码体制的一般方法><a class=markdownIt-Anchor href=#攻击传统密码体制的一般方法></a> 攻击传统密码体制的一般方法</h4><ul><li><p>穷举攻击：对一条密文尝试所有可能的密钥，知道把它转化为可读的有意义的明文。平均而言，成功至少需要尝试所有可能密钥的一半。</p></li><li><p>密码分析：利用算法的性质和明文的特征或某些明密文对</p></li></ul><table cellspacing=0 border=0><colgroup width=140></colgroup><colgroup width=378></colgroup><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=18 align=center valign=middle><font face="DejaVu Sans Mono" color=#000000>&#25915;&#20987;&#31867;&#22411;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#25915;&#20987;&#32773;&#24050;&#30693;&#30340;&#19996;&#35199;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=37 align=center valign=middle><font face="DejaVu Sans Mono" color=#000000>&#21807;&#23494;&#25991;&#25915;&#20987;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#21152;&#23494;&#31639;&#27861;<br>&#24453;&#30772;&#35793;&#30340;&#23494;&#25991;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=74 align=center valign=middle><font face="DejaVu Sans Mono" color=#000000>&#24050;&#30693;&#26126;&#25991;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#21152;&#23494;&#31639;&#27861;<br>&#24453;&#30772;&#35793;&#30340;&#23494;&#25991;<br>&#30001;&#23494;&#38053;&#24418;&#25104;&#30340;&#19968;&#20010;&#25110;&#22810;&#20010;&#26126;&#25991;-&#23494;&#25991;&#23545;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=92 align=center valign=middle><font face="DejaVu Sans Mono" color=#000000>&#36873;&#25321;&#26126;&#25991;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#21152;&#23494;&#31639;&#27861;<br>&#24453;&#30772;&#35793;&#30340;&#23494;&#25991;<br>&#30001;&#30772;&#35793;&#32773;&#36873;&#25321;&#30340;&#26126;&#25991;&#20449;&#24687;&#65292;&#36830;&#21516;&#23545;&#24212;&#30340;&#30001;&#23494;&#38053;&#29983;&#25104;&#30340;&#23494;&#25991;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" rowspan=3 height=258 align=center valign=middle><font face="DejaVu Sans Mono" color=#000000>&#36873;&#25321;&#23494;&#25991;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#21152;&#23494;&#31639;&#27861;<br>&#24453;&#30772;&#35793;&#30340;&#23494;&#25991;<br>&#30001;&#30772;&#35793;&#32773;&#36873;&#25321;&#30340;&#29468;&#27979;&#24615;&#23494;&#25991;&#65292;&#36830;&#21516;&#23545;&#24212;&#30340;&#30001;&#23494;&#38053;&#29983;&#25104;&#30340;&#24050;&#30772;&#35793;&#26126;&#25991;<br></font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>CCA-1&#25915;&#20987;&#65288;&#21320;&#39184;&#25915;&#20987;&#65289;&#65306;&#26377;&#38480;&#30340;&#35299;&#23494;&#26426;&#65288;&#24471;&#21040;&#30446;&#26631;&#23494;&#25991;&#20043;&#21518;&#19981;&#33021;&#20877;&#20351;&#29992;&#65289;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>CCA-2&#25915;&#20987;&#65288;&#20940;&#26216;&#25915;&#20987;&#65289;&#65306;&#26080;&#38480;&#30340;&#35299;&#23494;&#26426;&#65288;&#24471;&#21040;&#30446;&#26631;&#23494;&#25991;&#20043;&#21518;&#33021;&#32487;&#32493;&#20351;&#29992;&#65289;</font></td></tr><tr><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" height=166 align=center valign=middle><font face="DejaVu Sans Mono" color=#000000>&#36873;&#25321;&#25991;&#26412;</font></td><td style="border-top:1px solid #000;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000" align=left valign=middle><font face="DejaVu Sans Mono" color=#000000>&#21152;&#23494;&#31639;&#27861;<br>&#24453;&#30772;&#35793;&#30340;&#23494;&#25991;<br>&#30001;&#30772;&#35793;&#32773;&#36873;&#25321;&#30340;&#26126;&#25991;&#20449;&#24687;&#65292;&#36830;&#21516;&#23545;&#24212;&#30340;&#30001;&#23494;&#38053;&#29983;&#25104;&#30340;&#23494;&#25991;<br>&#30001;&#30772;&#35793;&#32773;&#36873;&#25321;&#30340;&#29468;&#27979;&#24615;&#23494;&#25991;&#65292;&#36830;&#21516;&#23545;&#24212;&#30340;&#30001;&#23494;&#38053;&#29983;&#25104;&#30340;&#24050;&#30772;&#35793;&#26126;&#25991;<br></font></td></tr></table><ul><li><p>加密算法要经得住已知明文攻击</p></li><li><p>分析依据<br>对称密码：明文的结构和模式在加密之后仍然保存了下来，能在密文中找到一些蛛丝马迹<br>公钥密码：密钥对的数学性质</p></li></ul><hr><ul><li>无条件安全：如果算法产生的密文不能给出惟一决定相应明文的足够信息。此时无论敌手截获多少密文、花费多少时间，都不能解密密文<ul><li>Shannon指出，仅当密钥至少和明文一样长时，才能达到无条件安全。（一次一密）</li><li>计算上安全：破译密文的代价超过被加密信息的价值或破译密文所花的时间超过信息的有用期</li></ul></li></ul><h3 id=代替技术><a class=markdownIt-Anchor href=#代替技术></a> 代替技术</h3><ul><li>代替法：将明文字母替换成其他字母、数字、符号的方法</li></ul><h4 id=恺撒密码-caesar-cipher><a class=markdownIt-Anchor href=#恺撒密码-caesar-cipher></a> 恺撒密码 Caesar Cipher</h4><p>加密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>=</mo><mi>E</mi><mo stretchy=false>(</mo><mi>p</mi><mo separator=true>,</mo><mi>k</mi><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><mi>p</mi><mo>+</mo><mi>k</mi><mo stretchy=false>)</mo><mi>m</mi><mi>o</mi><mi>d</mi><mn>26</mn></mrow><annotation encoding=application/x-tex>C=E(p,k)=(p+k)mod26</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class=mord>2</span><span class=mord>6</span></span></span></span></p><p>解密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>=</mo><mi>D</mi><mo stretchy=false>(</mo><mi>C</mi><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><mi>C</mi><mo>−</mo><mi>k</mi><mo stretchy=false>)</mo><mi>m</mi><mi>o</mi><mi>d</mi><mn>26</mn></mrow><annotation encoding=application/x-tex>p=D(C)=(C-k)mod26</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class=mord>2</span><span class=mord>6</span></span></span></span></p><ul><li>加解密算法已知，密钥只有25个，适合穷举攻击</li></ul><h4 id=采样密码-decimation-cipher><a class=markdownIt-Anchor href=#采样密码-decimation-cipher></a> 采样密码 Decimation Cipher</h4><p>密文字母是将明文字母按下标每隔k位去除要给字母排列而成（字母表首尾相接），又称为乘法代替密码</p><p>加密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo>=</mo><mi>m</mi><mi>k</mi><mo>≡</mo><mi>C</mi><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><mn>0</mn><mo>≤</mo><mi>C</mi><mo>&lt;</mo><mi>q</mi></mspace></mspace></mrow><annotation encoding=application/x-tex>E_{k}(m)=mk\equiv C\pmod p,0\leq C&lt;q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">m</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72243em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span></p><ul><li>在乘法代替密码中，当且仅当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=false>(</mo><mi>k</mi><mo separator=true>,</mo><mi>q</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>gcd(k,q)=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>E_{k}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 才是一一映射</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>k=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 是，称为平凡密钥，此时所有字母映射到自身，不是一个合适的密钥</li><li>合适的密钥有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>φ</mi><mo stretchy=false>(</mo><mn>26</mn><mo stretchy=false>)</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\varphi(26)-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class=mord>2</span><span class=mord>6</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 个</li></ul><p>解密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>D</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>j</mi><mo stretchy=false>)</mo><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mi>j</mi><mo>≡</mo><mi>i</mi><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>q</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><mn>0</mn><mo>≤</mo><mi>j</mi><mo>&lt;</mo><mi>q</mi></mspace></mspace></mrow><annotation encoding=application/x-tex>D_{k}(j)=k^{-1}\cdot j\equiv i \pmod q,0\leq j&lt;q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.05724em>j</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.85396em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05724em>j</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.85396em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05724em>j</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span></p><h4 id=仿射代替密码><a class=markdownIt-Anchor href=#仿射代替密码></a> 仿射代替密码</h4><p>将移位代替密码和乘法代替密码结合起来就构成仿射代替密码</p><p>加密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo>=</mo><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>0</mn></msub><mo>≡</mo><mi>c</mi><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>q</mi><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>E_{k}(m)=mk_{1}+k_{0}\equiv c\pmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class="mord mathdefault">m</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>k</mi><mn>1</mn></msub><mo>∈</mo><msub><mi>Z</mi><mi>q</mi></msub><mo separator=true>,</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=false>(</mo><msub><mi>k</mi><mn>1</mn></msub><mo separator=true>,</mo><mi>q</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>k_{0},k_{1}\in Z_{q},gcd(k_{1},q)=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></p><ul><li>当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>k_{0}=0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span>，就是乘法代替密码；当 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>k_{1}=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>，就是移位代替密码</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi><mo>=</mo><mn>26</mn></mrow><annotation encoding=application/x-tex>q=26</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span><span class=mord>6</span></span></span></span> 时，密钥空间大小为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>26</mn><mo>∗</mo><mn>12</mn><mo>−</mo><mn>1</mn><mo>=</mo><mn>311</mn></mrow><annotation encoding=application/x-tex>26*12-1=311</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span><span class=mord>6</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mord>2</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>3</span><span class=mord>1</span><span class=mord>1</span></span></span></span> 个</li></ul><p>解密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>D</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>c</mi><mo stretchy=false>)</mo><mo>≡</mo><mo stretchy=false>(</mo><mi>c</mi><mo>−</mo><msub><mi>k</mi><mn>0</mn></msub><mo stretchy=false>)</mo><mo>⋅</mo><msubsup><mi>k</mi><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>q</mi><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>D_{k}(c)\equiv (c-k_{0})\cdot k_{1}^{-1}\pmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">c</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.120547em;vertical-align:-.266308em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.854239em><span style=top:-2.433692em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style=top:-3.1031310000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.266308em><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span></span></span></span></p><hr><h4 id=单表代替密码><a class=markdownIt-Anchor href=#单表代替密码></a> 单表代替密码</h4><p>每个明文字母映射到一个不同的随机密文字母</p><ul><li>可以选取一个英文短语，称为key word/key phrase，按顺序去掉重复字母，将它依次写在明文字母表下，将明文字母表中未在短语中出现过的字母依次写在短语之后，即构造出一个代替表。</li><li>密钥空间：<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>26</mn><mo stretchy=false>!</mo><mo>&gt;</mo><mn>4</mn><mo>∗</mo><mn>1</mn><msup><mn>0</mn><mn>26</mn></msup></mrow><annotation encoding=application/x-tex>26!&gt;4*10^{26}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class=mord>2</span><span class=mord>6</span><span class=mclose>!</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>4</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord>1</span><span class=mord><span class=mord>0</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span>，大于56位DES的密钥空间</li><li>看似安全，实则不然：可以基于语言统计规律进行破译</li><li>缺陷：密文带有原始字母使用频率的一些统计学特征，每个元素仅仅密文中的一个元素产生影响（解决：多个字母一起加密、多表代替）</li></ul><h5 id=语言的冗余与密码的分析密码破译就是研究明文信息在密文信息中有多大程度泄露><a class=markdownIt-Anchor href=#语言的冗余与密码的分析密码破译就是研究明文信息在密文信息中有多大程度泄露></a> 语言的冗余与密码的分析（密码破译就是研究明文信息在密文信息中有多大程度泄露）</h5><ul><li><p>英文字母的出现频率大小排列顺序：E TAO INSHR DL CMWFGYPBU VK JXQX</p></li><li><p>双字母的出现频率大小排列顺序：th he in er an</p></li><li><p>三字母、数字、标点符号等等</p></li><li><p>冠词the</p></li><li><p>英文中一半的词以e，s，d，t结尾，以t，a，s，w开头</p></li><li><p>分析步骤：统计密报的一节统计特性，识别报文为单表密，然后利用猜字法</p></li></ul><hr><h4 id=最著名的多字母代替密码playfair密码><a class=markdownIt-Anchor href=#最著名的多字母代替密码playfair密码></a> 最著名的多字母代替密码——Playfair密码</h4><p>把明文的双字母音节作为一个单元并将其转换为密文的“双字母音节”</p><ul><li>Playfair 密钥矩阵<ul><li>5*5字母矩阵</li><li>从左往右，从上到下：填充key word，用其他字母填写剩下的空缺</li><li>I=J</li></ul></li></ul><table><thead><tr><th style=text-align:center>M</th><th style=text-align:center>O</th><th style=text-align:center>N</th><th style=text-align:center>A</th><th style=text-align:center>R</th></tr></thead><tbody><tr><td style=text-align:center>C</td><td style=text-align:center>H</td><td style=text-align:center>Y</td><td style=text-align:center>B</td><td style=text-align:center>D</td></tr><tr><td style=text-align:center>E</td><td style=text-align:center>F</td><td style=text-align:center>G</td><td style=text-align:center>I/J</td><td style=text-align:center>K</td></tr><tr><td style=text-align:center>L</td><td style=text-align:center>P</td><td style=text-align:center>Q</td><td style=text-align:center>S</td><td style=text-align:center>T</td></tr><tr><td style=text-align:center>U</td><td style=text-align:center>V</td><td style=text-align:center>W</td><td style=text-align:center>X</td><td style=text-align:center>Z</td></tr></tbody></table><ul><li><p>加密规则</p><ul><li>明文字母（填充）：2个字母分为一组，不够则添加一个字母</li><li>同行字母对加密：循环向右，ei→FK</li><li>同列字母对加密：循环向下：cu→EM</li><li>其他字母加密：矩形对角线字母，且按行排序，hs→BP</li></ul></li><li><p>解密规则：加密的逆向操作</p></li><li><p>安全性：优于简单的单表代替密码，难用频率分析字母；但是密文中仍含有明文的部分结构信息，给定几百个字母即可被攻破</p></li></ul><h4 id=另一个多字母代换密码hill-cipher><a class=markdownIt-Anchor href=#另一个多字母代换密码hill-cipher></a> 另一个多字母代换密码——Hill Cipher</h4><p>加密方法是由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 个<strong>线性</strong>方程（矩阵）决定的，方程中每个字母被指定为一个数值</p><p>加密算法：1. 明文分组并编码 2. <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>≡</mo><mi>K</mi><mi>P</mi><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mn>26</mn><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>C\equiv KP\pmod{26}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class=mord>2</span><span class=mord>6</span><span class=mclose>)</span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span> 为密钥矩阵，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo separator=true>,</mo><mi>C</mi></mrow><annotation encoding=application/x-tex>P,C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span> 分别为明、密文分组</p><p>解密算法：1. 密文分组并编码 2. <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>≡</mo><msup><mi>K</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>C</mi><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mn>26</mn><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>P\equiv K^{-1}C\pmod{26}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class=mord>2</span><span class=mord>6</span><span class=mclose>)</span></span></span></span></p><ul><li>完全隐藏了单字母的频率特性（连续m个明文替换成m个密文）</li><li>所用矩阵越大所隐藏的频率信息越多</li><li>足以抵抗唯密文攻击，但是不能抵抗已知明文攻击</li></ul><hr><h4 id=多表代替密码-polyalphabetic-ciphers><a class=markdownIt-Anchor href=#多表代替密码-polyalphabetic-ciphers></a> 多表代替密码 Polyalphabetic Ciphers</h4><p>令明文字母表为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>Z</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>Z_{q}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>σ</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>σ</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mtext> </mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>k=(\sigma_{1},\sigma_{2},\dots)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mclose>)</span></span></span></span> 为代替表序列，明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><msub><mi>m</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>3</mn></msub><mo separator=true>,</mo><mo>…</mo></mrow><annotation encoding=application/x-tex>m=m_{1},m_{2},m_{3},\dots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span></span></span></span>，则相应的密文为：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>=</mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>σ</mi><mn>1</mn></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><msub><mi>σ</mi><mn>2</mn></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mo>…</mo></mrow><annotation encoding=application/x-tex>C=E_{k}(m)=\sigma_{1}(m_1),\sigma_2(m_2),\dots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span></span></span></span></p><ul><li>若 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 是非周期的无限序列，则相应的密码为非周期多表代替密码</li><li>对于每个明文字母都采用不同的代替表进行加密，称之为一次一密密码（one-time pad cipher）</li><li>实际中多采用周期多表代替密码 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>σ</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>σ</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>σ</mi><mi>d</mi></msub><mo separator=true>,</mo><msub><mi>σ</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>σ</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>σ</mi><mi>d</mi></msub><mo separator=true>,</mo><msub><mi>σ</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>σ</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mtext> </mtext><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>k=(\sigma_{1},\sigma_{2},\dots,\sigma_d,\sigma_{1},\sigma_{2},\dots,\sigma_d,\sigma_{1},\sigma_{2},\dots)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mclose>)</span></span></span></span></li></ul><h4 id=维吉尼亚密码-vigenère-cipher><a class=markdownIt-Anchor href=#维吉尼亚密码-vigenère-cipher></a> 维吉尼亚密码 Vigenère Cipher</h4><p>设明文为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>=</mo><msub><mi>p</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><annotation encoding=application/x-tex>P=p_1p_2\cdots p_n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，密钥为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>k</mi><mi>n</mi></msub></mrow><annotation encoding=application/x-tex>K=k_1k_2\cdots k_n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>c</mi><mi>n</mi></msub></mrow><annotation encoding=application/x-tex>C=c_1c_2\cdots c_n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p><p>加密算法：</p><ul><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><msub><mi>k</mi><mi>i</mi></msub><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mn>26</mn><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>n</mi></mspace></mspace></mrow><annotation encoding=application/x-tex>c_i=p_i+k_i\pmod {26},i=1,2,\dots,n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class=mord>2</span><span class=mord>6</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">i</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span></span></span></span></p></li><li><p>查表法</p></li></ul><h4 id=博福特密码-beaufort-cipher><a class=markdownIt-Anchor href=#博福特密码-beaufort-cipher></a> 博福特密码 Beaufort Cipher</h4><p>加密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>+</mo><mi>t</mi><mi>d</mi></mrow></msub><mo>=</mo><mi>σ</mi><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>+</mo><mi>t</mi><mi>d</mi></mrow></msub><mo stretchy=false>)</mo><mo>≡</mo><mo stretchy=false>(</mo><msub><mi>k</mi><mi>i</mi></msub><mo>−</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>+</mo><mi>t</mi><mi>d</mi></mrow></msub><mo stretchy=false>)</mo><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>q</mi><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>c_{i+td}=\sigma(m_{i+td})\equiv(k_i-m_{i+td})\pmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.638891em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mclose>)</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span></span></span></span></p><p>解密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mrow><mi>i</mi><mo>+</mo><mi>t</mi><mi>d</mi></mrow></msub><mo>=</mo><mi>σ</mi><mo stretchy=false>(</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>+</mo><mi>t</mi><mi>d</mi></mrow></msub><mo stretchy=false>)</mo><mo>≡</mo><mo stretchy=false>(</mo><msub><mi>k</mi><mi>i</mi></msub><mo>−</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>+</mo><mi>t</mi><mi>d</mi></mrow></msub><mo stretchy=false>)</mo><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>q</mi><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>m_{i+td}=\sigma(c_{i+td})\equiv(k_i-c_{i+td})\pmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.638891em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mclose>)</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span></span></span></span>（完全相同！）</p><p>对应的Vigenère cipher：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mrow><mi>i</mi><mo>+</mo><mi>t</mi><mi>d</mi></mrow></msub><mo>=</mo><mo stretchy=false>[</mo><mo stretchy=false>(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo><mo>−</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>+</mo><mi>t</mi><mi>d</mi></mrow></msub><mo>+</mo><mo stretchy=false>(</mo><msub><mi>k</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo stretchy=false>)</mo><mo stretchy=false>]</mo><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>q</mi><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>C_{i+td}=[(q-1)-m_{i+td}+(k_i+1)]\pmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>[</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.791661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class=mclose>]</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span></span></span></span></p><h4 id=弗纳姆密码-vernam-cipher><a class=markdownIt-Anchor href=#弗纳姆密码-vernam-cipher></a> 弗纳姆密码 Vernam Cipher</h4><ol><li><p>选择择随机二元数字序列作为密钥，以 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>k</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator=true>,</mo><mo>…</mo><mo stretchy=false>(</mo><msub><mi>k</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>F</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>k=k_1,k_2,\dots,k_i,\dots(k_i\in F_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 表示</p></li><li><p>文字母变成二元向量后也可以表示成二元序列 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><msub><mi>m</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo separator=true>,</mo><mo>…</mo><mo stretchy=false>(</mo><msub><mi>m</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>F</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>m=m_1,m_2,\dots,m_i,\dots(m_i\in F_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 分别记录在穿孔纸带上。</p></li><li><p>加密算法：将 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的相应位逐位模2相加，即 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msub><mi>m</mi><mi>i</mi></msub><mo>⨁</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator=true>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo></mrow><annotation encoding=application/x-tex>c_i=m_i\bigoplus k_i,j=1,2,\dots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.00001em;vertical-align:-.25001em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>⨁</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.05724em>j</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span></span></span></span></p></li><li><p>解密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo>⨁</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator=true>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo></mrow><annotation encoding=application/x-tex>m_i=c_i\bigoplus k_i,j=1,2,\dots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.00001em;vertical-align:-.25001em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>⨁</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.05724em>j</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span></span></span></span></p></li></ol><ul><li><p>这种加密方式如果使用电子器件实现，就是一种序列密码</p></li><li><p>如果采用的密钥不重复就是一次一密体制，理论上不可破，但是实际上不可行</p></li></ul><h5 id=周期多表代替密码的破译><a class=markdownIt-Anchor href=#周期多表代替密码的破译></a> 周期多表代替密码的破译</h5><ol><li>判断加密类型是单表代替密码还是多表代替密码</li></ol><ul><li>粗糙度 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi mathvariant=normal>.</mi><mi>R</mi></mrow><annotation encoding=application/x-tex>M.R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mord>.</span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span>：定义为每个密文字母出现的频率与均匀分布时每个字母出现的概率的离差的平方和。<ul><li>对于英文字母而言，明文或单表代替密码的粗糙度为0.027， 一般密文的粗糙度将在0~0.027之间变化。</li></ul></li></ul><ol start=2><li>初步判定多表代替密码所用的密表数</li></ol><ul><li>重合指数I.C值：知道了I.C值就可以提取密钥字长或密表数<strong>的近似</strong>值信息</li></ul><ol start=3><li>确定多表代替密码所用的密表数</li></ol><ul><li>移位法：对密文进行移位并和原来的密文进行逐位比较以求重码数，根据重码数来确定密表数</li><li>重复字模式分析法（Kasiski检验）：计算密文中重复字模式的距离</li></ul><ol start=4><li>密表匹配</li></ol><hr><h4 id=转轮机><a class=markdownIt-Anchor href=#转轮机></a> ※：转轮机</h4><p>eg：German Enigma，Allied Hagelin，Japanese Purple</p><ul><li>实现了复杂多变的多表代替密码，多层加密</li><li>每个圆柱体有26个输入、输出引脚，代表26个字母</li><li>单个圆柱体定义一个单表代换</li><li>每个圆柱体每次定义的单表代换算法不同</li><li>单个圆柱体定义了周期为26的多表代换</li></ul><h3 id=置换技术><a class=markdownIt-Anchor href=#置换技术></a> 置换技术</h3><h4 id=栅栏技术按对角线顺序写出明文以行的顺序读出作为密文><a class=markdownIt-Anchor href=#栅栏技术按对角线顺序写出明文以行的顺序读出作为密文></a> 栅栏技术：按对角线顺序写出明文，以行的顺序读出作为密文</h4><ul><li>改进：带有密钥，重复加密，多步置换</li></ul><h4 id=矩阵排列法优先行列置换><a class=markdownIt-Anchor href=#矩阵排列法优先行列置换></a> 矩阵排列法：优先行/列置换</h4><h3 id=隐写术><a class=markdownIt-Anchor href=#隐写术></a> 隐写术</h3><ul><li>不可见的墨水</li><li>打字机的色带校正<br>缺点：开销大，需要额外的付出来隐藏相对较少的信息；一旦被发现就完全没有价值</li><li>一个可选的方案：先加密，然后用隐写术隐藏</li></ul><h2 id=分组密码和数据加密协议><a class=markdownIt-Anchor href=#分组密码和数据加密协议></a> 分组密码和数据加密协议</h2><h3 id=feistel分组密码结构><a class=markdownIt-Anchor href=#feistel分组密码结构></a> Feistel分组密码结构</h3><ul><li>理想分组密码：设每 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 个一组，不同的映射/代换（即密钥）有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo stretchy=false>!</mo></mrow><annotation encoding=application/x-tex>2^n!</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mclose>!</span></span></span></span> 种，每一种密钥的大小是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>∗</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>n*2^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.46528em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 位（并不实用）</li><li>Feistel 提出了一种近似体制：使用<strong>乘积密码</strong>的概念来逼近理想分组密码</li></ul><h4 id=乘积密码-product-cipher><a class=markdownIt-Anchor href=#乘积密码-product-cipher></a> <strong>乘积密码</strong> Product Cipher</h4><ul><li>在单个加密机制中依次使用两个或两个以上不同类型的基本密码（如：代换和置换），所得结果的密码强度将强于每个单个密码的强度。<ul><li>本质：开发一个分组密码，密钥长为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 位，分组长为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 位，采用 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=application/x-tex>2^k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.849108em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span></span></span> 个变换</li></ul></li></ul><h4 id=claude-shannon-and-substitution-permutation-ciphers><a class=markdownIt-Anchor href=#claude-shannon-and-substitution-permutation-ciphers></a> <strong>Claude Shannon and Substitution-Permutation Ciphers</strong></h4><ul><li><p>1949年，Claude Shannon 引进了 substitution-permutation (S-P) networks 的思想，即现代的乘积加密器，形成了现代分组加密的基础</p></li><li><p>S-P Networks 基于<strong>代替</strong>和<strong>置换</strong>这两个基本操作，提供了对明文信息处理所做的混淆和扩散</p></li><li><p>Shannon认为，为了对付基于统计分析的密码破译，必须对明文作混淆和扩散处理，以减少密文的统计特性，为统计分析制造障碍</p><ul><li><p>混淆 Confusion：尽可能使密文和加密密钥之间的关系变得复杂，以阻止攻击者发现密钥</p></li><li><p>扩散 Diffusion：让每个明文数字尽可能地影响多个密文数字，使明文的统计特性消散在密文中</p></li></ul></li><li><p><strong>Feistel建议交替使用代换和置换，增强密码的扩散和混淆性能</strong></p></li></ul><h3 id=feistel密码><a class=markdownIt-Anchor href=#feistel密码></a> Feistel密码</h3><ul><li><p>加密算法：</p><p>令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 为轮函数；令 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>K</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>K</mi><mi>n</mi></msub></mrow><annotation encoding=application/x-tex>K_1,K_2,\dots,K_n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 分别为第 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>1,2,\dots,n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span></span></span></span> 轮的子密钥。那么基本构造过程如下：<br>（1）将明文信息均分为两块：<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>L</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>R</mi><mn>0</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(L_0,R_0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>；<br>（2）在每一轮中，进行如下运算（<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span></span></span></span> 为当前轮数）：<br><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>L_{i+1} = R_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；<br><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>L</mi><mi>i</mi><mo>⨁</mo><mi>F</mi><mo stretchy=false>(</mo><msub><mi>R</mi><mi>i</mi></msub><mo separator=true>,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>R_{i+1} = Li\bigoplus F(R_i,K_i)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.00001em;vertical-align:-.25001em></span><span class="mord mathdefault">L</span><span class="mord mathdefault">i</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>⨁</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p></li></ul><p>​ 所得的结果即为：<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(R_{i+1},L_{i+1})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p><ul><li><p>解密算法：</p><p>对于密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><msub><mi>L</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(R_{n+1},L_{n+1})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> ，我们将 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span></span></span></span> 由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 向 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn></mrow><annotation encoding=application/x-tex>0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span> 进行，即 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi><mo>=</mo><mi>n</mi><mo separator=true>,</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>i = n,n-1,\dots,0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>0</span></span></span></span>。然后对密文进行加密的逆向操作，如下：</p><p>（1）<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>R_i = L_{i+1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span>；</p><p>（2）<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>⨁</mo><mi>F</mi><mo stretchy=false>(</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>L_i = R_{i+1}\bigoplus F(L_{i+1},K_i)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.00001em;vertical-align:-.25001em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>⨁</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p><p>所得结果为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>L</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>R</mi><mn>0</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(L_0,R_0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>，即原来的明文信息</p></li><li><p>依赖的参数和设计特点</p><ul><li>分组大小：分组越大意味着安全性越高（如果其他条件相同），但加密/解密速度也越慢</li><li>密钥大小：密钥长度越长则安全性越高，但加密/解密速度也越慢</li><li>循环次数：一个循环不能保证足够的安全性，而循环越多 则安全性越高</li><li>子密钥产生算法 ：算法越复杂则密码分析就应该越困难</li><li>Round函数：复杂性越高则抗击密码分析的能力就越强</li></ul></li></ul><h3 id=数据加密标准-des><a class=markdownIt-Anchor href=#数据加密标准-des></a> 数据加密标准 DES</h3><h4 id=des-的基本概念><a class=markdownIt-Anchor href=#des-的基本概念></a> DES 的基本概念</h4><ul><li><p>Data Encryption Standard：1977年美国国家标准局公布的IBM公司研制的一种数据加密算法:数据加密标准</p></li><li><p>破译方法</p><ul><li>DES 受到的最大攻击是它的密钥长度仅有56比特</li><li>1990年 S.Biham 和 A.Shamir 提出了差分攻击的方法，采用选择明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>47</mn></msup></mrow><annotation encoding=application/x-tex>2^{47}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span></span> 攻击，最终找到可能的密钥</li><li>M.Matsui 提出的线性分析方法，利用 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>47</mn></msup></mrow><annotation encoding=application/x-tex>2^{47}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span></span> 个已知明文，成功地破译了16圈 DES算法，到目前为止，这是最有效的破译方法</li></ul></li><li><p>实现步骤：</p><ol><li>给定明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>X</mi></mrow><annotation encoding=application/x-tex>X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>X</span></span></span></span>，通过一个固定的初始置换 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>I</mi><mi>P</mi></mrow><annotation encoding=application/x-tex>IP</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span> 来排列 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>X</mi></mrow><annotation encoding=application/x-tex>X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>X</span></span></span></span> 中的位，得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>X_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>。 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><mi>I</mi><mi>P</mi><mo stretchy=false>(</mo><mi>X</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>L</mi><mn>0</mn></msub><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>X_0=IP(X)=L_0R_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>。其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>L_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 由 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>X_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 前32位组成， <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>R_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 由 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>X_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的后32位组成。</li><li>计算函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>F</span></span></span></span> 的16次迭代, 根据下述规则来计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><msub><mi>R</mi><mi>i</mi></msub><mo stretchy=false>(</mo><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mn>16</mn><mo stretchy=false>)</mo><mo>:</mo><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⨁</mo><mo stretchy=false>(</mo><msub><mi>R</mi><mi>i</mi></msub><mo separator=true>,</mo><msub><mi>K</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>L_iR_i(1\leq i\leq 16 ): L_i=R_{i-1},R_i=L_{i-1}\bigoplus(R_i,K_i)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.79549em;vertical-align:-.13597em></span><span class="mord mathdefault">i</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mord>6</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.00001em;vertical-align:-.25001em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>⨁</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>。其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>K_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 是长为48位的子密钥。子密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>K</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>K</mi><mn>16</mn></msub></mrow><annotation encoding=application/x-tex>K_1,K_2,\dots,K_{16}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 是作为密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span>（56位）的函数而计算出的。</li><li>对比特串 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mn>16</mn></msub><msub><mi>L</mi><mn>16</mn></msub></mrow><annotation encoding=application/x-tex>R_{16}L_{16}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 使用逆置换 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>I</mi><msup><mi>P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=application/x-tex>IP^{-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 得到密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding=application/x-tex>Y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span></span></span></span>。<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Y</mi><mo>=</mo><mi>I</mi><msup><mi>P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><msub><mi>R</mi><mn>16</mn></msub><msub><mi>L</mi><mn>16</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Y=IP^{-1}(R_{16}L_{16})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></li></ol></li><li><p>DES 加密流程图</p><div align=center><img src=/img/post/密码学备忘/DES加密流程图.png alt=DES一轮迭代 style=zoom:50%></div></li><li><p>DES 一轮迭代</p><div align=center><img src=/img/post/密码学备忘/DES一轮迭代.jpg alt=DES一轮迭代 style=zoom:67%></div></li><li><p>S盒选取</p><p>每一个S盒都接受6个比特作为输入并产生4个比特作为输出。</p><p>输入的第一和最后一个比特构成一个2位二进制数，用来选择由 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>S_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 表中的四行所定义的四种替代的一种，中间的4个比特则选出一列</p></li><li><p>子密钥的产生</p><div align=center><img src=/img/post/密码学备忘/DES子密钥生成.png alt=DES子密钥生成 style=zoom:50%></div><ul><li>弱密钥：给定的初始密钥k产生的16个子密钥相同</li><li>半弱密钥：若存在种子密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>k</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>(</mo><msup><mi>k</mi><mo mathvariant=normal>′</mo></msup><mi mathvariant=normal>≠</mi><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>k&#x27;(k&#x27;\neq k)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>，使 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>D</mi><mi>E</mi><msub><mi>S</mi><msup><mi>k</mi><mo mathvariant=normal>′</mo></msup></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo>=</mo><mi>D</mi><mi>E</mi><msub><mi>S</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>DES_{k&#x27;}(m)=DES_k(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6828285714285715em><span style=top:-2.786em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span>，则称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 是半弱密钥，且称 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>k</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>k&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 是对合的</li></ul></li><li><p>DES 的雪崩效应：（P置换的目的是提供雪崩效应） 明文或密钥的一点小的变动都引起密文的较大变化</p></li><li><p>攻击方法：差分密码分析攻击 线性密码分析</p></li></ul><h4 id=差分分析方法><a class=markdownIt-Anchor href=#差分分析方法></a> 差分分析方法</h4><ol><li>对于 DES 的分析，可忽略初始置换 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>I</mi><mi>P</mi></mrow><annotation encoding=application/x-tex>IP</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>I</mi><msup><mi>P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=application/x-tex>IP^{-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 。</li><li>对DES 限制到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 轮（<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>≤</mo><mn>16</mn></mrow><annotation encoding=application/x-tex>n\leq 16</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719400000000001em;vertical-align:-.13597em></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mord>6</span></span></span></span> ）。</li><li>以 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>L_0R_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 为明文，且以 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>L_0R_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 作为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 轮 DES 的密文。</li><li>对两个明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>L_0R_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>L</mi><mn>0</mn><mo>∗</mo></msubsup><msubsup><mi>R</mi><mn>0</mn><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>L_0^*R_0^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.936804em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span> ，规定它们的异或值为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>L</mi><mn>0</mn><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><msubsup><mi>R</mi><mn>0</mn><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo>=</mo><msub><mi>L</mi><mn>0</mn></msub><msub><mi>R</mi><mn>0</mn></msub><mo>⊕</mo><msubsup><mi>L</mi><mn>0</mn><mo>∗</mo></msubsup><msubsup><mi>R</mi><mn>0</mn><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>L_0^{&#x27;}R_0^{&#x27;} =L_0R_0\oplus L_0^*R_0^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.190588em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.4518920000000004em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.936804em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span>，整个讨论都使用撇号 （<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>）表示两个比特串的异或值。 ）表示两个比特串的异或值。</li></ol><ul><li><p>定义 1：设 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>𝑆</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>𝑆_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 是一个特定的 S盒 (<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mn>8</mn></mrow><annotation encoding=application/x-tex>1\leq j\leq 8</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78041em;vertical-align:-.13597em></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.85396em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05724em>j</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>8</span></span></span></span>)，考虑长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>6</mn></mrow><annotation encoding=application/x-tex>6</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>6</span></span></span></span> 的比特串的一个有序对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>B</mi><mi>j</mi></msub><mo separator=true>,</mo><msubsup><mi>B</mi><mi>j</mi><mo>∗</mo></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(B_j,B^*_j)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1447720000000001em;vertical-align:-.394772em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>,我们说 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>𝑆</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>𝑆_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 的输入 异或是 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub><mo>⊕</mo><msubsup><mi>B</mi><mi>j</mi><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>B_j\oplus B^*_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.0834679999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span>,输出异或是 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msub><mi>B</mi><mi>j</mi></msub><mo stretchy=false>)</mo><mo>⊕</mo><msub><mi>S</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msubsup><mi>B</mi><mi>j</mi><mo>∗</mo></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>S_j(B_j)\oplus S_j(B^*_j)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.1447720000000001em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p><ul><li>输入异或是长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>6</mn></mrow><annotation encoding=application/x-tex>6</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>6</span></span></span></span> 的比特串 ，输出异或是长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>4</mn></mrow><annotation encoding=application/x-tex>4</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>4</span></span></span></span> 的比特串 。</li></ul></li><li><p>定义 2：对任何一 个 B_j^' \in (𝑍_2)^6=\left\{(a_0,a_1,a_2,a_3,a_4,a_5)|a_j\in \left\{0,1 \right \} \right \}，定义集合 \Delta(B_j^') 是由输入异或为 B_j^' 的有序对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>B</mi><mi>j</mi></msub><mo separator=true>,</mo><msubsup><mi>B</mi><mi>j</mi><mo>∗</mo></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(B_j,B_j^*)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1447720000000001em;vertical-align:-.394772em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 组成</p><ul><li><p>对比特串 B_j^' 来说，集合 \Delta(B_j^') 包含 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>6</mn></msup><mo>=</mo><mn>64</mn></mrow><annotation encoding=application/x-tex>2^6=64</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>6</span><span class=mord>4</span></span></span></span> 个有序对元素。有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>Δ</mi><mo stretchy=false>(</mo><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><msub><mi>B</mi><mi>j</mi></msub><mo separator=true>,</mo><msub><mi>B</mi><mi>j</mi></msub><mo>⊕</mo><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo><mi mathvariant=normal>∣</mi><msub><mi>B</mi><mi>j</mi></msub><mo>∈</mo><mo stretchy=false>(</mo><msub><mi>Z</mi><mn>2</mn></msub><msup><mo stretchy=false>)</mo><mn>6</mn></msup></mrow><annotation encoding=application/x-tex>\Delta (B^{&#x27;}_j)=(B_j, B_j\oplus B_j^{&#x27;})|B_j \in (Z_2)^6</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord>Δ</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord>∣</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></p><p>这是因为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub><mo>⨁</mo><mo>⊕</mo><msubsup><mi>B</mi><mi>j</mi><mo>∗</mo></msubsup><mo>=</mo><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup></mrow><annotation encoding=application/x-tex>B_j⨁\oplus B_j^{*}= B_j^{&#x27;}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1447720000000001em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>⨁</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>⊕</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span> ，所以 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub><mo>⊕</mo><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo>=</mo><msubsup><mi>B</mi><mi>j</mi><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>B_j\oplus B_j^{&#x27;}= B_j^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0834679999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span></p></li><li><p>对 \Delta(B_j^') 中的每一对，我们能够计算出 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>S_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 的输出异或，同时用表列出结果的分布。有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>64</mn></mrow><annotation encoding=application/x-tex>64</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>6</span><span class=mord>4</span></span></span></span> 个输入异或，它们经 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>S_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 的输出分布在 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><mn>16</mn></mrow><annotation encoding=application/x-tex>2^4=16</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mord>6</span></span></span></span> 种可能值中，这些分布的非均匀性，<strong>就是攻击 DES 的基础</strong></p></li><li><p>表示一个 S 盒的所有可能对的输入异或盒输出异或分布的表称为该 S 盒的差分分布表</p></li></ul></li><li><p>定义 3：对于长度 6 的比特串 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup></mrow><annotation encoding=application/x-tex>B_j^{&#x27;}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span> 和长度为 4 的比特串 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>(</mo><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mn>8</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>C_j^{&#x27;}(1\leq j\leq 8)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.85396em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05724em>j</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>8</span><span class=mclose>)</span></span></span></span>，定义 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>I</mi><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo separator=true>,</mo><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo><mo>=</mo><mrow><mo fence=true>{</mo><msub><mi>B</mi><mi>j</mi></msub><mo>∈</mo><mo stretchy=false>(</mo><msub><mi>Z</mi><mn>2</mn></msub><msup><mo stretchy=false>)</mo><mn>6</mn></msup><mi mathvariant=normal>∣</mi><msub><mi>S</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msub><mi>B</mi><mi>j</mi></msub><mo stretchy=false>)</mo><mo>⊕</mo><msub><mi>S</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msub><mi>B</mi><mi>j</mi></msub><mo>⊕</mo><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo><mo>=</mo><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo fence=true>}</mo></mrow><mi mathvariant=normal>，</mi><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo separator=true>,</mo><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo><mo>=</mo><mi mathvariant=normal>∣</mi><mrow><mi>I</mi><msub><mi>N</mi><mi>j</mi></msub></mrow><mo stretchy=false>(</mo><msubsup><mi>B</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo separator=true>,</mo><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo><mi mathvariant=normal>∣</mi></mrow><annotation encoding=application/x-tex>IN_j(B_j^{&#x27;},C_j^{&#x27;})=\left\{B_j\in (Z_2)^6|S_j(B_j)\oplus S_j(B_j\oplus B_j^{&#x27;})=C_j^{&#x27;}\right\}，N_j(B_j^{&#x27;},C_j^{&#x27;})=| {IN_j}(B_j^{&#x27;},C_j^{&#x27;})|</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.80002em;vertical-align:-.65002em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">{</span></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class=mord>∣</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">}</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord cjk_fallback">，</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord>∣</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord>∣</span></span></span></span></p><ul><li>那些输出异或相同的 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>B_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 的集合</li><li>考虑一般的情况：对于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>D</mi><mi>E</mi><mi>S</mi></mrow><annotation encoding=application/x-tex>DES</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span></span> 的 8 个 S 盒的每一个盒有 64 可能的输入异或，于是有 512 个分布</li></ul></li><li><p>定义 4：设 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>E_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>E</mi><mi>j</mi><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>E_j^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0834679999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span> 是长度为 6 的比特串，<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup></mrow><annotation encoding=application/x-tex>C_j^{&#x27;}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span> 是长度为 4 的比特串，定义 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>T</mi><mi>e</mi><mi>s</mi><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msub><mi>E</mi><mi>j</mi></msub><mo separator=true>,</mo><msubsup><mi>E</mi><mi>j</mi><mo>∗</mo></msubsup><mo separator=true>,</mo><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo><mo>=</mo><mrow><mo fence=true>{</mo><msub><mi>B</mi><mi>j</mi></msub><mo>⊕</mo><msub><mi>E</mi><mi>j</mi></msub><mi mathvariant=normal>∣</mi><msub><mi>B</mi><mi>j</mi></msub><mo>∈</mo><mi>I</mi><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msubsup><mi>E</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo separator=true>,</mo><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo><mo fence=true>}</mo></mrow></mrow><annotation encoding=application/x-tex>Test_j(E_j,E_j^*,C_j^{&#x27;})=\left\{B_j\oplus E_j|B_j\in IN_j(E_j^{&#x27;},C_j^{&#x27;})\right\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.80002em;vertical-align:-.65002em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">{</span></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mord>∣</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">}</span></span></span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub><mo>⊕</mo><msub><mi>E</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>B_j\oplus E_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 是 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>J</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>J_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.09618em>J</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 的形式。</p><ul><li>假设 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>E</mi><mi>j</mi><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>E_j^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0834679999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span> 是 S 盒 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>S_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 的两个输入，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>S_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 的输出异或为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup></mrow><annotation encoding=application/x-tex>C_j^{&#x27;}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span> ，记为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>E</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo>=</mo><msub><mi>E</mi><mi>j</mi></msub><mo>⊕</mo><msubsup><mi>E</mi><mi>j</mi><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>E_j^{&#x27;}=E_j\oplus E_j^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.0834679999999999em;vertical-align:-.394772em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span></span></span></span>，那么密钥比特 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>J</mi><mi>J</mi></msub></mrow><annotation encoding=application/x-tex>J_J</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.09618em>J</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.09618em>J</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 出现在集合 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>T</mi><mi>e</mi><mi>s</mi><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msub><mi>E</mi><mi>j</mi></msub><mo separator=true>,</mo><msubsup><mi>E</mi><mi>j</mi><mo>∗</mo></msubsup><mo separator=true>,</mo><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Test_j(E_j,E_j^*,C_j^{&#x27;})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 之中。</li></ul></li><li><p>3 轮 DES 的差分攻击模式：</p><p>输入：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><msub><mi>R</mi><mn>0</mn></msub><mo separator=true>,</mo><msubsup><mi>L</mi><mn>0</mn><mo>∗</mo></msubsup><msubsup><mi>R</mi><mn>0</mn><mo>∗</mo></msubsup><mo separator=true>,</mo><msub><mi>L</mi><mn>3</mn></msub><msub><mi>R</mi><mn>3</mn></msub><mi mathvariant=normal>和</mi><msubsup><mi>L</mi><mn>3</mn><mo>∗</mo></msubsup><msubsup><mi>R</mi><mn>3</mn><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>L_0R_0,L_0^*R_0^*,L_3R_3 和 L_3^*R_3^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.936804em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><msubsup><mi>R</mi><mn>0</mn><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>R_0=R_0^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.936804em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.4518920000000004em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span></span></span></span></p><ol><li>计算： <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>C</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msup><mo>=</mo><msup><mi>P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><msubsup><mi>R</mi><mn>3</mn><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo>⊕</mo><msubsup><mi>L</mi><mn>0</mn><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>C^{&#x27;}=P^{-1}(R_3^{&#x27;}\oplus L_0^{&#x27;})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.94248em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.94248em;margin-right:.05em><span class=pstrut style=height:2.57948em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.19248em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.4518920000000004em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.19248em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.4518920000000004em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></li><li>计算：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>E</mi><mo>=</mo><mi>E</mi><mo stretchy=false>(</mo><msub><mi>L</mi><mn>3</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>E=E(L_3)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>E</mi><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>E^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.688696em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></li><li>For j in range(0,8) 计算：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>T</mi><mi>e</mi><mi>s</mi><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=false>(</mo><msub><mi>E</mi><mi>j</mi></msub><mo separator=true>,</mo><msubsup><mi>E</mi><mi>j</mi><mo>∗</mo></msubsup><mo separator=true>,</mo><msubsup><mi>C</mi><mi>j</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Test_j(E_j,E_j^*,C_j^{&#x27;})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3372519999999999em;vertical-align:-.394772em></span><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class=mord><span class="mord mathdefault">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.688696em><span style=top:-2.441336em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.441336em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.394772em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></li></ol></li></ul><h4 id=三重-des><a class=markdownIt-Anchor href=#三重-des></a> 三重 DES</h4><ul><li>设 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>E</mi></mrow><annotation encoding=application/x-tex>E</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>E</span></span></span></span> 是一个密码算法，如果对任意的密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>k_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>k_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，都存在密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>3</mn></msub></mrow><annotation encoding=application/x-tex>k_3</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，使得对任意的明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 有：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>E</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><msub><mi>E</mi><msub><mi>k</mi><mn>3</mn></msub></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>E_{k_1}(E_{k_2}(x))=E_{k_3}(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span>，则称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>E</mi></mrow><annotation encoding=application/x-tex>E</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>E</span></span></span></span> 是闭合的。显然，</li></ul><p>※：1992年，K.W. Campbell，M.J. Wiener 证明了 DES 不是一个群。</p><p>正因以上结论，二重 DES，三重 DES 有一定的价值，其穷举攻击的安全性虽有所改进，然而<strong>并非2倍，3倍的密钥量那么坚强</strong></p><ul><li><p>中途相遇攻击法</p><p>若有明文密文对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x_i,y_i)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>E</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>E</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>y_i=E_{k_2}(E_{k_1}(x_i))</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mclose>)</span></span></span></span></p><p>则可得 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>z</mi><mo>=</mo><msub><mi>E</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=false>)</mo><mo>=</mo><msub><mi>D</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>z=E_{k_1}(x_i)=D_{k_2}(y_i)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.04398em>z</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p></li></ul><p>给定一已知明密文对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x_1,y_1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> ，可按下述方法攻击：</p><ol><li><p>以密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>k_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的所有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>56</mn></msup></mrow><annotation encoding=application/x-tex>2^{56}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 个可能的取值对此明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>x_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 加密，并将密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>z</mi></mrow><annotation encoding=application/x-tex>z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.04398em>z</span></span></span></span> 存储在一个表中；</p></li><li><p>从所有可能的 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>56</mn></msup></mrow><annotation encoding=application/x-tex>2^{56}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 个密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>k_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 中依任意次序选出一个对给定的密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>y_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 解密，并将每次解密结果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>z</mi></mrow><annotation encoding=application/x-tex>z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.04398em>z</span></span></span></span>，在上述表中查找相匹配的值。一旦找到，则可确定出两个密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>k_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>k_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；</p></li><li><p>以此对密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>k_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>k_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 对另一已知明文密文对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x_2,y_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 中的明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>x_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 进行加密，如果能得出相应的密文 就可确定 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>k_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>k_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 是所要找的密钥。</p></li></ol><p>eg:</p><ol><li><p>对于给定明文，以两重DES加密将有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>64</mn></msup></mrow><annotation encoding=application/x-tex>2^{64}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span> 个可能的密文。</p></li><li><p>可能的密钥数为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>112</mn></msup></mrow><annotation encoding=application/x-tex>2^{112}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 个。所以，在给定明文下，将有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>112</mn></msup><mi mathvariant=normal>/</mi><msup><mn>2</mn><mn>64</mn></msup><mo>=</mo><msup><mn>2</mn><mn>48</mn></msup></mrow><annotation encoding=application/x-tex>2^{112}/2^{64} =2^{48}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mord>/</span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span></span> 个密钥能产生给定的密文。</p></li><li><p>用另一对64bits明文密文对进行检验，就使虚报率降为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mo stretchy=false>(</mo></msup><mn>48</mn><mo>−</mo><mn>64</mn><mo stretchy=false>)</mo><mo>=</mo><msup><mn>2</mn><mrow><mo>−</mo><mn>16</mn></mrow></msup></mrow><annotation encoding=application/x-tex>2^(48-64)=2^{-16}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9713299999999999em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span></span></span></span></span><span class=mord>4</span><span class=mord>8</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>6</span><span class=mord>4</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span>。</p></li><li><p>这一攻击法所需的存储量为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>56</mn></msup><mo>×</mo><mn>8</mn></mrow><annotation encoding=application/x-tex>2^{56}×8</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>8</span></span></span></span> Byte，最大试验的加密次数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>2</mn><mo>×</mo><msup><mn>2</mn><mn>56</mn></msup><mo>=</mo><msup><mn>2</mn><mn>57</mn></msup></mrow><annotation encoding=application/x-tex>2×2^{56} =2^{57}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>2</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span></span>。这说明破译双重DES的难度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>57</mn></msup></mrow><annotation encoding=application/x-tex>2^{57}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span></span> 量级。</p></li></ol><ul><li><p>三重DES加密</p><p>加密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>E</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>[</mo><msub><mi>D</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo stretchy=false>[</mo><msub><mi>E</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>[</mo><mi>x</mi><mo stretchy=false>]</mo><mo stretchy=false>]</mo><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>y=E_{k_1}[D_{k_2}[E_{k_1} [x]]]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathdefault">x</span><span class=mclose>]</span><span class=mclose>]</span><span class=mclose>]</span></span></span></span></p><p>解密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>=</mo><msub><mi>D</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>[</mo><msub><mi>E</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo stretchy=false>[</mo><msub><mi>D</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>[</mo><mi>y</mi><mo stretchy=false>]</mo><mo stretchy=false>]</mo><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>x=D_{k_1}[E_{k_2}[D_{k_1}[y]]]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>]</span><span class=mclose>]</span><span class=mclose>]</span></span></span></span></p><p>称其为加密-解密-加密方案，简记为EDE(encrypt-decrypt-encrypt)。</p></li></ul><h2 id=高级加密标准-aes><a class=markdownIt-Anchor href=#高级加密标准-aes></a> 高级加密标准 AES</h2><p>评估要求：安全性、计算效率、内存要求、使用简便性、灵活性</p><ul><li><p>AES 是一个迭代型分组密码，分组长度固定为 128 比特，密钥长度则可以是 128，192 或 256 比特</p></li><li><p>Rijndael 是一个迭代型分组密码，分组长度和密钥长度均可以是 128，192 或 256 比特</p></li><li><p>AES加密过程涉及到4种操作，分别是字节替代、行移位、列混淆和轮密钥加。</p><p>解密过程分别为对应的逆操作。</p><p>加解密中每轮的密钥分别由初始密钥扩展得到。算法中16个字节的明文、密文和轮密钥都以一个4x4的矩阵表示。</p><div align=center><img src=/img/post/密码学备忘/AES.png style=zoom:50%></div></li></ul><h3 id=字节替代-subbytes><a class=markdownIt-Anchor href=#字节替代-subbytes></a> 字节替代 SubBytes</h3><ul><li><p>它独立地将状态中的每个字节利用代换表(S盒)进行运算</p><ul><li><p>S盒被设计成能够抵挡所有已知的攻击</p></li><li><p>S盒是由16×16个字节组成的矩阵，包含了8位值所能表达的256种可能的变换</p></li><li><p>※ DES：S: 6→4 AES: 8→8</p></li></ul></li><li><p>State中的每个字节按照如下的方式映射为一个新的字节：将该字节的高4位作为行值，低4位作为列值，然后取出S盒中对应行列交叉处的元素作为输出</p></li></ul><h4 id=s盒的构造方法><a class=markdownIt-Anchor href=#s盒的构造方法></a> S盒的构造方法</h4><ol><li><p>逐行按照上升排列的方式初始化 S 盒。第一行是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>{</mo><mn>00</mn><mo stretchy=false>}</mo><mo separator=true>,</mo><mo stretchy=false>{</mo><mn>01</mn><mo stretchy=false>}</mo><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mo stretchy=false>{</mo><mn>0</mn><mi>F</mi><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>\{00\},\{01\},\dots,\{0F\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mord>0</span><span class=mclose>}</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>{</span><span class=mord>0</span><span class=mord>1</span><span class=mclose>}</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>{</span><span class=mord>0</span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mclose>}</span></span></span></span>；第二行是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>{</mo><mn>10</mn><mo stretchy=false>}</mo><mo separator=true>,</mo><mo stretchy=false>{</mo><mn>11</mn><mo stretchy=false>}</mo><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mo stretchy=false>{</mo><mn>1</mn><mi>F</mi><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>\{10\},\{11\},\dots,\{1F\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>1</span><span class=mord>0</span><span class=mclose>}</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>{</span><span class=mord>1</span><span class=mord>1</span><span class=mclose>}</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>{</span><span class=mord>1</span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mclose>}</span></span></span></span> 等，在 x 行 y 列的字节值是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>{</mo><mi>x</mi><mi>y</mi><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>\{xy\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class="mord mathdefault">x</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>}</span></span></span></span> ；</p></li><li><p>把S盒中的每个字节映射为它在有限域 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi><mi>F</mi><mo stretchy=false>(</mo><msup><mn>2</mn><mn>8</mn></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>GF(2^8)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mopen>(</span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 上的乘法逆；其中，元素 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>{</mo><mn>00</mn><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>\{00\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mord>0</span><span class=mclose>}</span></span></span></span> 映射到它自身 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>{</mo><mn>00</mn><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>\{00\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mord>0</span><span class=mclose>}</span></span></span></span> ；</p></li><li><p>把S盒中的每个字节表示为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>(</mo><msub><mi>b</mi><mn>7</mn></msub><mo separator=true>,</mo><msub><mi>b</mi><mn>6</mn></msub><mo separator=true>,</mo><msub><mi>b</mi><mn>5</mn></msub><mo separator=true>,</mo><msub><mi>b</mi><mn>4</mn></msub><mo separator=true>,</mo><msub><mi>b</mi><mn>3</mn></msub><mo separator=true>,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>b</mi><mn>0</mn></msub><mo fence=true>)</mo></mrow><annotation encoding=application/x-tex>\left(b_{7}, b_{6}, b_{5}, b_{4}, b_{3}, b_{2}, b_{1}, b_{0}\right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span></span></span></span> 8位，对 S 盒中的每个字节中的每个位做如下变换：<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>b</mi><mi>i</mi><mo mathvariant=normal>′</mo></msubsup><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mo>⊕</mo><msub><mi>b</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo>+</mo><mn>4</mn><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mn>8</mn></mrow></msub><mo>⊕</mo><msub><mi>b</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo>+</mo><mn>5</mn><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mn>8</mn></mrow></msub><mo>⊕</mo><msub><mi>b</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo>+</mo><mn>6</mn><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mn>8</mn></mrow></msub><mo>⊕</mo><msub><mi>b</mi><mrow><mo stretchy=false>(</mo><mi>i</mi><mo>+</mo><mn>7</mn><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mn>8</mn></mrow></msub><mo>⊕</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>b_{i}^{\prime}=b_{i} \oplus b_{(i+4) \bmod 8} \oplus b_{(i+5) \bmod 8} \oplus b_{(i+6) \bmod 8} \oplus b_{(i+7) \bmod 8} \oplus c_{i}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.010556em;vertical-align:-.258664em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-2.441336em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.258664em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.04964em;vertical-align:-.3551999999999999em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.34480000000000005em><span style=top:-2.5198em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">4</span><span class="mclose mtight">)</span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mbin mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span></span></span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3551999999999999em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.04964em;vertical-align:-.3551999999999999em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.34480000000000005em><span style=top:-2.5198em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">5</span><span class="mclose mtight">)</span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mbin mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span></span></span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3551999999999999em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.04964em;vertical-align:-.3551999999999999em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.34480000000000005em><span style=top:-2.5198em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">6</span><span class="mclose mtight">)</span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mbin mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span></span></span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3551999999999999em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.04964em;vertical-align:-.3551999999999999em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.34480000000000005em><span style=top:-2.5198em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">7</span><span class="mclose mtight">)</span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mbin mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span></span></span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mord mtight">8</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3551999999999999em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p><p>其中，对于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mn>8</mn></mrow><annotation encoding=application/x-tex>0 \leq i&lt;8</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78041em;vertical-align:-.13597em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69862em;vertical-align:-.0391em></span><span class="mord mathdefault">i</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>8</span></span></span></span>，是字节的第 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span></span></span></span> 位，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>c_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 是值为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>{</mo><mn>63</mn><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>\{63\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>6</span><span class=mord>3</span><span class=mclose>}</span></span></span></span> 或 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>01100011</mn></mrow><annotation encoding=application/x-tex>{01100011}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord><span class=mord>0</span><span class=mord>1</span><span class=mord>1</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>1</span><span class=mord>1</span></span></span></span></span> 的字节 c 的第 i 位</p></li></ol><h3 id=行移位><a class=markdownIt-Anchor href=#行移位></a> 行移位</h3><ul><li>行移位变换完成基于行的循环移位操作，变换方法为：第0行不变，第1行循环左移1个字节，第2行循环左移两个字节，第3行循环左移3个字节</li></ul><h3 id=列混淆><a class=markdownIt-Anchor href=#列混淆></a> 列混淆</h3><ul><li>利用GF(28)域上算术特性的一个代替，同样用于提供算法的<strong>扩散性</strong></li><li>列混淆：左乘列混淆矩阵<ul><li>计算方式：<ol><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>∗</mo><mn>01</mn></mrow><annotation encoding=application/x-tex>x*01</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.46528em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>1</span></span></span></span>，为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 本身</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>∗</mo><mn>02</mn></mrow><annotation encoding=application/x-tex>x*02</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.46528em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>2</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 的二进制左移一位（右边补0），如果溢出（即如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 的二进制最高位为1），那么再异或上 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mi>B</mi></mrow><annotation encoding=application/x-tex>1B</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>1</span><span class="mord mathdefault" style=margin-right:.05017em>B</span></span></span></span></li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>∗</mo><mn>03</mn></mrow><annotation encoding=application/x-tex>x*03</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.46528em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>3</span></span></span></span>，结果为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>x</mi><mo>∗</mo><mn>02</mn><mo stretchy=false>)</mo><mi>X</mi><mi>O</mi><mi>R</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x*02)XOR(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>0</span><span class=mord>2</span><span class=mclose>)</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class="mord mathdefault" style=margin-right:.02778em>O</span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span></li></ol></li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mn>02</mn><mo>∗</mo><mn>87</mn></mrow><annotation encoding=application/x-tex>02 * 87</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>2</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>8</span><span class=mord>7</span></span></span></span>： <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>87</mn></mrow><annotation encoding=application/x-tex>87</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>8</span><span class=mord>7</span></span></span></span> 的二进制位 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>10000111</mn></mrow><annotation encoding=application/x-tex>1000 0111</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>1</span><span class=mord>1</span><span class=mord>1</span></span></span></span>，左移一位得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>00001110</mn></mrow><annotation encoding=application/x-tex>0000 1110</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>1</span><span class=mord>1</span><span class=mord>1</span><span class=mord>0</span></span></span></span>，因为本身的二进制最高位为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn></mrow><annotation encoding=application/x-tex>1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>，所以再异或 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mi>B</mi></mrow><annotation encoding=application/x-tex>1B</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>1</span><span class="mord mathdefault" style=margin-right:.05017em>B</span></span></span></span>，即 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mn>00001110</mn><mo stretchy=false>)</mo><mi>X</mi><mi>O</mi><mi>R</mi><mo stretchy=false>(</mo><mn>00011011</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(00001110) XOR (00011011)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>1</span><span class=mord>1</span><span class=mord>1</span><span class=mord>0</span><span class=mclose>)</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class="mord mathdefault" style=margin-right:.02778em>O</span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mopen>(</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>1</span><span class=mord>1</span><span class=mord>0</span><span class=mord>1</span><span class=mord>1</span><span class=mclose>)</span></span></span></span>，得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mn>00010101</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(00010101)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span><span class=mord>1</span><span class=mord>0</span><span class=mord>1</span><span class=mord>0</span><span class=mord>1</span><span class=mclose>)</span></span></span></span> 即：<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>15</mn></mrow><annotation encoding=application/x-tex>15</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mord>5</span></span></span></span></li></ul></li></ul><h3 id=轮密相加><a class=markdownIt-Anchor href=#轮密相加></a> 轮密相加</h3><ul><li>在轮密钥加中，128 位的 state 按位与 128 位的轮密钥 XOR</li></ul><h3 id=密钥扩展><a class=markdownIt-Anchor href=#密钥扩展></a> 密钥扩展</h3><div align=center><img src=/img/post/密码学备忘/AES密钥拓展.jpg style=zoom:47%></div><h2 id=分组加密的工作模式><a class=markdownIt-Anchor href=#分组加密的工作模式></a> 分组加密的工作模式</h2><p>问题引入：每次使用相同的密钥对多个分组加密，会引发许多安全问题</p><h3 id=工作模式简介><a class=markdownIt-Anchor href=#工作模式简介></a> 工作模式简介</h3><ul><li><p>工作模式：是一项增强密码算法或者使算法适应具体应用的技术，如将分组密码应用于数据块组成的序列或者数据流</p></li><li><p>初始化向量 IV：许多工作模式中用于随机化加密的一块数据，因此可以有相同的密文、相同的密钥产生不同的密文而无需重新产生密钥。<strong>一般无需保密</strong>。</p></li></ul><h4 id=电码本-ecb-模式><a class=markdownIt-Anchor href=#电码本-ecb-模式></a> 电码本 ECB 模式</h4><ul><li><p>ECB 模式是最简单的运行模式。</p><ul><li><p>直接利用加密算法分别对分组数据组加密</p></li><li><p>一次处理一组明文分块，每次使用相同的密钥加密</p></li></ul></li></ul><div align=center><img src=/img/post/密码学备忘/ECBen.png alt=ECBen style=zoom:80%></div><hr><div align=center><img src=/img/post/密码学备忘/ECBde.png alt=ECBde style=zoom:80%></div><ul><li><p>特点：<strong>在给定的密钥下，同一明文组总产生同样的密文组</strong></p></li><li><p>往往需填充</p></li><li><p>ECB 用于<strong>短数据</strong>（如加密密钥）时非常理想，因此如需安全传递DES、AES 等密钥，ECB是最合适的模式</p><ul><li>ECB 用于长消息时可能不够安全：如果消息有固定结构，密码分析者有可能找出这种关系。</li></ul></li></ul><h4 id=密文分组连接模式-cbc><a class=markdownIt-Anchor href=#密文分组连接模式-cbc></a> 密文分组连接模式 CBC</h4><ul><li><p>加密算法的输入是当前明文分组和前一次密文分组的异或</p></li><li><p>串行，不能并行化</p></li><li><p>明文有一组有错，以后的密文组都受影响</p><p>加密：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mi>n</mi></msub><mo>=</mo><msub><mi>E</mi><mi>K</mi></msub><mo stretchy=false>[</mo><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>P</mi><mi>n</mi></msub><mo stretchy=false>]</mo><mo separator=true>,</mo><msub><mi>C</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>I</mi><mi>V</mi></mrow><annotation encoding=application/x-tex>C_n=E_K[C_{n-1}\oplus P_n],C_{-1}=IV</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>]</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class="mord mathdefault" style=margin-right:.22222em>V</span></span></span></span></p></li></ul><div align=center><img src=/img/post/密码学备忘/CBCen.png alt=CBCen style=zoom:80%></div><hr><ul><li><p>解密时，每一个密文分组被解密后，再与前一个密文分组异或</p></li><li><p>两个邻接的密文块即可得到一个明文块，可以并行化（错误不传播）</p><p>解密：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>n</mi></msub><mo>=</mo><msub><mi>D</mi><mi>K</mi></msub><mo stretchy=false>[</mo><msub><mi>C</mi><mi>n</mi></msub><mo stretchy=false>]</mo><mo>⊕</mo><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>P_n=D_K[C_n]\oplus C_{n-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>]</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span></p></li></ul><div align=center><img src=/img/post/密码学备忘/CBCde.png alt=CBCde style=zoom:80%></div><ul><li>同样需要填充</li><li>IV 对于收发双方都应是已知的，为使安全性最高，IV 应像密钥一样被保护，可使用 ECB 加密模式来发送IV<ul><li>保护 IV 的原因：敌手篡改 IV 中的某些比特，则接收方收到的相应的比特也发生了变化</li></ul></li></ul><h4 id=密文反馈模式-cfb><a class=markdownIt-Anchor href=#密文反馈模式-cfb></a> 密文反馈模式 CFB</h4><ul><li><p>若待加密消息必须按字符(如电传电报)或按比特处理时，可采用CFB模式</p></li><li><p>利用 CFB 模式或 OFB 模式可将分组对称密码转换为流密码。流密码<strong>不需要对消息填充，而且运行是实时的</strong></p></li><li><p>流密码具有密文和明文一样长这一性质，因此，如果需要发送的每个字符长为 8 比特，就应使用 8 比特密钥来加密每个字符。如果密钥长超过 8比特，则造成浪费。</p></li><li><p>加密过程：</p></li></ul><ol><li><p>加密函数的输入是 b 位的移位寄存器，其初值为某个初始向量 IV。</p></li><li><p>输出最左边的 s 位与明文的第一个分段 P1 异或得到密文的第一个单元 C1，发送 C1 ；</p></li><li><p>移位寄存器左移 s 位，C1 填入移位寄存器的最右边 s 位；</p></li><li><p>直至所有明文单元被加密完</p></li></ol><ul><li>串行，不能并行化</li></ul><div align=center><img src=/img/post/密码学备忘/CFBen.png alt=CFBen style=zoom:80%></div><hr><ul><li>解密过程：</li></ul><ol><li><p>将收到的密文单元与加密函数的输出异或得到明文单元。</p></li><li><p>使用<strong>加密函数</strong>而非解密函数。</p></li><li><p>CFB 与 CBC 的区别是反馈的密文长度为 k ，且不是直接与明文相加，而是反馈至密钥产生器。</p></li></ol><ul><li>两个邻接的密文块即可得到一个明文块，可以并行化（错误不传播）</li></ul><div align=center><img src=/img/post/密码学备忘/CFBde.png alt=CFBde style=zoom:80%></div><ul><li><p>优点：</p><ul><li><p>适合数据以比特或字节为单位出现，适合加密数据流；</p></li><li><p>能隐蔽明文数据图样，也能检测出对手对于密文的篡改；</p></li><li><p>仅需要实现加密算法；</p></li><li><p>CFB模式除能获得保密性外，还能用于认证。</p></li></ul></li><li><p>缺点：</p><ul><li><p>对信道错误较敏感，错误传播：1个比特密文传输错误会传播约64/j 个分组</p></li><li><p>CFB也需要一个初始矢量，并要和密钥同时进行更换**。**</p></li></ul></li></ul><h4 id=输出反馈模式-ofb><a class=markdownIt-Anchor href=#输出反馈模式-ofb></a> 输出反馈模式 OFB</h4><ul><li>OFB 模式的结构类似于 CFB<ul><li>不同之处：OFB 模式是将加密算法的输出反馈到移位寄存器，而 CFB 模式中是将密文单元反馈到移位寄存器</li></ul></li></ul><div align=center><img src=/img/post/密码学备忘/OFBen.png alt=OFBen style=zoom:80%></div><hr><div align=center><img src=/img/post/密码学备忘/OFBde.png alt=OFBde style=zoom:80%></div><ul><li><p>OFB的特点：</p><ul><li><p>消息作为比特流，移位寄存器</p></li><li><p>分组加密的输出与被加密的消息相异或</p></li><li><p>只需要实现加密算法</p></li><li><p>不适合认证</p></li></ul></li><li><p>预处理加密输出分组之后可以并行</p></li><li><p>优点：传输过程中的比特错误不会被传播，</p></li><li><p>适合有扰信道，比如卫星等</p></li><li><p>缺点：</p><ul><li><p>比 CFB 模式更易受到对消息流的篡改攻击<br>如在密文中取1比特的补，那么在恢复的明文中相应位置的比特也 为原比特的补。因此使得敌手有可能通过对消息校验部分的篡改和对数据部分的篡改，而以纠错码不能检测的方式篡改密文。</p></li><li><p>不具有自同步能力，要求系统要保持严格的同步</p></li></ul></li></ul><h4 id=计数器模式-ctr><a class=markdownIt-Anchor href=#计数器模式-ctr></a> 计数器模式 CTR</h4><ul><li>CTR 模式：与 OFB 相似，CTR 将块密码变成流密码。它通过递增要给加密计数器已产生连续的密钥流</li><li>可并行</li></ul><h4 id=工作模式对比><a class=markdownIt-Anchor href=#工作模式对比></a> 工作模式对比</h4><table><thead><tr><th>模式</th><th>描述</th><th>用途</th></tr></thead><tbody><tr><td>电码本(ECB)模式</td><td>每个明文组独立地以同一密钥加密</td><td>传送短数据(如一个加密密钥)</td></tr><tr><td>密码分组链接(CBC)</td><td>加密算法的输入是当前明文组与前一密文组的异或</td><td>传送数据分组；认证</td></tr><tr><td>密码反馈(CFB)模式</td><td>每次只处理输入的 j 比特，将上一次的密文作加密算法的输入以产生伪随机输出，该输出再与当前明文异或以产生当前密文</td><td>传送数据流；认证</td></tr><tr><td>输出反馈(OFB)模式</td><td>与 CFB 类似不同之处是本次加密算法的输入为前一次加密算法的输出</td><td>噪声信道(如卫星通信)传送数据流</td></tr><tr><td>计数器(CTR)模式</td><td>对计数器依次用 k 加密后与明文异或</td><td>适合并行，可随机访问</td></tr></tbody></table><h2 id=伪随机数的产生和流密码><a class=markdownIt-Anchor href=#伪随机数的产生和流密码></a> 伪随机数的产生和流密码</h2><h3 id=随机数的使用><a class=markdownIt-Anchor href=#随机数的使用></a> 随机数的使用</h3><p>大量基于密码学的网络安全算法和协议都使用了二进制随机数，如：</p><ul><li><p>密钥分发和相互认证方案。如在密钥分配中，需使用时变值进行握手以防止重放攻击。时变值使用随机数可以防止攻击者判断或者猜测出时变值</p></li><li><p>会话密钥的产生。用随机数作为会话密钥</p></li><li><p>公钥密码算法中密钥的产生。用随机数作为公钥密码算法中的密钥，或以随机数来产生公钥密码算法中的密钥</p></li><li><p>用于对称流密码加密的位流的产生</p></li></ul><h3 id=随机数源><a class=markdownIt-Anchor href=#随机数源></a> 随机数源</h3><ul><li><p>真随机数：很难获得</p><ul><li>物理噪声产生器，如：离子辐射脉冲检测器、气体放电管、漏电容等</li><li>将高质量的随机数作为随机数库编辑成书</li></ul></li><li><p>伪随机数：使用算法来生成随机数。</p></li></ul><h3 id=随机数的产生要求><a class=markdownIt-Anchor href=#随机数的产生要求></a> 随机数的产生要求</h3><ul><li><p>随机性</p><p>以下两个准则常用来保障数列的随机性：</p><ol><li><p>分布均匀性：序列中的位分布应是均匀的，即0和1出现的频率大约相等；</p></li><li><p>独立性：序列中任何子序列不能由其他子序列推导出。</p></li></ol><ul><li>序列是否满足均匀分布可通过检测得出，而是否满足独立性则无法检测，相反却有很多检测方法能证明序列不满足独立性</li></ul></li><li><p>不可预测性</p><ul><li>在设计密码算法时，由于真随机数难以获得，经常使用似乎是随机的序列（这样的序列称为伪随机数序列，这样的随机数称为伪随机数</li></ul></li></ul><h4 id=对-prng-要求><a class=markdownIt-Anchor href=#对-prng-要求></a> 对 PRNG 要求</h4><ul><li><p>通用要求：输出保密性——不知道种子的敌手不能决定伪随机串</p></li><li><p>特定要求：随机性、不可预测性、种子的特性</p><ul><li><p>随机性：生成的位流尽管是确定的，但要显示随机。</p><ul><li>没有单个的测试可以判定一个PRNG生成的数据具有随机性；</li><li>NIST规定测试应建立三个特征：<ul><li>均匀性：在产生随机或伪随机位序列的任何点，0或1出现的量大约相等，即每个出现的概率恰好为1/2</li><li>可伸缩性：用于序列测试的任何测试也可以用于从序列中抽取的子序列的测试</li><li>一致性：对于所有初始值（种子），发生器的行为必须具有一致性</li></ul></li></ul></li><li><p>不可预测性</p><ul><li><p>前向不可预测性：如果不知道种子，那么不管知道序列中前面的多少位，都无法预测序列中的下一位；</p></li><li><p>后向不可预测性：从产生的任何值都不能推断出种子值</p></li></ul></li><li><p>种子的要求：安全、不可预测</p></li></ul></li></ul><h3 id=伪随机数发生器><a class=markdownIt-Anchor href=#伪随机数发生器></a> 伪随机数发生器</h3><h4 id=线性同余发生器><a class=markdownIt-Anchor href=#线性同余发生器></a> 线性同余发生器</h4><ul><li><p>线性同余法</p><ul><li><p>参数</p><ul><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 模数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>m&gt;0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span> <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup><mn>1</mn></mrow><annotation encoding=application/x-tex>2^31</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mord>1</span></span></span></span></p></li><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span></span></span></span> 乘数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><mi>m</mi></mrow><annotation encoding=application/x-tex>0&lt;a&lt;m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68354em;vertical-align:-.0391em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">a</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span></p></li><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span> 增量 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mo>≤</mo><mi>c</mi><mo>&lt;</mo><mi>m</mi></mrow><annotation encoding=application/x-tex>0\leq c&lt;m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78041em;vertical-align:-.13597em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span></p></li><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>X_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 种子 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>X</mi><mn>0</mn></msub><mo>&lt;</mo><mi>m</mi></mrow><annotation encoding=application/x-tex>0 \leq X_0&lt;m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78041em;vertical-align:-.13597em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span></p></li></ul></li><li><p>随机数序列 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mi>n</mi></msub></mrow><annotation encoding=application/x-tex>{X_n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></span> 按下面的迭代式获得：</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo stretchy=false>(</mo><mi>a</mi><msub><mi>X</mi><mi>n</mi></msub><mo>+</mo><mi>c</mi><mo stretchy=false>)</mo><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>m</mi><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>X_{n+1} = (aX_n+c) \pmod m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">c</span><span class=mclose>)</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span></p></li></ul></li><li><p>线性同余发生器：定义 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi><mrow><mo fence=true>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence=true>)</mo></mrow><mo>=</mo><mrow><mo fence=true>(</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>z</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><msub><mi>z</mi><mi>l</mi></msub><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>f\left(x_{0}\right)=\left(z_{1}, z_{2}, \ldots z_{l}\right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.04398em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.04398em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.04398em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mn>2</mn></mrow><annotation encoding=application/x-tex>z_{n}=x_{n} \bmod 2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.04398em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span></span></span></span>，称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi></mrow><annotation encoding=application/x-tex>f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span></span></span></span> 为一个 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>k</mi><mo separator=true>,</mo><mi>l</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(k,l)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class=mclose>)</span></span></span></span> 线性同余生成器</p><ul><li><p>评价线性同余算法的性能有以下3个标准：</p><ol><li>迭代函数应是全周期的，即函数在重复之前应产生0到<em>m</em>-1之间的所有数</li><li>产生的序列看上去应是随机的</li><li>迭代函数能有效地利用32位运算器方便的实现</li></ol></li><li><p>为使随机数数列的周期尽可能大，m应尽可能大，普遍原则是选 m 接近等于计算机能表示的最大整数</p></li><li><p>假定敌手能确定 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>X</mi><mn>3</mn></msub></mrow><annotation encoding=application/x-tex>X_0,X_1,X_2,X_3</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，就可通过以下方程组，</p><p>​ <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi mathvariant=normal>X</mi><mn>1</mn></msub><mo>=</mo><mrow><mo fence=true>(</mo><msub><mrow><mi mathvariant=normal>a</mi><mi mathvariant=normal>X</mi></mrow><mn>0</mn></msub><mo>+</mo><mi mathvariant=normal>c</mi><mo fence=true>)</mo></mrow><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mi mathvariant=normal>m</mi></mrow><annotation encoding=application/x-tex>\mathrm{X}_{1}=\left(\mathrm{aX}_{0}+\mathrm{c}\right) \mathrm{mod} \mathrm{m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class=mord><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class=mord><span class="mord mathrm">a</span><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathrm">c</span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span><span class=mord><span class="mord mathrm">m</span></span></span></span></span><br>​ <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi mathvariant=normal>X</mi><mn>2</mn></msub><mo>=</mo><mrow><mo fence=true>(</mo><msub><mrow><mi mathvariant=normal>a</mi><mi mathvariant=normal>X</mi></mrow><mn>1</mn></msub><mo>+</mo><mi mathvariant=normal>c</mi><mo fence=true>)</mo></mrow><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mi mathvariant=normal>m</mi></mrow><annotation encoding=application/x-tex>\mathrm{X}_{2}=\left(\mathrm{aX}_{1}+\mathrm{c}\right) \mathrm{mod} \mathrm{m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class=mord><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class=mord><span class="mord mathrm">a</span><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathrm">c</span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span><span class=mord><span class="mord mathrm">m</span></span></span></span></span><br>​ <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi mathvariant=normal>X</mi><mn>3</mn></msub><mo>=</mo><mrow><mo fence=true>(</mo><msub><mrow><mi mathvariant=normal>a</mi><mi mathvariant=normal>X</mi></mrow><mn>2</mn></msub><mo>+</mo><mi mathvariant=normal>c</mi><mo fence=true>)</mo></mrow><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mi mathvariant=normal>m</mi></mrow><annotation encoding=application/x-tex>\mathrm{X}_{3}=\left(\mathrm{aX}_{2}+\mathrm{c}\right) \mathrm{mod} \mathrm{m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class=mord><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class=mord><span class="mord mathrm">a</span><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathrm">c</span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span><span class=mord><span class="mord mathrm">m</span></span></span></span></span></p><p>解出 a，c 和 m。</p><p>※：改进的方法：利用<strong>内部系统时钟</strong>修正随机数数列</p><ol><li><p>每当产生N个数后，就利用当前的时钟值模m后作为种子</p></li><li><p>直接将当前的时钟值加到每个随机数上(模<em>m</em>加)</p></li></ol></li><li><p>常用变形</p><ul><li>幂形式：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi mathvariant=normal>X</mi><mrow><mi mathvariant=normal>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msup><mrow><mo fence=true>(</mo><msub><mi mathvariant=normal>X</mi><mi mathvariant=normal>n</mi></msub><mo fence=true>)</mo></mrow><mi mathvariant=normal>d</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi mathvariant=normal>m</mi><mo separator=true>,</mo><mspace width=1em><mi mathvariant=normal>n</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo></mspace></mrow><annotation encoding=application/x-tex>\mathrm{X}_{\mathrm{n}+1}=\left(\mathrm{X}_{\mathrm{n}}\right)^{\mathrm{d}} \bmod \mathrm{m}, \quad \mathrm{n}=1,2, \ldots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class=mord><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">n</span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.2390079999999999em;vertical-align:-.25em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class=mord><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">n</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9890079999999999em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">d</span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathrm">m</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathrm">n</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span></span></span></span></li><li>离散指数形式：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi mathvariant=normal>X</mi><mrow><mi mathvariant=normal>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msup><mi mathvariant=normal>g</mi><mrow><mi mathvariant=normal>X</mi><mi mathvariant=normal>n</mi></mrow></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi mathvariant=normal>m</mi><mo separator=true>,</mo><mspace width=1em><mi mathvariant=normal>n</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo></mspace></mrow><annotation encoding=application/x-tex>\mathrm{X}_{\mathrm{n}+1}=\mathrm{g}^{\mathrm{Xn}} \bmod \mathrm{m}, \quad \mathrm{n}=1,2, \ldots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class=mord><span class="mord mathrm">X</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">n</span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.035771em;vertical-align:-.19444em></span><span class=mord><span class=mord><span class="mord mathrm" style=margin-right:.01389em>g</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413309999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">X</span><span class="mord mathrm mtight">n</span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathrm">m</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathrm">n</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span></span></span></span></li></ul></li></ul></li></ul><h4 id=bbs-发生器><a class=markdownIt-Anchor href=#bbs-发生器></a> BBS 发生器</h4><ul><li><p><strong>已经证明过的密码强度最强的伪随机数产生器</strong>，</p></li><li><p>整个过程如下：</p></li></ul><ol><li><p>选：选择两个大素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo separator=true>,</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>p,q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>，满足 p\equivq\equiv3 \bmod 4。</p></li><li><p>算：计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>n=p×q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>。</p></li><li><p>选：选一随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> ，使得 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 互素。</p></li><li><p>算：按以下算法产生比特序列 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>{</mo><msub><mi>B</mi><mi>i</mi></msub><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>\{B_i\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>}</span></span></span></span>：</p><p>​$$\mathrm{X}<em>{0}=\mathrm{s}^{2} \bmod \mathrm{n}\<br>for\quad i=1 \quad to \quad\infty \quad do{\<br>\quad\begin{array}{l}<br>X</em>{i}=X^{2}<em>{i-1} \bmod n \<br>\left.B</em>{i}=X_{i} \bmod 2\right}<br>\end{array}$$<br>即在每次循环中取Xi的最低有效位</p></li></ol><ul><li>如果伪随机比特产生器能通过下一比特检验，则称为密码安全伪随机比特产生器<ul><li>即以伪随机比特产生器的输出序列的前 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个比特作为输入，如果不存在多项式时间算法，能以大于1/2的概率预测第 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>k+1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 个比特。</li></ul></li></ul><h4 id=使用分组密码的伪随机数产生><a class=markdownIt-Anchor href=#使用分组密码的伪随机数产生></a> 使用分组密码的伪随机数产生</h4><ul><li><p>推荐：CTR模式和OFB模式</p></li><li><p>使用分组密码工作模式的 PRNG</p></li><li><p>ANSI X9.17 伪随机数产生器</p><ul><li>密码强度最高的伪随机数产生器之一</li><li>组成部分<ul><li>输入：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>D</mi><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>DT_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 表示当前的日期和时间 ；Vi是产生第 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span></span></span></span> 个随机数时的种子</li><li>密钥: <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>K</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>K_1,K_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></li><li>输出：一个64比特的伪随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>R_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，一个64比特的新种子 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>V</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>V_{i+1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span>，</li></ul></li></ul></li></ul><div align=center><img src="/img/post/密码学备忘/ANSI X9.png" srcset="/img/loading.gif" lazyload alt="ANSI X9.17 伪随机数产生器" style=zoom:33%></div><h3 id=流密码><a class=markdownIt-Anchor href=#流密码></a> 流密码</h3><h4 id=流密码的概念><a class=markdownIt-Anchor href=#流密码的概念></a> 流密码的概念</h4><div align=center><img src=/img/post/密码学备忘/流密码.png alt=流密码 style=zoom:67%></div><p>加密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>=</mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>E</mi><msub><mi>k</mi><mn>0</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mn>0</mn></msub><mo stretchy=false>)</mo><msub><mi>E</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=false>)</mo><msub><mi>E</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo>…</mo></mrow><annotation encoding=application/x-tex>c=E_k(m)=E_{k_{0}}(m_0)E_{k_{1}}(m_1)E_{k_{2}}(m_2)\dots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span></span></span></span></p><p>解密算法：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><msub><mi>D</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>c</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>D</mi><msub><mi>k</mi><mn>0</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>c</mi><mn>0</mn></msub><mo stretchy=false>)</mo><msub><mi>D</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>c</mi><mn>1</mn></msub><mo stretchy=false>)</mo><msub><mi>D</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo stretchy=false>(</mo><msub><mi>c</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo>…</mo></mrow><annotation encoding=application/x-tex>m=D_k(c)=D_{k_0}(c_0)D_{k_1}(c_1)D_{k_2}(c_2)\dots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">c</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.03148em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span></span></span></span></p><ul><li><p>在使用的流密码中，加密变换通常采用二元加法运算。即：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msub><mi>m</mi><mi>i</mi></msub><mo>⊕</mo><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>c_i=m_i\oplus k_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p></li><li><p>由于一次一密的传输和存储麻烦，所以可行改进的办法是，用一个较小的密钥伪随机产生一个密钥流（从无条件安全变成了计算上安全）</p><ul><li>密钥发生器：驱动部分（统计特性好序列）和非线性组合部分（密码学特性好序列）</li></ul></li></ul><h4 id=流密码分类><a class=markdownIt-Anchor href=#流密码分类></a> 流密码分类</h4><ul><li>根据 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>σ</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>σ_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 与明文信息的关系，流密码可以分为同步流密码和自同步流密码两类</li></ul><h5 id=同步流密码><a class=markdownIt-Anchor href=#同步流密码></a> 同步流密码</h5><ul><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>σ</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>σ_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> <strong>独立于明文字符</strong>的叫做同步流密码。</p></li><li><p>对明文而言，同步流密码的加密变换无记忆；解密要求密钥流与加密密钥严格同步</p></li></ul><div align=center><img src=/img/post/密码学备忘/同步流密码.png alt=同步流密码 style=zoom:67%></div><ul><li><p>特性</p><ul><li><p>只要通信双方的密钥序列产生器具有相同的“种子序列”和相同的“初始状态”,就能产生相同的密钥序列.</p></li><li><p>容易检测插入、删除、重播等主动攻击.</p></li><li><p>没有差错传播.</p></li></ul></li></ul><h5 id=自同步流密码><a class=markdownIt-Anchor href=#自同步流密码></a> 自同步流密码</h5><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>σ</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>σ_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 与明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>m_1,m_2,\dots,m_{i-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.638891em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span> 有关，称为自同步流密码</li></ul><div align=center><img src=/img/post/密码学备忘/自同步流密码.png alt=自同步流密码 style=zoom:40%></div><ul><li><p>特性</p><ul><li><p>密钥流生成器是一种有记忆变换器，密钥流与明文符号有关：</p><ul><li>i 时刻的密文不仅取决于 i 时刻的明文，且与 i 时刻之前的 l 个明文符号有关；</li></ul></li><li><p>具有有限的差错传播；</p></li><li><p>具有自同步能力；</p></li><li><p>把明文每个字符扩散在密文多个字符中,强化了抗统计分析的能力</p></li></ul></li></ul><h4 id=线性移位寄存器><a class=markdownIt-Anchor href=#线性移位寄存器></a> 线性移位寄存器</h4><ul><li><p>反馈移存器是序列密码设计中常用乱源。</p></li><li><p>目的：以种子密钥为序列的初态，按照确定的递推关系，产生一个周期长、线性复杂度高、统计特性好的初始乱源，然后利用非线性函数、有记忆变换等密码变换，最终产生抗破译能力强的乱数序列。</p></li><li><p>线性移位寄存器序列是构造密钥流序列的基础。</p></li></ul><h5 id=反馈移位寄存器><a class=markdownIt-Anchor href=#反馈移位寄存器></a> 反馈移位寄存器</h5><ul><li>一个反馈移位寄存器由两部分组成：移位寄存器和反馈函数，其抽象的简单逻辑框图如下图所示。</li></ul><div align=center><img src=/img/post/密码学备忘/反馈移存器.png alt=反馈移存器 style=zoom:40%></div><ul><li><p>称这一函数为该组合门电路的反馈逻辑函数，表示为：</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mrow><mi>r</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>⋯</mo><mo separator=true>,</mo><msub><mi>x</mi><mi>r</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x_{r+1}=f(x_1,x_2,⋯,x_r)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.638891em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>，函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi></mrow><annotation encoding=application/x-tex>f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span></span></span></span> 是一个含有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span> 个逻辑变元的布尔函数</p></li><li><p>若反馈移存器的反馈逻辑函数是线性函数，则称该反馈移存器为线性反馈移存器，否则称为非线性反馈移存器</p><ul><li><p>如果反馈函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>⋯</mo><mo separator=true>,</mo><msub><mi>x</mi><mi>r</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>f(x_1,x_2,⋯,x_r)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 个变量的线性函数:</p><p>​ <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mrow><mi>r</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=true>,</mo><mo>⋯</mo><mo separator=true>,</mo><msub><mi>x</mi><mi>r</mi></msub><mo stretchy=false>)</mo><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>c</mi><mi>n</mi></msub><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=false>(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo stretchy=false>}</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x_{r+1}=f(x_1,x_2,⋯,x_r)=c_1x_n+c_2x_{n-1}+\cdots+c_nx_1 (c_i\in\{0,1\})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.638891em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.791661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mclose>}</span><span class=mclose>)</span></span></span></span></p><p>则称为线性反馈移位寄存器(LFSR: linear feedback shift register)。</p><p>输出的序列称为线性反馈移位寄存器序列, 记为LFSR序列。</p><ul><li><p>递推关系式：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>a</mi><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>a</mi><mrow><mi>n</mi><mo>+</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>a</mi><mrow><mi>n</mi><mo>+</mo><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>c</mi><mi>n</mi></msub><msub><mi>a</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>k</mi><mo>≥</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>a_{n+k}=c_1 a_{n+k-1}+c_2 a_{n+k-2}+⋯+c_n a_k (k≥n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.638891em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.791661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.791661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≥</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></p></li><li><p>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>c</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>c_n=0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span>，则称LFSR是退化的；否则称 LFSR 是非退化的。</p></li><li><p>把多项式：</p><p>​ <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>c</mi><mi>n</mi></msub><msup><mi>x</mi><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>f(x)=1+c_1x+c_2x^2+\cdots+c_nx^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.964108em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.814392em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></p><p>称为 LFSR 的特征多项式(characteristic polynomial), 或级连多项式或生成多项式</p></li></ul></li></ul></li><li><p>反馈移存器工作原理</p><ul><li><p>反馈移存器的功能完全由其反馈逻辑函数来决定</p></li><li><p>移存器受时钟脉冲控制，在某一时刻各级都有一个确定的值，把此时刻各级的值称为移存器的一个内部状态</p></li></ul></li><li><p>序列和周期</p><ul><li><p>对于序列 <span class=katex><span class=katex-mathml><math><semantics><mrow><munder accentunder=true><mi>a</mi><mo stretchy=true>‾</mo></munder><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>a</mi><mi>i</mi></msub><mo>⋯</mo></mrow><annotation encoding=application/x-tex>\underline{a}=a_0 a_1 a_2⋯a_i⋯</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.63056em;vertical-align:-.19999999999999996em></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.43056000000000005em><span style=top:-2.84em><span class=pstrut style=height:3em></span><span class=underline-line style=border-bottom-width:.04em></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19999999999999996em><span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span></span></span></span>，若存在整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 使得对任意整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>=</mo><msub><mi>a</mi><mrow><mi>k</mi><mo>+</mo><mi>p</mi></mrow></msub></mrow><annotation encoding=application/x-tex>a_k=a_{k+p}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.716668em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 成立，称满足该式的最小正整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 为序列的周期。</p></li><li><p>最长周期: <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>r</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>2^r-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.747722em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> ，能达到最长周期的线性移存器序列称为 m 序列</p></li></ul></li><li><p>线性移存器表示方法</p><ul><li>一个 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span> 级线性移存器的线性递推式表示为：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>⊕</mo><mo>⋯</mo><mo>⊕</mo><msub><mi>c</mi><mi>r</mi></msub><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mi>r</mi></mrow></msub><mo stretchy=false>(</mo><mi>n</mi><mo>≥</mo><mi>r</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>a_n=c_1 a_{n-1}\oplus c_2 a_{n-2}\oplus \dots\oplus c_ra_{n-r}(n\geq r)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.791661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.791661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.25833100000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≥</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mclose>)</span></span></span></span></li></ul></li></ul><h4 id=流密码算法><a class=markdownIt-Anchor href=#流密码算法></a> 流密码算法</h4><h5 id=rc4-算法><a class=markdownIt-Anchor href=#rc4-算法></a> RC4 算法</h5><ul><li><p>RC4是由Rivest于1987年开发的一种序列密码，它已被广泛应用于Windows、 Lotus Notes和其它软件，还被用于安全套接字(SSL)和无线通信系统等；</p></li><li><p>RC4优点是算法简单、高效，特别适于软件实现，加密速度比DES大约快10倍。</p></li><li><p>RC4可以支持不同密钥长度，美国政府特别限定，用于出口的RC4的密钥长度不得超过40位。</p></li><li><p>算法步骤</p><ul><li><p>RC4 使用了一个 28 字节大小的非线性数据表(简称 S表)，S 表的值 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>S</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>S</mi><mn>255</mn></msub></mrow><annotation encoding=application/x-tex>S_0,S_1,…,S_{255}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">5</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 是数字 0 到 255 的一个排列。对 S 表进行非线性变换，得到密钥流。</p></li><li><p>RC4对S表的初始化算法(两个计数器 I 和 J, I =0 , J=0)</p><ol><li><p>对S表进行线性填充：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>I</mi></msub><mo>=</mo><mi>I</mi><mo separator=true>,</mo><mn>0</mn><mo>≤</mo><mi>I</mi><mo>&lt;</mo><mn>255</mn></mrow><annotation encoding=application/x-tex>S_I=I, 0≤I&lt;255</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07847em>I</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72243em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.07847em>I</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span><span class=mord>5</span><span class=mord>5</span></span></span></span>；</p></li><li><p>用密钥填充另一个 256 字节的数组 K，如果密钥长度小于256字节，则依次重复填充，直至填满这个数组中：<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>K</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>K</mi><mn>255</mn></msub></mrow><annotation encoding=application/x-tex>K_0, K_1,…, K_{255}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">5</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；</p></li><li><p>对于 I=0 到 255 重复以下步骤：</p><p>(1) <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>J</mi><mo>=</mo><mi>J</mi><mo>+</mo><msub><mi>S</mi><mi>I</mi></msub><mo>+</mo><msub><mi>K</mi><mi>I</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mn>256</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>J=J+S_I+K_I(mod 256)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.09618em>J</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.09618em>J</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07847em>I</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07847em>I</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class=mord>2</span><span class=mord>5</span><span class=mord>6</span><span class=mclose>)</span></span></span></span>；</p><p>(2) 交换 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>I</mi></msub></mrow><annotation encoding=application/x-tex>S_I</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07847em>I</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mi>J</mi></msub></mrow><annotation encoding=application/x-tex>S_J</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.09618em>J</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 。</p></li></ol></li><li><p>将 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi></mrow><annotation encoding=application/x-tex>S</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span></span> 和明文进行 xor 运算，得到密文</p></li></ul></li></ul><h2 id=公钥密码原理><a class=markdownIt-Anchor href=#公钥密码原理></a> 公钥密码原理</h2><h3 id=为什么引入公钥密码体制><a class=markdownIt-Anchor href=#为什么引入公钥密码体制></a> 为什么引入公钥密码体制？</h3><h4 id=对称密码体制的问题><a class=markdownIt-Anchor href=#对称密码体制的问题></a> 对称密码体制的问题</h4><ul><li>密钥分配问题</li><li>密钥传输问题：传输信道安全性并不理想</li><li>密钥管理问题：需管理的密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>C</mi><mi>n</mi><mn>2</mn></msubsup></mrow><annotation encoding=application/x-tex>C_n^2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.061108em;vertical-align:-.247em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span>，加入一个用户，产生 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 个密钥</li><li><strong>没有签名功能</strong></li></ul><p>※ 根源：对称密码的加密密钥与解密密钥相同</p><h4 id=解决方法><a class=markdownIt-Anchor href=#解决方法></a> 解决方法</h4><ul><li>将密钥分为加密密钥和解密密钥</li><li>加密密钥公开，解密密钥保密</li></ul><table><thead><tr><th>问题描述</th><th><strong>公钥密码体制完美解决</strong></th></tr></thead><tbody><tr><td>密钥分配</td><td>无需密钥的秘密分配。</td></tr><tr><td>密钥管理</td><td>每个用户需秘密保存1个私钥；网络中需要管理的密钥数目为n对。新用户加入时，系统只需产生1对公私钥对。</td></tr><tr><td>签名功能</td><td>提供了数字签名功能。</td></tr></tbody></table><h3 id=什么是公钥密码体制><a class=markdownIt-Anchor href=#什么是公钥密码体制></a> 什么是公钥密码体制？</h3><h4 id=公钥密码体制的原理><a class=markdownIt-Anchor href=#公钥密码体制的原理></a> 公钥密码体制的原理</h4><ul><li>公钥体制：每个用户都有一对选定的密钥(公钥k1；私钥k2)，公开的密钥k1可以像电话号码一样进行注册公布</li><li>主要特点：<ul><li>加密和解密能力分开</li><li>多个用户加密的消息只能由一个用户解读（用于公共网络中实现保密通信）</li><li>只能由一个用户加密消息而使多个用户可以解读（可用于认证系统中对消息进行数字签字）</li><li>无需事先分配密钥</li></ul></li></ul><h4 id=公钥密码体制概述><a class=markdownIt-Anchor href=#公钥密码体制概述></a> 公钥密码体制概述</h4><ul><li>公钥密码体制是密码学研究的一个具有里程碑意义的重要事件。</li><li>公钥密码技术又称为双钥密码或非对称密码技术。</li><li>1976年由Diffie和Hellman在其《密码学新方向》一文中首次提出<strong>公钥密码思想</strong></li></ul><h4 id=公钥密码体制组成><a class=markdownIt-Anchor href=#公钥密码体制组成></a> 公钥密码体制组成</h4><ul><li>公钥密码体制有6个组成部分：<ul><li>明文：算法的输入；</li><li>密文：算法的输出；</li><li>公钥和私钥：算法的输入；</li><li>加密算法：对明文进行各种变换；</li><li>解密算法：接收密文和相应的密钥，并产生原始的明文。</li></ul></li></ul><div align=center><img src=/img/post/密码学备忘/公钥密码体制.png alt=公钥密码体制 style=zoom:43%></div><h4 id=公钥密码体制功能><a class=markdownIt-Anchor href=#公钥密码体制功能></a> 公钥密码体制功能</h4><ul><li>公钥密码体制的主要特点是将加密和解密能力分开，因而可以实现多个用户加密的信息只能由一个用户解读，或由一个用户加密的信息而多个用户可以解读。<ul><li>前者可以用于公共网络中实现<strong>通信保密</strong>，而后者可以用于实现对用户的<strong>认证</strong>。</li></ul></li></ul><h4 id=公钥体制加-解密安全保障><a class=markdownIt-Anchor href=#公钥体制加-解密安全保障></a> 公钥体制加、解密安全保障</h4><h5 id=用公钥密码实现保密><a class=markdownIt-Anchor href=#用公钥密码实现保密></a> 用公钥密码实现保密</h5><ul><li>用户 B 拥有自己的密钥对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>e</mi><mi>B</mi></msub><mo separator=true>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(e_B,d_B)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><ul><li>公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>e</mi><mi>B</mi></msub></mrow><annotation encoding=application/x-tex>e_B</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 公开,私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>d</mi><mi>B</mi></msub></mrow><annotation encoding=application/x-tex>d_B</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 保密</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi><mo>:</mo><mi>Y</mi><mo>=</mo><msub><mi>E</mi><msub><mi>e</mi><mi>B</mi></msub></msub><mo stretchy=false>(</mo><mi>X</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>A→ B: Y=E_{e_{B}}(X)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>→</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.000305em;vertical-align:-.250305em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139199999999997em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mclose>)</span></span></span></span>（公钥加密）</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>B</mi><mo>:</mo><msub><mi>D</mi><msub><mi>d</mi><mi>B</mi></msub></msub><mo stretchy=false>(</mo><mi>Y</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>D</mi><msub><mi>d</mi><mi>B</mi></msub></msub><mo stretchy=false>(</mo><msub><mi>E</mi><msub><mi>e</mi><mi>B</mi></msub></msub><mo stretchy=false>(</mo><mi>X</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mi>X</mi></mrow><annotation encoding=application/x-tex>B: D_{d_{B}}(Y)=D_{d_{B}}(E_{e_{B}}(X))=X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.000305em;vertical-align:-.250305em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.000305em;vertical-align:-.250305em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139199999999997em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>X</span></span></span></span>（私钥解密）</li></ul></li></ul><p>从公开钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><msub><mi>K</mi><mi>B</mi></msub></mrow><annotation encoding=application/x-tex>PK_{B}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span> 要推出明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 或解密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><msub><mi>K</mi><mi>B</mi></msub></mrow><annotation encoding=application/x-tex>SK_{B}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 计算上不可行。<br>由于任一用户都可用用户 B 的公开钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><msub><mi>K</mi><mi>B</mi></msub></mrow><annotation encoding=application/x-tex>PK_{B}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 向他发送机密消息，因而密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span> 不具有认证性。</p><h5 id=用公钥密码实现认证><a class=markdownIt-Anchor href=#用公钥密码实现认证></a> 用公钥密码实现认证</h5><ul><li>条件: <strong>两个密钥中任何一个都可以用作加密而另一个用作解密</strong></li><li>认证:<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>A</mi><mi>L</mi><mi>L</mi><mo>:</mo><mi>Y</mi><mo>=</mo><msub><mi>E</mi><msub><mi>d</mi><mi>A</mi></msub></msub><mo stretchy=false>(</mo><mi>X</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>A→ALL: Y=E_{d_{A}}(X)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>→</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">A</span><span class="mord mathdefault">L</span><span class="mord mathdefault">L</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.000305em;vertical-align:-.250305em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mclose>)</span></span></span></span>（A用私钥签名）<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>A</mi><mi>L</mi><mi>L</mi><mo>:</mo><msub><mi>E</mi><msub><mi>e</mi><mi>A</mi></msub></msub><mo stretchy=false>(</mo><mi>Y</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>D</mi><msub><mi>e</mi><mi>A</mi></msub></msub><mo stretchy=false>(</mo><msub><mi>E</mi><msub><mi>d</mi><mi>A</mi></msub></msub><mo stretchy=false>(</mo><mi>X</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mi>X</mi></mrow><annotation encoding=application/x-tex>ALL: E_{e_{A}}(Y)= D_{e_{A}} (E_{d_{A}} (X))=X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">A</span><span class="mord mathdefault">L</span><span class="mord mathdefault">L</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.000305em;vertical-align:-.250305em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139199999999997em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.000305em;vertical-align:-.250305em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139199999999997em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>X</span></span></span></span>（用A的公钥认证）</li></ul><p>由于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><msub><mi>k</mi><mi>A</mi></msub></mrow><annotation encoding=application/x-tex>Sk_A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 是保密的，其他人都不可能伪造密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span> ，可用 A 的公开钥解密时得到有意义的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 。因此可以验证消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 来自 A 而不是其他人，而实现了对 A 所发消息的认证。</p><h5 id=公钥保密和认证体制><a class=markdownIt-Anchor href=#公钥保密和认证体制></a> 公钥保密和认证体制</h5><ul><li><p>认证+保密:</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi><mo>:</mo><mi>Z</mi><mo>=</mo><msub><mi>E</mi><msub><mi>e</mi><mi>B</mi></msub></msub><mo stretchy=false>(</mo><msub><mi>E</mi><msub><mi>d</mi><mi>A</mi></msub></msub><mo stretchy=false>(</mo><mi>X</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>A→B: Z= E_{e_{B}}(E_{d_{A}}(X))</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>→</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.000305em;vertical-align:-.250305em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139199999999997em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mclose>)</span><span class=mclose>)</span></span></span></span></p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>B</mi><mo>:</mo><msub><mi>D</mi><msub><mi>e</mi><mi>A</mi></msub></msub><mo stretchy=false>(</mo><msub><mi>D</mi><msub><mi>d</mi><mi>B</mi></msub></msub><mo stretchy=false>(</mo><mi>Z</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mi>X</mi></mrow><annotation encoding=application/x-tex>B: D_{e_{A}}(D_{d_{B}}(Z))=X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.000305em;vertical-align:-.250305em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139199999999997em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05017em>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.250305em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mclose>)</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>X</span></span></span></span></p></li></ul><div align=center><img src=/img/post/密码学备忘/公钥保密和认证体制.png alt=公钥保密和认证体制 style=zoom:50%></div><h4 id=公钥密钥的应用范围><a class=markdownIt-Anchor href=#公钥密钥的应用范围></a> 公钥密钥的应用范围</h4><table><thead><tr><th><strong>算法</strong></th><th>加/解密</th><th><strong>数字签名</strong></th><th><strong>密钥交换</strong></th></tr></thead><tbody><tr><td>RSA</td><td>是</td><td>是</td><td>是</td></tr><tr><td>Dieffie-Hellman</td><td>否</td><td>否</td><td>是</td></tr><tr><td>DSS</td><td>否</td><td>是</td><td>否</td></tr></tbody></table><h4 id=公钥密码应满足的要求><a class=markdownIt-Anchor href=#公钥密码应满足的要求></a> 公钥密码应满足的要求</h4><ul><li><p>公钥密码应满足的要求</p><ul><li><p>涉及到各方：发送方、接收方、攻击者</p></li><li><p>涉及到数据：公钥、私钥、明文、密文</p></li></ul></li><li><p>公钥算法的条件：</p><ul><li>对于接收者：产生一对密钥是计算可行的</li><li>对于发送者：已知公钥和明文，产生密文是计算可行的</li><li>对于接收者：接收方利用私钥来解密密文是计算可行的</li><li>对于攻击者：利用公钥来推断私钥是计算不可行的</li><li>对于攻击者：已知公钥和密文，恢复明文是计算不可行的</li></ul></li></ul><div align=center><img src=/img/post/密码学备忘/公钥密码体制的设计.png alt=公钥密码体制的设计 style=zoom:50%></div><h3 id=如何设计公钥密码体制><a class=markdownIt-Anchor href=#如何设计公钥密码体制></a> 如何设计公钥密码体制？</h3><h4 id=第一步转化设计公钥密码体制变成了寻找陷门单向函数><a class=markdownIt-Anchor href=#第一步转化设计公钥密码体制变成了寻找陷门单向函数></a> 第一步转化：设计公钥密码体制变成了寻找陷门单向函数</h4><ul><li>单向陷门函数是满足下列条件的函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi></mrow><annotation encoding=application/x-tex>f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span></span></span></span>：<br>(1) 计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>y=f(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 是容易的；<br>(2) 给定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span>, 计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 使 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>y=f(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 是困难的；<br>(3) 存在 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>δ</mi></mrow><annotation encoding=application/x-tex>δ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03785em>δ</span></span></span></span> ，已知 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>δ</mi></mrow><annotation encoding=application/x-tex>δ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03785em>δ</span></span></span></span> 时，对给定的任何 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span>，若相应的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 存在，则计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 使 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>y=f(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 是容易的。<br>仅满足(1)、(2)两条的称为单向函数，<strong>单向函数不能用于加密</strong><br>第(3)条称为陷门性，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>δ</mi></mrow><annotation encoding=application/x-tex>δ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03785em>δ</span></span></span></span> 称为陷门信息。</li></ul><h4 id=第二步转化如何在求解np完全问题中设置合理后门><a class=markdownIt-Anchor href=#第二步转化如何在求解np完全问题中设置合理后门></a> 第二步转化：如何在求解NP完全问题中设置合理“后门”</h4><p>由于利用目前现有的技术无法在多项式时间里对NP完全问题进行求解，公钥密码思想的首创者 Diffie 和 Hellmen 在其研究中指出：<br><strong>计算复杂性可以被用作设计加密算法的基础，NP完全问题则是一个理想的解决途径！</strong></p><ul><li><p>信息通过编码被加密在一个 NP 完全问题之中，使得要破译这种密码以普通的方法就要解这个 NP 完全问题；<br>若使用解密密钥，就可能有捷径求解。</p><ul><li>为构造这样的密码，陷门信息必须被嵌在一个计算困难问题中。</li></ul></li><li><p>并非所有困难问题都可用于设计公钥密码系统。通过检验，已找到的可提供单向函数的数学难题包括：</p><ul><li><strong>整数分解问题(简称IFP)</strong></li><li><strong>有限域离散对数问题(简称DLP)</strong></li><li><strong>椭圆曲线离散对数问题(简称ECDLP)</strong></li></ul></li><li><p>基本思想：</p><ol><li>选择一个容易求解的子集和问题实例，伪装成一个很难求解的一般子集和问题实例；</li><li>容易求解的子集和问题实例用作私钥；</li><li>不易求解的子集和问题实例用作公钥。</li></ol></li></ul><p>※： <strong>举例：如何使用背包问题构造背包密码体制</strong></p><p>已知一长度为 B 的背包，及长度分别为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator=true>,</mo><mi mathvariant=normal>.</mi><mi mathvariant=normal>.</mi><mi mathvariant=normal>.</mi><mo separator=true>,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding=application/x-tex>a_1,...,a_n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>.</span><span class=mord>.</span><span class=mord>.</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的 n 个物品。假定这些物品的半径和背包相同，若从这 n 个物品中选出若干个正好装满这个背包。现在反过来问：究竟是哪些物品？</p><ul><li><p>等价于求 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mi mathvariant=normal>或</mi><mn>1</mn></mrow><annotation encoding=application/x-tex>x_i= 0 或 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class="mord cjk_fallback">或</span><span class=mord>1</span></span></span></span>，使其满足：<span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>\sum_{i=1}^{n} a_{i} x_{i}=b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.104002em;vertical-align:-.29971000000000003em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:-.0000050000000000050004em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-2.40029em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.29971000000000003em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span> ，其中 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>a_{1}, \dots, a_{n},</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span></span></span></span> <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span> 都是整数。</p></li><li><p>背包问题属于NP完备类(NP问题中难度最大的一类)，对这类问题没有有效算法。但是，如果序列 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding=application/x-tex>a_{1}, \dots, a_{n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 是超递增序列，则背包问题有多项式解法。</p></li><li><p>对于背包问题进行如下定义：<br>背包向量：<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(a_{1}, \dots, a_{n})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>，<br>选择向量：长度为 n 的比特串。<br>超递增背包向量：<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(a_{1}, \dots, a_{n})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 超递增序列。<br>已知背包向量和选择向量，可得到背包的容积：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi></mrow><annotation encoding=application/x-tex>f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span></span></span></span>(背包向量，选择向量)=容积<br>已知容积和背包向量，很难求出选择向量；<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>f</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><mtext>背包向量，容积</mtext><mo stretchy=false>)</mo><mo>↛</mo><mtext>选择向量</mtext></mrow><annotation encoding=application/x-tex>f^{-1}(\text{背包向量，容积}) \nrightarrow \text{选择向量}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord text"><span class="mord cjk_fallback">背包向量，容积</span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mrel amsrm">↛</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class="mord cjk_fallback">选择向量</span></span></span></span></span><br>已知超递增背包向量和容积，易求选择向量：<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>f</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><mtext>超递增背包向量，容积</mtext><mo stretchy=false>)</mo><mo>=</mo><mtext>选择向量</mtext></mrow><annotation encoding=application/x-tex>f^{-1} (\text{超递增背包向量，容积})=\text{选择向量}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord text"><span class="mord cjk_fallback">超递增背包向量，容积</span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord text"><span class="mord cjk_fallback">选择向量</span></span></span></span></span></p><ul><li>对应公钥密码体制，设置：<br>明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 为选择向量，密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span> 为容积，公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>Pk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 为背包向量，私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mi>k</mi></mrow><annotation encoding=application/x-tex>Sk</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 为超递增背包向量。</li></ul></li></ul><h2 id=rsa-公钥密码体制><a class=markdownIt-Anchor href=#rsa-公钥密码体制></a> RSA 公钥密码体制</h2><h3 id=算法背景><a class=markdownIt-Anchor href=#算法背景></a> 算法背景</h3><ul><li><p>该算法的数学基础是初等数论中的<strong>Euler(欧拉)定理</strong>，并建立在<strong>大整数因子分解</strong>的困难性之上，目前还不存在一般性的有效解决算法。</p></li><li><p>大整数的分解问题可以被表述：<strong>已知整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 是两个素数的积，即 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mi>q</mi></mrow><annotation encoding=application/x-tex>n=pq</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 。求解 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo separator=true>,</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>p,q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 的值。</strong></p></li><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 互素，则由 Euler 定理得：</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mrow><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow></msup><mo>≡</mo><mn>1</mn><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>m^{\varphi(n)} \equiv 1 \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8879999999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mrow><mi>k</mi><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow></msup><mo>≡</mo><mn>1</mn><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>m^{k \varphi(n)} \equiv 1 \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8879999999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mord mathdefault mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mrow><mi>k</mi><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>+</mo><mn>1</mn></mrow></msup><mo>≡</mo><mi>m</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>m^{k \varphi(n)+1} \equiv m \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8879999999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mord mathdefault mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span><br>即 <span class=katex><span class=katex-mathml><math><semantics><mrow><mspace width=1em><msup><mi>c</mi><mi>d</mi></msup><mo>≡</mo><mi>m</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mspace></mrow><annotation encoding=application/x-tex>\quad c^{d} \equiv m \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.849108em;vertical-align:0></span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathdefault">c</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mrow><mi mathvariant=normal>e</mi><mi mathvariant=normal>d</mi></mrow></msup><mo>≡</mo><mi>m</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi mathvariant=normal>n</mi></mrow><annotation encoding=application/x-tex>m^{\mathrm{ed}} \equiv m \bmod \mathrm{n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.849108em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight">d</span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=mord><span class="mord mathrm">n</span></span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi><mi>d</mi><mo>=</mo><mi>k</mi><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>ed=k \varphi(n)+1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mrow><mi mathvariant=normal>e</mi><mi mathvariant=normal>d</mi></mrow><mo>≡</mo><mn>1</mn><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>φ</mi><mo stretchy=false>(</mo><mi mathvariant=normal>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\mathrm{ed} \equiv 1 \bmod \varphi(\mathrm{n})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class="mord mathrm">e</span><span class="mord mathrm">d</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class=mord><span class="mord mathrm">n</span></span><span class=mclose>)</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>C</mi><mo>=</mo><msup><mi mathvariant=normal>M</mi><mi mathvariant=normal>e</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>\mathrm{C}=\mathrm{M}^{\mathrm{e}} \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathrm">C</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class=mord><span class="mord mathrm">M</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">e</span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>M</mi><mo>=</mo><msup><mi mathvariant=normal>C</mi><mi mathvariant=normal>d</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>\mathrm{M}=\mathrm{C}^{\mathrm{d}} \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathrm">M</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.849108em;vertical-align:0></span><span class=mord><span class=mord><span class="mord mathrm">C</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">d</span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span></p></li></ul><h3 id=算法描述><a class=markdownIt-Anchor href=#算法描述></a> 算法描述</h3><h4 id=密钥产生算法><a class=markdownIt-Anchor href=#密钥产生算法></a> 密钥产生算法</h4><ol><li>随机生成两个不同且大小相近的大素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>。</li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>n=p×q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo><mo stretchy=false>(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>φ(n)=(p-1)(q-1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span></span></span></span>,其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>φ(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> 是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的欧拉函数值。</li><li>选一整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi></mrow><annotation encoding=application/x-tex>e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span></span></span></span>，满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>e</mi><mo>&lt;</mo><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>1&lt;e&lt;φ(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68354em;vertical-align:-.0391em></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>，且 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=false>(</mo><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>e</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>gcd(φ(n),e)=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class=mopen>(</span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>。</li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>，满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi><mo separator=true>⋅</mo><mi>e</mi><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>d·e\equiv1 mod φ(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class=mpunct>⋅</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> ,即 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span> 是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi></mrow><annotation encoding=application/x-tex>e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span></span></span></span> 在模 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>φ(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> 下的乘法逆元，因 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi></mrow><annotation encoding=application/x-tex>e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span></span></span></span> 与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>φ(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> 互素，由模运算可知，它的乘法逆元一定存在。</li><li>以 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi><mo separator=true>,</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>{e,n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">e</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span></span></span></span></span> 为公开钥, <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi><mo separator=true>,</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>{d,n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">d</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span></span></span></span></span> 为秘密钥。</li></ol><h5 id=密钥产生细节><a class=markdownIt-Anchor href=#密钥产生细节></a> 密钥产生细节</h5><ol><li><p>选取大素数的方法：随机产生一个大整数，利用<strong>素性检测算法</strong>判定该整数是否为素数</p></li><li><p>以往素检测的算法都是概率性的，即存在一定的错误概率；</p></li><li><p>2003年，印度人发表文章 “Primes is in P”，证明了素判定问题是一个多项式时间问题。</p></li></ol><h4 id=加解密><a class=markdownIt-Anchor href=#加解密></a> 加解密</h4><h5 id=加密><a class=markdownIt-Anchor href=#加密></a> 加密</h5><ol><li>获得 A 的可信公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>e</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(n,e)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mclose>)</span></span></span></span>；</li><li>将明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 比特串分组，使得每个分组对应的十进制数小于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>，即分组的长度小于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding=application/x-tex>log_2n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class="mord mathdefault">o</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault">n</span></span></span></span>；</li><li>对每组明文分组，作加密运算：</li></ol><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>M</mi><mi>e</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>C=M^e \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7143919999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span></span></p><ol start=4><li>将密文 C 发送给 A 。</li></ol><h5 id=解密><a class=markdownIt-Anchor href=#解密></a> 解密</h5><ol><li>对密文分组的解密运算为:</li></ol><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo>=</mo><msup><mi>C</mi><mi>d</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>M=C^d \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8991079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8991079999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span></span></p><h5 id=加解密细节><a class=markdownIt-Anchor href=#加解密细节></a> 加解密细节</h5><ul><li>实际应用中，在RSA算法的加密与解密过程中，被加密的是经过分组的数据段。各数据段的长度相等，并且小于比 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 小的 2 的最大次幂。<ul><li>当需要加密固定长度的数据段时，可以在长度不足的各数据段的左边位上填充 0 作为补充。<br>解密过程针对的也是被加密的这些数据段。因此，经解密得到的依然是经过分组的数据段。将这些数据段依次连接便能得到被传输的消息原文。</li></ul></li></ul><h3 id=rsa-中的计算问题><a class=markdownIt-Anchor href=#rsa-中的计算问题></a> RSA 中的计算问题</h3><h4 id=计算技巧><a class=markdownIt-Anchor href=#计算技巧></a> 计算技巧</h4><h5 id=rsa-加密><a class=markdownIt-Anchor href=#rsa-加密></a> RSA 加密</h5><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>a</mi><mo>×</mo><mi>b</mi><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi><mo>=</mo><mo stretchy=false>[</mo><mo stretchy=false>(</mo><mi>a</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy=false>)</mo><mo>×</mo><mo stretchy=false>(</mo><mi>b</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy=false>)</mo><mo stretchy=false>]</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>(a×b) \bmod n=[(a \bmod n)×(b \bmod n)] \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">b</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>[</span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mclose>]</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span></li><li>模指数运算的快速算法</li></ul><h5 id=rsa-解密><a class=markdownIt-Anchor href=#rsa-解密></a> RSA 解密</h5><ul><li><p>加密很快，指数小；解密比较慢，指数较大</p><ul><li>利用中国剩余定理CRT，加快计算速度。</li></ul><p>CRT 对RSA解密算法生成两个解密方程（利用 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo>=</mo><msup><mi>C</mi><mi>d</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>R</mi></mrow><annotation encoding=application/x-tex>M=C^d \bmod R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.849108em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span>）</p><p>即:</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>=</mo><mi>M</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi><mo>=</mo><mo stretchy=false>(</mo><mi>C</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi><msup><mo stretchy=false>)</mo><mrow><mi>d</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mo stretchy=false>(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi><mspace linebreak=newline></mspace><mi mathvariant=normal>​</mi><msub><mi>M</mi><mn>2</mn></msub><mo>=</mo><mi>M</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>q</mi><mo>=</mo><mo stretchy=false>(</mo><mi>C</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>q</mi><msup><mo stretchy=false>)</mo><mrow><mi>d</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mo stretchy=false>(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>q</mi></mrow><annotation encoding=application/x-tex>M_1 = M \bmod p = (C \bmod p )^{d \bmod (p-1)} \bmod p\\ ​ M_2 = M \bmod q = (C \bmod q )^{d \bmod (q-1) }\bmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1.188em;vertical-align:-.25em></span><span class="mord mathdefault">p</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mbin mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span></span></span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord>​</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1.188em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mbin mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span></span></span><span class="mspace mtight" style=margin-right:.3252777777777778em></span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span></span></p><p>解方程组：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo>=</mo><msub><mi>M</mi><mn>1</mn></msub><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi><mspace linebreak=newline></mspace><mi mathvariant=normal>​</mi><mi>M</mi><mo>=</mo><msub><mi>M</mi><mn>2</mn></msub><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>q</mi></mrow><annotation encoding=application/x-tex>M = M_1 \bmod p\\ ​M = M_2 \bmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>​</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span></span></p><p>利用CRT:</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mi>q</mi><mo>∗</mo><mo stretchy=false>(</mo><msup><mi>q</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi><mo stretchy=false>)</mo><mspace linebreak=newline></mspace><mi mathvariant=normal>​</mi><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><mi>p</mi><mo>∗</mo><mo stretchy=false>(</mo><msup><mi>p</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>q</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>X_1=q*(q^{-1}\bmod p)\\ ​X_2=p*(p^{-1}\bmod q)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.6597200000000001em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord>​</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.6597200000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">p</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span></span></span></span></span></p><p>具有唯一解：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo>=</mo><msub><mi>M</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>M</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mspace></mspace><mspace width=1em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>n</mi><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>M = M_1 X_1 + M_2X_2 \pmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:1em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span></p></li></ul><h5 id=密钥生成><a class=markdownIt-Anchor href=#密钥生成></a> 密钥生成</h5><ul><li>Miller Rabin 素数判定测试</li></ul><h3 id=rsa-安全性分析><a class=markdownIt-Anchor href=#rsa-安全性分析></a> RSA 安全性分析</h3><ol><li>已知 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi></mrow><annotation encoding=application/x-tex>e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span>，产生 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span> 是计算可行的——加密函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>M</mi><mi>e</mi></msup><mo stretchy=false>(</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>C = M^e(\bmod n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></li><li>对于攻击者，已知 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi></mrow><annotation encoding=application/x-tex>e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span>，要恢复 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 是计算不可行的——解密函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo>=</mo><msup><mi>C</mi><mi>d</mi></msup><mo stretchy=false>(</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M = C^d(\bmod n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></li><li>存在能解密的陷门——解密私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>。</li></ol><h4 id=理解求d的困难性><a class=markdownIt-Anchor href=#理解求d的困难性></a> 理解求d的困难性</h4><p>解密函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo>=</mo><msup><mi>C</mi><mi>d</mi></msup><mo stretchy=false>(</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M = C^d(\bmod n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span><br>1）Attacker得到一对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>M</mi><mo separator=true>,</mo><mi>C</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(M,C)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mclose>)</span></span></span></span>，试图还原 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>，以便以后的解密，这就是<strong>离散对数问题</strong>。也就是找到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span>，满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>a</mi><mi>x</mi></msup><mo>≡</mo><mi>b</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>q</mi></mrow><annotation encoding=application/x-tex>a^x \equiv b \bmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 是很难的。<br>2）Attacker知道公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>e</mi><mo separator=true>,</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(e,n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">e</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>，通过公钥去得到私钥是很难的。<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi><mi>e</mi><mo>≡</mo><mn>1</mn><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>de \equiv 1 \bmod \varphi(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> → 求 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\varphi(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> → 求素因子 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> → 大数因子分解的困难性</p><h3 id=rsa-的攻击><a class=markdownIt-Anchor href=#rsa-的攻击></a> RSA 的攻击</h3><ul><li><p>穷举攻击：穷举所有可能的私钥</p></li><li><p>数学攻击：</p><ul><li>因式分解攻击</li><li>参数的选取不当造成的攻击</li><li>选择密文攻击</li><li>共模攻击</li><li>Hastad对广播信息的攻击(小e攻击)</li><li>小指数攻击（可以用连分数方法）</li><li>加密及签名攻击</li><li>鲁棒性攻击</li><li>数学性的鲁棒性攻击</li></ul></li><li><p>计时攻击</p></li><li><p>用定时攻击方法分解出私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span></p></li><li><p>基于密码分析的错误攻击（基于脆弱性的中国剩余定理）</p></li><li><p>对于已知部分密钥位的攻击</p></li></ul><h3 id=rsa密码体制的实现要求><a class=markdownIt-Anchor href=#rsa密码体制的实现要求></a> RSA密码体制的实现要求</h3><h4 id=对-npqe-的要求><a class=markdownIt-Anchor href=#对-npqe-的要求></a> 对 n,p,q,e 的要求</h4><p>若使 RSA 安全，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 必为足够大的素数，使分析者没有办法在多项式时间内将 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 分解出来。建议选择：</p><ul><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 大约是 100 位的十进制素数。</p></li><li><p>模 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的长度要求至少是 512 比特。</p><ul><li>EDI（电子数据交换）国际标准使用的 RSA 算法中规定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的长度为 512 至 1024 比特位之间，但必须是 128 的倍数。</li><li>国际数字签名标准ISO/IEC 9796中规定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的长度为 512 比特位。</li><li>SET(secure electronic transaction) 协议中要求 CA 采用 2048 位的密钥，其它实体使用 1024 位的密钥</li></ul></li><li><p>为了抵抗现有的整数分解算法，对RSA模 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 的素因子 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 还有如下要求：</p><ul><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>p</mi><mo>−</mo><mi>q</mi><mi mathvariant=normal>∣</mi></mrow><annotation encoding=application/x-tex>|p-q|</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mord>∣</span></span></span></span> 很大，通常 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 的长度相同；</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo separator=true>,</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>p,q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 为强素数。<ul><li>一个素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 是强素数需要满足以下三个条件：<ol><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>p-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 有大的素数因子，称为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span>；</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>p+1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 也有大的素数因子；</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>r -1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 仍然有大的素数因子。</li></ol><ul><li>原因：<ol><li>第一个条件的原因是存在 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>p-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 分解算法，这一算法只在模 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 存在一个素数因子 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>p-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 平滑时有效；</li><li>第二个条件的原因是存在 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>p+1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 分解算法，这一算法只在模 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 存在一个素数因子 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>p+1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 平滑时有效；</li><li>第三个条件的原因为了保证循环攻击无效。</li></ol></li></ul></li></ul></li></ul></li></ul><h3 id=rsa-的速度><a class=markdownIt-Anchor href=#rsa-的速度></a> RSA 的速度</h3><ul><li>在RSA的软件实现上，RSA 大约比 DES 慢 100 倍。</li><li>在RSA的硬件实现上，粗略地说，RSA 比 DES 慢 1500 倍。</li><li>为了提高加密速度，通常取e为特定的小整数，如 EDI 国际标准中规定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi><mo>=</mo><msup><mn>2</mn><mn>16</mn></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>e=2^{16}+1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>，ISO/IEC9796中 甚至允许取 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding=application/x-tex>e=3</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>3</span></span></span></span> 。这时加密速度一般比解密速度快 10 倍以上。</li><li>虽然因为计算机技术的改进，RSA 的速度不断改变，但其永远无法达到对称密钥算法的运行速度。</li><li><strong>具体应用中将 RSA 算法更多地用于密钥的安全传输过程，而在针对具体传输信息的加密与解密中依靠对称密钥算法，这样便能够增进密码系统的运行速度。</strong></li></ul><h3 id=rsa算法的优缺点><a class=markdownIt-Anchor href=#rsa算法的优缺点></a> RSA算法的优缺点</h3><h4 id=优点><a class=markdownIt-Anchor href=#优点></a> 优点</h4><ul><li><p>是第一个能同时用于加密和数字签名的算法，也易于理解和操作.</p></li><li><p><strong>特别符合计算机网络环境。</strong></p></li><li><p>对于网上的大量用户，可以<strong>将加密密钥用电话簿的方式印出</strong>。</p></li></ul><h4 id=缺点><a class=markdownIt-Anchor href=#缺点></a> 缺点</h4><ul><li>产生密钥很麻烦，受到素数产生技术的限制，因而难以做到一次一密；</li><li>分组长度太大，为保证安全性，n 至少也要 600 位以上，使运算代价很高，尤其是<strong>速度较慢</strong>，较对称密码算法慢几个数量级；且随着大数分解技术的发展，这个长度还在增加，不利于数据格式的标准化。</li></ul><h2 id=椭圆曲线密码体制-ecc><a class=markdownIt-Anchor href=#椭圆曲线密码体制-ecc></a> 椭圆曲线密码体制 ECC</h2><h3 id=椭圆曲线密码简介><a class=markdownIt-Anchor href=#椭圆曲线密码简介></a> 椭圆曲线密码简介</h3><ul><li><p>椭圆曲线密码是基于椭圆曲线数学的一种公钥密码的方法</p></li><li><p>椭圆曲线在密码学中的使用在 1985 年由 Neal Koblitz 和 Victor Miller 分别独立提出</p></li><li><p>与传统的基于大质数因子分解困难性的加密方法不同，ECC通过<strong>椭圆曲线方程式的性质</strong>产生密钥。</p></li><li><p>ECC被广泛认为是在<strong>给定密钥长度</strong>的情况下，<strong>最强大的非对称算法</strong>，因此在对带宽要求十分紧的连接中会十分有用。</p></li><li><p>ECC的主要优势：<strong>在某些情况下它比其他的方法使用更小的密钥提供相当的或更高等级的安全</strong></p><ul><li>速度快、密钥短</li></ul></li><li><p>椭圆曲线密码学的许多形式有稍微的不同，所有都依赖于被广泛承认的解决椭圆曲线离散对数问题的困难性上，对应有限域上椭圆曲线的群。</p></li><li><p>对椭圆曲线来说最流行的有限域是</p><ul><li>以素数为模的整数域 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi><mi>F</mi><mo stretchy=false>(</mo><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>GF(p)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span>，通常在通用处理器上更为有效；</li><li>特征为2的伽罗华域 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi><mi>F</mi><mo stretchy=false>(</mo><msup><mn>2</mn><mi>m</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>GF(2^m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mopen>(</span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>，在专门的硬件实现上计算更为有效。</li></ul></li></ul><h3 id=椭圆曲线的基本概念><a class=markdownIt-Anchor href=#椭圆曲线的基本概念></a> 椭圆曲线的基本概念</h3><ul><li><p>无穷远点</p><ul><li>定义平行线相交于无穷远点 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>P</mi><mi mathvariant=normal>∞</mi></msup></mrow><annotation encoding=application/x-tex>P^{∞}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span></span></span></span></span></span></span></span>，使平面上所有直线都统一为有唯一的交点</li><li>性质：<ul><li>一条直线只有一个无穷远点；一对平行线有公共的无穷远点</li><li>任何两条不平行的直线有不同的无穷远点（否则会造成有两个交点）</li><li>平面上全体无穷远点构成一条无穷远直线</li></ul></li></ul></li><li><p>射影平面</p><ul><li>平面上全体无穷远点与全体平常点构成射影平面</li><li>对普通平面上点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x,y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span></span></span></span>，令 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>=</mo><mi>X</mi><mi mathvariant=normal>/</mi><mi>Z</mi><mi mathvariant=normal>，</mi><mi>y</mi><mo>=</mo><mi>Y</mi><mi mathvariant=normal>/</mi><mi>Z</mi><mi mathvariant=normal>，</mi><mi>Z</mi><mi mathvariant=normal>≠</mi><mn>0</mn></mrow><annotation encoding=application/x-tex>x=X/Z，y=Y/Z，Z≠0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mord>/</span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mord>/</span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span>，则投影为射影平面上的点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>X</mi><mo>:</mo><mi>Y</mi><mo>:</mo><mi>Z</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(X:Y:Z)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mclose>)</span></span></span></span><ul><li>例如：点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mn>1</mn><mo separator=true>,</mo><mn>3</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(1,3)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>3</span><span class=mclose>)</span></span></span></span> 可投影为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>Z</mi><mo>:</mo><mn>3</mn><mi>Z</mi><mo>:</mo><mi>Z</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(Z:3Z:Z)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>3</span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mclose>)</span></span></span></span>，可为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mn>1</mn><mo>:</mo><mn>3</mn><mo>:</mo><mn>1</mn><mo stretchy=false>)</mo><mi mathvariant=normal>，</mi><mo stretchy=false>(</mo><mn>2.3</mn><mo>:</mo><mn>6.9</mn><mo>:</mo><mn>2.3</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(1:3:1)，(2.3:6.9:2.3)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>3</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class="mord cjk_fallback">，</span><span class=mopen>(</span><span class=mord>2</span><span class=mord>.</span><span class=mord>3</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>6</span><span class=mord>.</span><span class=mord>9</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>2</span><span class=mord>.</span><span class=mord>3</span><span class=mclose>)</span></span></span></span> 等</li><li>对普通平面上的直线 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>+</mo><mi>c</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>ax+by+c=0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span>，同样变换，得到对应于射影平面上的直线为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>X</mi><mo>+</mo><mi>b</mi><mi>Y</mi><mo>+</mo><mi>c</mi><mi>Z</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>aX+bY+cZ=0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span></li><li>无穷远点的坐标为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>X</mi><mo>:</mo><mi>Y</mi><mo>:</mo><mn>0</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(X:Y:0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>0</span><span class=mclose>)</span></span></span></span></li></ul></li></ul></li><li><p>椭圆曲线</p><ul><li><p>一条椭圆曲线是在射影平面上满足威尔斯特拉斯方程（Weierstrass）所有点的集合：<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>Y</mi><mn>2</mn></msup><mi>Z</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>X</mi><mi>Y</mi><mi>Z</mi><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><mi>Y</mi><msup><mi>Z</mi><mn>2</mn></msup><mo>=</mo><msup><mi>X</mi><mn>3</mn></msup><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>X</mi><mn>2</mn></msup><mi>Z</mi><mo>+</mo><msub><mi>a</mi><mn>4</mn></msub><mi>X</mi><msup><mi>Z</mi><mn>2</mn></msup><mo>+</mo><msub><mi>a</mi><mn>6</mn></msub><msup><mi>Z</mi><mn>3</mn></msup></mrow><annotation encoding=application/x-tex>Y^2 Z+a_1 XYZ+a_3 Y Z ^2=X^3+a_2 X^2 Z+a_4 X Z ^2+a_6 Z^3</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.964108em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.964108em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.964108em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.964108em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></p></li><li><p>椭圆曲线方程是一个齐次方程，无穷远点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>O</mi><mi mathvariant=normal>∞</mi><mo stretchy=false>(</mo><mn>0</mn><mo separator=true>,</mo><mi>Y</mi><mo separator=true>,</mo><mn>0</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O∞(0,Y,0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>O</span><span class=mord>∞</span><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>0</span><span class=mclose>)</span></span></span></span></p></li><li><p>椭圆曲线普通方程：<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><mi>y</mi><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><mi>y</mi><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msub><mi>a</mi><mn>4</mn></msub><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>6</mn></msub></mrow><annotation encoding=application/x-tex>y^2+a_1 xy+a_3 y=x^3+a_2 x^2+a_4 x+a_6</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.008548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.964108em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p></li><li><p>曲线上的每个点都必须是非奇异的（光滑的），偏导数 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>F</mi><mi>X</mi></msub><mo stretchy=false>(</mo><mi>X</mi><mo separator=true>,</mo><mi>Y</mi><mo separator=true>,</mo><mi>Z</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><msub><mi>F</mi><mi>Y</mi></msub><mo stretchy=false>(</mo><mi>X</mi><mo separator=true>,</mo><mi>Y</mi><mo separator=true>,</mo><mi>Z</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><msub><mi>F</mi><mi>Z</mi></msub><mo stretchy=false>(</mo><mi>X</mi><mo separator=true>,</mo><mi>Y</mi><mo separator=true>,</mo><mi>Z</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>F_X(X,Y,Z),F_Y(X,Y,Z),F_Z(X,Y,Z)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07847em>X</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.22222em>Y</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>Z</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=mclose>)</span></span></span></span> 不同为0</p></li><li><p>椭圆曲线并非椭圆，称为椭圆曲线是因为它的曲线方程与计算椭圆周长的方程类似。</p></li></ul></li><li><p>椭圆曲线普通方程</p><ul><li><p>椭圆曲线普通方程：<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mi>y</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>c</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>d</mi><mi>x</mi><mo>+</mo><mi>e</mi></mrow><annotation encoding=application/x-tex>y^2+axy+by=x^3+cx^2+dx+e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.008548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class="mord mathdefault">c</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault">d</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span></span></span></span></p></li><li><p>常见形式为：<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>y^2=x^3+ax+b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.008548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>4</mn><msup><mi>a</mi><mn>3</mn></msup><mo>+</mo><mn>27</mn><msup><mi>b</mi><mn>2</mn></msup><mi mathvariant=normal>≠</mi><mn>0</mn></mrow><annotation encoding=application/x-tex>4a^3+27b^2≠0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord>4</span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.008548em;vertical-align:-.19444em></span><span class=mord>2</span><span class=mord>7</span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span></p></li><li><p>曲线关于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>y=0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span> 对称</p></li><li><p>平常点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x,y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span></span></span></span> 斜率 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span></p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>F</mi><mi>x</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo><mo>=</mo><mi>a</mi><mi>y</mi><mo>−</mo><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>2</mn><mi>b</mi><mi>x</mi><mo>−</mo><mi>d</mi></mrow><annotation encoding=application/x-tex>F_{x}(x, y)=a y-3 x^{2}-2 b x-d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord>3</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class=mord>2</span><span class="mord mathdefault">b</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>F</mi><mi>y</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo><mo>=</mo><mn>2</mn><mi>y</mi><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>c</mi></mrow><annotation encoding=application/x-tex>F_{y}(x, y)=2 y+a x+c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>2</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>f</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mo>−</mo><mfrac><mrow><msub><mi>F</mi><mi>x</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><mrow><msub><mi>F</mi><mi>y</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi>b</mi><mi>x</mi><mo>+</mo><mi>d</mi><mo>−</mo><mi>a</mi><mi>y</mi></mrow><mrow><mn>2</mn><mi>y</mi><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>c</mi></mrow></mfrac></mrow><annotation encoding=application/x-tex>k=f^{\prime}(x)=-\frac{F_{x}(x, y)}{F_{y}(x, y)}=\frac{3 x^{2}+2 b x+d-a y}{2 y+a x+c}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.55232em;vertical-align:-.5423199999999999em></span><span class=mord>−</span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.01em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285716em><span style=top:-2.357em;margin-left:-.13889em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2818857142857143em><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class="mclose mtight">)</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.485em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285719em><span style=top:-2.357em;margin-left:-.13889em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.5423199999999999em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.551136em;vertical-align:-.481108em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.070028em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">c</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.446108em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8913142857142857em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight">2</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">x</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">d</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.481108em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p></li></ul></li></ul><div align=center><img src=/img/post/密码学备忘/椭圆曲线示例.png alt=椭圆曲线示例 style=zoom:67%></div><div align=center><img src=/img/post/密码学备忘/非椭圆曲线示例.png alt=非椭圆曲线示例 style=zoom:67%></div><h3 id=实域r上的椭圆曲线><a class=markdownIt-Anchor href=#实域r上的椭圆曲线></a> 实域R上的椭圆曲线</h3><ul><li><p>椭圆曲线表示为平面上通常曲线上的点，外加无穷远点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding=application/x-tex>θ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>θ</span></span></span></span>。</p></li><li><p>设 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>L</mi><mo>∈</mo><msup><mi>P</mi><mn>2</mn></msup><mo stretchy=false>(</mo><mi>R</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>L∈P^2(R)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.72243em;vertical-align:-.0391em></span><span class="mord mathdefault">L</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mclose>)</span></span></span></span> 为一条直线。因为 E 的方程是三次的，所以 L 可与 E 在 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>P</mi><mn>2</mn></msup><mo stretchy=false>(</mo><mi>R</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P^2(R)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mclose>)</span></span></span></span> 上恰有三个交点，记为P、Q、R(如果 L 与 E 相切，那么 P、Q、R 可以不相异)。</p></li></ul><h4 id=椭圆曲线上的加法运算><a class=markdownIt-Anchor href=#椭圆曲线上的加法运算></a> 椭圆曲线上的加法运算</h4><ul><li><p>如果其上的 3 个点位于同一直线上，那么它们的和为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>O</mi></mrow><annotation encoding=application/x-tex>O</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>O</span></span></span></span>。进一步可如下定义椭圆曲线上的加法律</p><ol><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>O</mi></mrow><annotation encoding=application/x-tex>O</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>O</span></span></span></span> 为加法单位元，即对椭圆曲线上任一点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=application/x-tex>P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span>，有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>+</mo><mi>O</mi><mo>=</mo><mi>P</mi></mrow><annotation encoding=application/x-tex>P+O=P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>O</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span></li></ol></li></ul><ol start=2><li>设 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P_1=(x,y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span></span></span></span> 是椭圆曲线上的一点，它的加法逆元定义为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><mo>−</mo><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mo>−</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P_2=-P_1=(x, -y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord>−</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span></span></span></span></li><li>设 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding=application/x-tex>Q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi></mrow><annotation encoding=application/x-tex>R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span> 是椭圆曲线上 x 坐标不同的两点，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Q</mi><mo>+</mo><mi>R</mi></mrow><annotation encoding=application/x-tex>Q+R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span> 的定义如下： 画一条通过 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Q</mi><mo separator=true>,</mo><mi>R</mi></mrow><annotation encoding=application/x-tex>Q,R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span> 的直线与椭圆曲线交于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=application/x-tex>P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span>，由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Q</mi><mo>+</mo><mi>R</mi><mo>+</mo><mi>P</mi><mo>=</mo><mi>O</mi></mrow><annotation encoding=application/x-tex>Q+R+P=O</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>O</span></span></span></span> 得 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Q</mi><mo>+</mo><mi>R</mi><mo>=</mo><mo>−</mo><mi>P</mi></mrow><annotation encoding=application/x-tex>Q+R= -P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class=mord>−</span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span>。</li></ol><ul><li><p>点加公式</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>p</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>p</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>Q</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>Q</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>Q</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>R</mi><mo>=</mo><mi>P</mi><mo>+</mo><mi>Q</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>R</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>R</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P=(x_p,y_p),Q=(x_Q,y_Q),R=P+Q=(x_R,y_R)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p><p>则：</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mi>R</mi></msub><mo>=</mo><mo stretchy=false>(</mo><msup><mi>λ</mi><mn>2</mn></msup><mo>−</mo><msub><mi>x</mi><mi>P</mi></msub><mo>−</mo><msub><mi>x</mi><mi>Q</mi></msub><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>x_R=(\lambda^2-x_P-x_Q )\bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>y</mi><mi>R</mi></msub><mo>=</mo><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mi>P</mi></msub><mo>−</mo><msub><mi>x</mi><mi>R</mi></msub><mo stretchy=false>)</mo><mo>−</mo><msub><mi>y</mi><mi>P</mi></msub><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>y_R=(\lambda(x_P-x_R)-y_P)\bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">λ</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mfrac><mrow><msub><mi>y</mi><mi>Q</mi></msub><mo>−</mo><msub><mi>y</mi><mi>P</mi></msub></mrow><mrow><msub><mi>x</mi><mi>Q</mi></msub><mo>−</mo><msub><mi>x</mi><mi>P</mi></msub></mrow></mfrac><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>P</mi><mi mathvariant=normal>≠</mi><mi>Q</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mfrac><mrow><mn>3</mn><msubsup><mi>x</mi><mi>P</mi><mn>2</mn></msubsup><mo>+</mo><mi>a</mi></mrow><mrow><mn>2</mn><msub><mi>y</mi><mi>P</mi></msub></mrow></mfrac><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>P</mi><mo>=</mo><mi>Q</mi></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=application/x-tex>\begin{cases}\frac{y_Q-y_P}{x_Q-x_P}\bmod p &amp;&amp; P\neq Q \\\frac{3x_P^2+a}{2y_P}\bmod p &amp;&amp;P=Q \end{cases}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:3.1657529999999996em;vertical-align:-1.3328764999999998em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">{</span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8328764999999998em><span style=top:-3.9589964999999996em><span class=pstrut style=height:3.13412em></span><span class=mord><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.915856em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.34479999999999994em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.28217857142857145em><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.5075250000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.34479999999999994em><span style=top:-2.3567071428571427em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.28217857142857145em><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.5425249999999999em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault">p</span></span></span><span style=top:-2.2823515em><span class=pstrut style=height:3.13412em></span><span class=mord><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1341199999999998em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.5102em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8913142857142857em><span style=top:-2.214em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286em><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.481108em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.3328764999999998em><span></span></span></span></span></span><span class=arraycolsep style=width:1em></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8328764999999998em><span style=top:-3.9589964999999996em><span class=pstrut style=height:3.13412em></span><span class=mord></span></span><span style=top:-2.2823515em><span class=pstrut style=height:3.13412em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.3328764999999998em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8328764999999998em><span style=top:-3.9589964999999996em><span class=pstrut style=height:3.13412em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">Q</span></span></span><span style=top:-2.2823515em><span class=pstrut style=height:3.13412em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.3328764999999998em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li><li><p>数乘定义为<strong>重复相加</strong></p></li></ul><h3 id=有限域上的椭圆曲线><a class=markdownIt-Anchor href=#有限域上的椭圆曲线></a> 有限域上的椭圆曲线</h3><h4 id=z_p-上的椭圆曲线><a class=markdownIt-Anchor href=#z_p-上的椭圆曲线></a> <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding=application/x-tex>Z_p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 上的椭圆曲线</h4><ul><li><p>定义：<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>≡</mo><mo stretchy=false>(</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi><mo stretchy=false>(</mo><mi>a</mi><mo separator=true>,</mo><mi>b</mi><mo>∈</mo><mi>G</mi><mi>F</mi><mo stretchy=false>(</mo><mi>p</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><mo stretchy=false>(</mo><mn>4</mn><msup><mi>a</mi><mn>3</mn></msup><mo>+</mo><mn>27</mn><msup><mi>b</mi><mn>2</mn></msup><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi mathvariant=normal>≠</mi><mn>0</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>y^2\equiv(x^3+ax+b) \bmod p (a,b∈GF(p),(4a^3+27b^2) \bmod \neq0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.008548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">b</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">p</span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mopen>(</span><span class=mord>4</span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord>2</span><span class=mord>7</span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>0</span><span class=mclose>)</span></span></span></span></p><p>满足上式的所有整数对和无穷远点组成的集合 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>p</mi></msub><mo stretchy=false>(</mo><mi>a</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>E_p(a,b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class=mclose>)</span></span></span></span></p></li><li><p>点加公式</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>p</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>p</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>Q</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>Q</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>Q</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>R</mi><mo>=</mo><mi>P</mi><mo>+</mo><mi>Q</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>R</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>R</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P=(x_p,y_p),Q=(x_Q,y_Q),R=P+Q=(x_R,y_R)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p><p>则：</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mi>R</mi></msub><mo>=</mo><mo stretchy=false>(</mo><msup><mi>λ</mi><mn>2</mn></msup><mo>−</mo><msub><mi>x</mi><mi>P</mi></msub><mo>−</mo><msub><mi>x</mi><mi>Q</mi></msub><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>x_R=(\lambda^2-x_P-x_Q )\bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>y</mi><mi>R</mi></msub><mo>=</mo><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mi>P</mi></msub><mo>−</mo><msub><mi>x</mi><mi>R</mi></msub><mo stretchy=false>)</mo><mo>−</mo><msub><mi>y</mi><mi>P</mi></msub><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>y_R=(\lambda(x_P-x_R)-y_P)\bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">λ</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>λ</mi><mo>=</mo><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mfrac><mrow><msub><mi>y</mi><mi>Q</mi></msub><mo>−</mo><msub><mi>y</mi><mi>P</mi></msub></mrow><mrow><msub><mi>x</mi><mi>Q</mi></msub><mo>−</mo><msub><mi>x</mi><mi>P</mi></msub></mrow></mfrac><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>P</mi><mi mathvariant=normal>≠</mi><mi>Q</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mfrac><mrow><mn>3</mn><msubsup><mi>x</mi><mi>P</mi><mn>2</mn></msubsup><mo>+</mo><mi>a</mi></mrow><mrow><mn>2</mn><msub><mi>y</mi><mi>P</mi></msub></mrow></mfrac><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>P</mi><mo>=</mo><mi>Q</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=application/x-tex>\lambda=\begin{cases}\frac{y_Q-y_P}{x_Q-x_P}\bmod p &amp;&amp; P\neq Q \\\frac{3x_P^2+a}{2y_P}\bmod p &amp;&amp;P=Q \end{cases}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">λ</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:3.1657529999999996em;vertical-align:-1.3328764999999998em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">{</span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8328764999999998em><span style=top:-3.9589964999999996em><span class=pstrut style=height:3.13412em></span><span class=mord><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.915856em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.34479999999999994em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.28217857142857145em><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.5075250000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.34479999999999994em><span style=top:-2.3567071428571427em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.28217857142857145em><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.5425249999999999em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault">p</span></span></span><span style=top:-2.2823515em><span class=pstrut style=height:3.13412em></span><span class=mord><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1341199999999998em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567071428571427em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.14329285714285717em><span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.5102em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8913142857142857em><span style=top:-2.214em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286em><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.481108em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.3328764999999998em><span></span></span></span></span></span><span class=arraycolsep style=width:1em></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8328764999999998em><span style=top:-3.9589964999999996em><span class=pstrut style=height:3.13412em></span><span class=mord></span></span><span style=top:-2.2823515em><span class=pstrut style=height:3.13412em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.3328764999999998em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8328764999999998em><span style=top:-3.9589964999999996em><span class=pstrut style=height:3.13412em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">Q</span></span></span><span style=top:-2.2823515em><span class=pstrut style=height:3.13412em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.3328764999999998em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul><h4 id=gf2m-上的椭圆曲线><a class=markdownIt-Anchor href=#gf2m-上的椭圆曲线></a> <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi><mi>F</mi><mo stretchy=false>(</mo><msup><mn>2</mn><mi>m</mi></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>GF(2^m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=mopen>(</span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 上的椭圆曲线</h4><ul><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mi>p</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>p</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mo>−</mo><mi>p</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>p</mi></msub><mo separator=true>,</mo><msub><mi>x</mi><mi>p</mi></msub><mo>+</mo><msub><mi>y</mi><mi>p</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P(x_p,y_p),-p=(x_p,x_p+y_p)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>−</span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p></li><li><p>点加公式</p><ul><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>p</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>p</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>Q</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>Q</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>Q</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>P</mi><mi mathvariant=normal>≠</mi><mo>±</mo><mi>Q</mi><mo separator=true>,</mo><mi>R</mi><mo>=</mo><mi>P</mi><mo>+</mo><mi>Q</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>R</mi></msub><mo separator=true>,</mo><msub><mi>y</mi><mi>R</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P=(x_p,y_p),Q=(x_Q,y_Q),P\neq \pm Q,R=P+Q=(x_R,y_R)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord>±</span><span class="mord mathdefault">Q</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p><p>则：</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mi>R</mi></msub><mo>=</mo><msup><mi>λ</mi><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mo>+</mo><msub><mi>x</mi><mi>P</mi></msub><mo>+</mo><msub><mi>x</mi><mi>Q</mi></msub><mo>+</mo><mi>a</mi></mrow><annotation encoding=application/x-tex>x_R=\lambda^2+\lambda+x_P+x_Q+a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault">λ</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8694379999999999em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span></span></span></span></p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>y</mi><mi>R</mi></msub><mo>=</mo><mi>λ</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mi>P</mi></msub><mo>+</mo><msub><mi>x</mi><mi>R</mi></msub><mo stretchy=false>)</mo><mo>+</mo><msub><mi>x</mi><mi>R</mi></msub><mo>+</mo><msub><mi>y</mi><mi>P</mi></msub></mrow><annotation encoding=application/x-tex>y_R=\lambda(x_P+x_R)+x_R+y_P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">λ</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.73333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>λ</mi><mo>=</mo><mfrac><mrow><msub><mi>y</mi><mi>Q</mi></msub><mo>+</mo><msub><mi>y</mi><mi>P</mi></msub></mrow><mrow><msub><mi>x</mi><mi>Q</mi></msub><mo>+</mo><msub><mi>x</mi><mi>P</mi></msub></mrow></mfrac></mrow><annotation encoding=application/x-tex>\lambda =\frac{y_Q+y_P}{x_Q+x_P}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">λ</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.232438em;vertical-align:-.972108em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.26033em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.972108em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi><mo>=</mo><mn>2</mn><mi>P</mi></mrow><annotation encoding=application/x-tex>R=2P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>2</span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span></p><p>则：</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mi>R</mi></msub><mo>=</mo><msup><mi>λ</mi><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mo>+</mo><mi>a</mi></mrow><annotation encoding=application/x-tex>x_R=\lambda^2+\lambda+a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault">λ</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span></span></span></span></p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>y</mi><mi>R</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>P</mi><mn>2</mn></msubsup><mo>+</mo><mo stretchy=false>(</mo><mi>λ</mi><mo>+</mo><mn>1</mn><mo stretchy=false>)</mo><msub><mi>x</mi><mi>R</mi></msub></mrow><annotation encoding=application/x-tex>y_R=x_P^2+(\lambda+1)x_R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.089439em;vertical-align:-.275331em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-2.424669em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.275331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">λ</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>λ</mi><mo>=</mo><mfrac><msub><mi>y</mi><mi>P</mi></msub><msub><mi>x</mi><mi>P</mi></msub></mfrac><mo>+</mo><msub><mi>x</mi><mi>P</mi></msub></mrow><annotation encoding=application/x-tex>\lambda=\frac{y_P}{x_P}+x_P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">λ</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.94356em;vertical-align:-.8360000000000001em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1075599999999999em><span style=top:-2.3139999999999996em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.8360000000000001em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></span></p></li></ul></li></ul><h4 id=椭圆曲线密码体制><a class=markdownIt-Anchor href=#椭圆曲线密码体制></a> 椭圆曲线密码体制</h4><ul><li>椭圆曲线密码体制依据是定义在椭圆曲线点群上的<strong>离散对数问题</strong>的难解性</li><li>ECC Diffie-Hellman 密钥交换</li></ul><div align=center><img src=/img/post/密码学备忘/ECC_DH.png style=zoom:50%></div><h4 id=用椭圆曲线实现elgamal密码体制><a class=markdownIt-Anchor href=#用椭圆曲线实现elgamal密码体制></a> 用椭圆曲线实现ElGamal密码体制</h4><ul><li><p>密钥生成过程</p><ul><li>用户 A 选择一条椭圆曲线 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>p</mi></msub><mo stretchy=false>(</mo><mi>a</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>E_p(a,b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class=mclose>)</span></span></span></span>，取椭圆曲线上的一个生成元 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span></li><li>用户 A 选择一个正整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>n</mi><mi>A</mi></msub></mrow><annotation encoding=application/x-tex>n_A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">n</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 作为秘密密钥，并生成公开密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>A</mi></msub><mo>=</mo><msub><mi>n</mi><mi>A</mi></msub><mi>G</mi></mrow><annotation encoding=application/x-tex>P_A=n_AG</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">n</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathdefault">G</span></span></span></span></li><li>用户 A 把 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>p</mi></msub><mo stretchy=false>(</mo><mi>a</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>E_p(a,b)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class=mclose>)</span></span></span></span>、 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>A</mi></msub></mrow><annotation encoding=application/x-tex>P_A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span> 传给用户 B</li></ul></li><li><p>加密过程</p><p>Alice要发送消息m给Bob，Alice执行：</p><ol><li>查找 Bob 的公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>E</mi><mo stretchy=false>(</mo><msub><mi>F</mi><mi>q</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>p</mi><mo separator=true>,</mo><mi>n</mi><mo separator=true>,</mo><mi>Q</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(E(F_q),p,n,Q)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">Q</span><span class=mclose>)</span></span></span></span></li><li>将 m 表示成一个域元素 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><msub><mi>F</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>m\in F_q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span></li><li>在区间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>[</mo><mn>1</mn><mi mathvariant=normal>，</mi><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>[1，n-1]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>[</span><span class=mord>1</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>]</span></span></span></span> 内选取一个随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span></li><li>依据 Bob 的公钥计算点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=false>)</mo><mo>=</mo><mi>k</mi><mi>P</mi></mrow><annotation encoding=application/x-tex>(x_1,y_1) =kP</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span> ( <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=application/x-tex>P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span> 相加)</li><li>计算点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo>=</mo><mi>k</mi><mi>Q</mi></mrow><annotation encoding=application/x-tex>(x_2,y_2)=kQ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class="mord mathdefault">Q</span></span></span></span>，如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>x_2=0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span></span></span></span>，则回到第3步</li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi><mo>=</mo><mi>m</mi><mo>∗</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>C=m * x_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.46528em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></li><li>传送加密数据 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=true>,</mo><mi>C</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x_1,y_1,C)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mclose>)</span></span></span></span> 给 Bob</li></ol></li><li><p>解密过程</p><p>Bob收到Alice的密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=true>,</mo><mi>C</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x_1,y_1,C)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mclose>)</span></span></span></span> 后，执行</p><ol><li><p>使用私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>，计算点 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo>=</mo><mi>d</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x_2 , y_2)=d(x_1,y_1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">d</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>，再计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>F</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>F_q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 中 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>x</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mo stretchy=false>?</mo></mrow><annotation encoding=application/x-tex>x_2^{-1}=?</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.120547em;vertical-align:-.266308em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.854239em><span style=top:-2.433692em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style=top:-3.1031310000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.266308em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mclose>?</span></span></span></span></p></li><li><p>通过计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><mi>C</mi><mo separator=true>⋅</mo><msubsup><mi>x</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding=application/x-tex>m=C·x_2^{-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.120547em;vertical-align:-.266308em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mpunct>⋅</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.854239em><span style=top:-2.433692em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style=top:-3.1031310000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.266308em><span></span></span></span></span></span></span></span></span></span>，恢复出明文数据 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span></p></li></ol></li></ul><h4 id=椭圆曲线密码体制的优点><a class=markdownIt-Anchor href=#椭圆曲线密码体制的优点></a> 椭圆曲线密码体制的优点</h4><ul><li>安全性高，椭圆曲线密码体制比基于有限域上的离散对数问题的公钥体制更安全</li><li><strong>密钥量小</strong></li><li>灵活性好：在密钥长度相等的情况下，RSA和ECC的速度相当；但是在相同的安全强度要求下，ECC可以使用较少的位数就可以</li><li>速度快：在密钥长度相等的情况下，RSA和ECC的速度相当；但是在相同的安全强度要求下，ECC可以使用较少的位数就可以</li></ul><h2 id=其他密码体制><a class=markdownIt-Anchor href=#其他密码体制></a> 其他密码体制</h2><h3 id=rabin-密码体制><a class=markdownIt-Anchor href=#rabin-密码体制></a> Rabin 密码体制</h3><ul><li><p>Rabin密码体制有两个特点：</p><ol><li><p>不以一一对应的单向陷门函数为基础，对同一密文，可能有两个以上对应的明文</p></li><li><p>破译该体制与分解大整数是等价的</p></li></ol></li><li><p>密钥产生算法</p><ul><li>随机选择两个大素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo separator=true>,</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>p,q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>，满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>≡</mo><mi>q</mi><mo>≡</mo><mn>3</mn><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mn>4</mn></mrow><annotation encoding=application/x-tex>p\equiv q\equiv 3 \bmod 4</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65819em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.65819em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord>3</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>4</span></span></span></span>，即这两个素数形式为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>4</mn><mi>k</mi><mo>+</mo><mn>3</mn></mrow><annotation encoding=application/x-tex>4k+3</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class=mord>4</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>3</span></span></span></span>；计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>∗</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>n=p*q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.6597200000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>。以 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 作为公钥，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo separator=true>,</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>p,q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 作为密钥。</li></ul></li><li><p>加密</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi><mo>≡</mo><msup><mi>m</mi><mn>2</mn></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>c\equiv m^2 \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.46375em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span></p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 是明文分组，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span> 是对应的密文分组。</p></li><li><p>解密<br>解密即为求解 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>≡</mo><mi>c</mi><mo>≡</mo><msup><mi>m</mi><mn>2</mn></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>x^2\equiv c\equiv m^2 \bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.46375em;vertical-align:0></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>，由 CRT知该方程等价于解方程组：<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>≡</mo><mi>c</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>≡</mo><mi>c</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>q</mi></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=application/x-tex>\begin{cases}x^2\equiv c\bmod p \\x^2\equiv c \bmod q \end{cases}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:3.0000299999999998em;vertical-align:-1.25003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">{</span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.69em><span style=top:-3.69em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault">p</span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">c</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.19em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p></li></ul><h3 id=diffine-hellman密钥交换><a class=markdownIt-Anchor href=#diffine-hellman密钥交换></a> Diffine-Hellman密钥交换</h3><ul><li><p>Diffie-Hellman算法是<strong>第一个公开密钥算法</strong>，发明于1976年。Diffie-Hellman算法能够<strong>用于密钥分配</strong>，但<strong>不能用于加密或解密信息</strong></p></li><li><p>Diffie-Hellman 算法的安全性依赖于有限域上计算离散对数非常困难</p></li><li><p>步骤</p><p>如果A和B想在不安全信道交换密钥，可采用如下步骤：</p><ol><li>A 和 B 协商一个大素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 及 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 的本原根 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span></span></span></span> ， <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 公开</li></ol></li></ul><ol start=2><li>A 秘密产生随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span>，计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>X</mi><mo>=</mo><msup><mi>a</mi><mi>x</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>X=a^x \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>，发送 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>X</mi></mrow><annotation encoding=application/x-tex>X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>X</span></span></span></span> 给 B</li><li>B 秘密产生随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span>，计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Y</mi><mo>=</mo><msup><mi>a</mi><mi>y</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>Y= a^y \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>，发送 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding=application/x-tex>Y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span></span></span></span> 给A</li><li>A 计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>Y</mi><mi>x</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>k=Y^x \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></li><li>B计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>k</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><msup><mi>X</mi><mi>y</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>k&#x27;=X^y \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>k</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>k=k&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></li></ol><ul><li><p><strong>中间人攻击</strong></p><p>Diffie-Hellman密钥交换容易遭受中间人攻击：</p><ol><li><p>A 发送公开值 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>a</mi><mo separator=true>,</mo><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(a, p)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span> 给 B，攻击者 C 截获，并把自己产生的公开值发送给 B</p></li><li><p>B发送公开值给 A，C 截获，把自己的公开值 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msup><mi>a</mi><mo mathvariant=normal>′</mo></msup><mo separator=true>,</mo><msup><mi>p</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(a&#x27;,p&#x27;)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">p</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 发送给 A</p></li><li><p>A 和 C 计算出二人的共享密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mn>1</mn></mrow><annotation encoding=application/x-tex>k1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mord>1</span></span></span></span></p></li><li><p>B 和 C 计算出另外一对共享密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mn>2</mn></mrow><annotation encoding=application/x-tex>k2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mord>2</span></span></span></span></p></li></ol><ul><li>造成中间人攻击的原因是 Diffie-Hellman 密钥交换<strong>不认证对方</strong></li></ul></li></ul><h3 id=elgamal密码体制><a class=markdownIt-Anchor href=#elgamal密码体制></a> ElGamal密码体制</h3><ul><li><p>ElGamal 算法在密码协议中有许多实际应用，安全性基于求解离散对数问题的困难性</p></li><li><p>密钥生成算法</p><ol><li><p>选取一个足够大的素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>，使求解离散对数问题在 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding=application/x-tex>Z_p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 上是困难的；</p></li><li><p>在 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding=application/x-tex>Z_p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 上选择一个本原元 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi></mrow><annotation encoding=application/x-tex>g</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span></span></span></span></p></li><li><p>随机选取整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo stretchy=false>(</mo><mn>0</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>p</mi><mo>−</mo><mn>2</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>k(0≤k≤p-2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mopen>(</span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83041em;vertical-align:-.13597em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>2</span><span class=mclose>)</span></span></span></span>，并计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>g</mi><mi>k</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>y=g^k \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.043548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>;</p><p>公钥为：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo separator=true>,</mo><mi>g</mi><mo separator=true>,</mo><mi>y</mi></mrow><annotation encoding=application/x-tex>p, g, y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span>；私钥为：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span></p></li></ol></li><li><p>加密：Alice 取一个秘密随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi><mo>∈</mo><msub><mi>Z</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>r ∈ Z_{p-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span>，对明文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 加密 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>E</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>r</mi><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>E_k(m,r)=(y_1,y_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><br>　　其中， <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><msup><mi>g</mi><mi>r</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>y_1=g^r\bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>　　<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>m</mi><mo>∗</mo><msup><mi>y</mi><mi>r</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>y_2=m*y^r \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.46528em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></p></li><li><p>解密：Bob 计算</p><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>D</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo>=</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=false>(</mo><msubsup><mi>y</mi><mn>1</mn><mi>k</mi></msubsup><msup><mo stretchy=false>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi><mo>=</mo><mi>m</mi><mo stretchy=false>(</mo><msup><mi>g</mi><mi>k</mi></msup><msup><mo stretchy=false>)</mo><mi>r</mi></msup><mo stretchy=false>(</mo><msup><mi>g</mi><mrow><mi>r</mi><mi>k</mi></mrow></msup><msup><mo stretchy=false>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>m</mi></mrow><annotation encoding=application/x-tex>D_k(y_1,y_2)=y_2(y_1^k)^{-1}\bmod p =m(g^k)^r(g^{rk})^{-1}=m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-2.4518920000000004em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class="mord mathdefault">m</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span></p></li></ul><h2 id=数字签名><a class=markdownIt-Anchor href=#数字签名></a> 数字签名</h2><ul><li><p>数字签名(digital signature)，也称电子签名，是对电子文档利用电子手段进行签名；</p></li><li><p>电子签名必须至少具备手写签名的两个性质，即可验证性与不可伪造性。</p></li><li><p>主要功能：<strong>确认数据单元来源和数据单元的完整性</strong></p><ol><li>确认信息是由签名者发送的</li><li>确认消息自签名后到收到为止，未被修改过</li><li>签名者无法否认签名是由自己发送的</li></ol></li><li><p>数字签名必须具有下列特征：</p><ol><li><p>能验证签名者、签名日期和时间；</p></li><li><p>能认证被签的消息内容；</p></li><li><p>能由第三方仲裁，以解决争执。</p></li></ol><p>简单说，<strong>数字签名是个加密的过程，数字签名的验证是一个解密的过程</strong>。</p></li></ul><h3 id=签名方案><a class=markdownIt-Anchor href=#签名方案></a> 签名方案</h3><p>一个签名方案是一个 5 元组 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>M</mi><mo separator=true>,</mo><mi>A</mi><mo separator=true>,</mo><mi>K</mi><mo separator=true>,</mo><mi>S</mi><mo separator=true>,</mo><mi>V</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(M,A, K,S,V)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">A</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=mclose>)</span></span></span></span> ,满足如下的条件：</p><ol><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 是一个可能消息的有限集；</li><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>A</mi></mrow><annotation encoding=application/x-tex>A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">A</span></span></span></span> 是一个可能签名的有限集；</li><li>密钥空间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span> 是一个可能密钥的有限集；</li><li>对每一个 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>k</mi><mn>1</mn></msub><mi mathvariant=normal>，</mi><msub><mi>k</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo>∈</mo><mi>K</mi></mrow><annotation encoding=application/x-tex>k=(k_1，k_2)\in K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span>，都对应一个签名算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mi>i</mi><msub><mi>g</mi><msub><mi>K</mi><mn>2</mn></msub></msub><mo>∈</mo><mi>S</mi></mrow><annotation encoding=application/x-tex>Sig_{K_2}\in S</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.93343em;vertical-align:-.2501em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault">i</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span></span> 和验证算法 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>V</mi><mi>e</mi><msub><mi>r</mi><msub><mi>K</mi><mn>1</mn></msub></msub><mo>∈</mo><mi>V</mi></mrow><annotation encoding=application/x-tex>Ver_{K_1} \in V</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.93343em;vertical-align:-.2501em></span><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class="mord mathdefault">e</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>V</span></span></span></span>。</li></ol><ul><li>每一个 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mi>i</mi><mi>g</mi><mo>:</mo><mi>M</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding=application/x-tex>Sig: M\rightarrow A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>→</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">A</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>V</mi><mi>e</mi><mi>r</mi><mo>:</mo><mi>M</mi><mo>→</mo><mo stretchy=false>{</mo><mi>T</mi><mi>R</mi><mi>U</mi><mi>E</mi><mo separator=true>,</mo><mi>F</mi><mi>A</mi><mi>L</mi><mi>S</mi><mi>E</mi><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>Ver: M\rightarrow \{TRUE,FALSE\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>→</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class="mord mathdefault" style=margin-right:.10903em>U</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class="mord mathdefault">A</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mclose>}</span></span></span></span> 是一个对每一个消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>∈</mo><mi>M</mi></mrow><annotation encoding=application/x-tex>x \in M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 和每一个签名 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding=application/x-tex>y\in A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7335400000000001em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">A</span></span></span></span> 满足下列方程的函数：<p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>V</mi><mi>e</mi><msub><mi>r</mi><mrow><mi>K</mi><mn>1</mn></mrow></msub><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo><mo>=</mo><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>T</mi><mi>R</mi><mi>U</mi><mi>E</mi><mo separator=true>,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>i</mi><mi>f</mi><mspace width=1em><mi>y</mi><mo>=</mo><mi>S</mi><mi>i</mi><msub><mi>g</mi><msub><mi>K</mi><mn>2</mn></msub></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>F</mi><mi>A</mi><mi>L</mi><mi>S</mi><mi>E</mi><mo separator=true>,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>i</mi><mi>f</mi><mspace width=1em><mi>y</mi><mi mathvariant=normal>≠</mi><mi>S</mi><mi>i</mi><msub><mi>g</mi><msub><mi>K</mi><mn>2</mn></msub></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mspace></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=application/x-tex>Ver_{K1}(x,y)=\begin{cases} TRUE, &amp; if \quad y= Sig_{K_2}(x)\\ FALSE, &amp; if\quad y\neq Sig_{K_2}(x) \end{cases}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class="mord mathdefault">e</span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:3.0000299999999998em;vertical-align:-1.25003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">{</span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.69em><span style=top:-3.69em><span class=pstrut style=height:3.008em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class="mord mathdefault" style=margin-right:.10903em>U</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mpunct>,</span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class="mord mathdefault">A</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=mpunct>,</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.19em><span></span></span></span></span></span><span class=arraycolsep style=width:1em></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.69em><span style=top:-3.69em><span class=pstrut style=height:3.008em></span><span class=mord><span class="mord mathdefault">i</span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mspace style=margin-right:1em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault">i</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class="mord mathdefault">i</span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mspace style=margin-right:1em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault">i</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.19em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul><ol start=5><li>对每一个 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>，函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mi>i</mi><mi>g</mi></mrow><annotation encoding=application/x-tex>Sig</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style=margin-right:.03588em>g</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>V</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding=application/x-tex>Ver</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span> 都是多项式时间可计算的函数。<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>V</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding=application/x-tex>Ver</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span> 是一个公开函数，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>k_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 称作公钥；而 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mi>i</mi><mi>g</mi></mrow><annotation encoding=application/x-tex>Sig</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style=margin-right:.03588em>g</span></span></span></span> 是一个秘密函数，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>k_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 称作私钥，由用户秘密地保存。</li></ol><h3 id=数字签名的安全性><a class=markdownIt-Anchor href=#数字签名的安全性></a> 数字签名的安全性</h3><ul><li><p>攻击者能力</p><ul><li>唯密钥攻击：攻击者C只拥有签名者A的公钥。</li><li>消息攻击<ul><li>已知消息攻击：C拥有一些消息与相应的签名.</li><li>一般选择消息攻击：在攻击A的签名方案之前，C首先选择一些消息，而无需知道A的公钥。C对于选择的消息从A处获得合法签名。</li><li>定向选择消息攻击：攻击者在掌握A的公钥之后，在签名生成之前选择消息。</li><li>适应性选择消息攻击：允许C将A作为“oracle”进行轮询。</li></ul></li></ul></li><li><p>敌手的目标：伪造签名</p><ul><li>完全攻破：C找到A的私钥d.</li><li>通用伪造：C掌握一个有效的签名算法，使得对于任意消息都能够等价地构造出合法签名。</li><li>选择伪造：C对于所选特定消息能够为找出合法签名。</li><li>存在性伪造：C至少可伪造出一个消息的合法签名，但C不能控制该消息的选择。这种伪造对于A的危害最低。</li></ul></li></ul><h4 id=数字签名的设计目标><a class=markdownIt-Anchor href=#数字签名的设计目标></a> 数字签名的设计目标</h4><ul><li>签名必须是与消息相关的二进制位串；</li><li>签名必须使用发送方某些独有的信息，以防伪造和否认；</li><li><strong>产生数字签名比较容易；</strong></li><li>识别和验证签名比较容易；</li><li><strong>伪造数字签名计算上不可行</strong>，无论攻击者采用何种方法（利用数字签名伪造报文，或者对报文伪造数字签名）。</li><li>保存数字签名的副本是可行的。</li></ul><h4 id=数字签名的解决方案><a class=markdownIt-Anchor href=#数字签名的解决方案></a> 数字签名的解决方案</h4><ul><li><p>直接数字签名方案</p><ul><li>技术上仅涉及到通信双方</li><li>发送方可以声称自己的私钥丢失或被盗用，而否认其发送过某个报文<ul><li>改进：每个签名报文中包含一个时间戳</li></ul></li></ul></li><li><p>基于仲裁的数字签名方案</p><ul><li>通过引入仲裁来解决直接签名方案中的问题</li><li>基本工作方式<ol><li>每个从X发往Y的签名报文首先被送给仲裁者 A</li><li>A 检验该报文及其签名的出处和内容，然后对报文注明日期，并附加上一个“仲裁证实”的标记发给 Y</li></ol></li></ul></li></ul><h3 id=常见的数字签名算法><a class=markdownIt-Anchor href=#常见的数字签名算法></a> 常见的数字签名算法</h3><h4 id=elgamal-数字签名><a class=markdownIt-Anchor href=#elgamal-数字签名></a> Elgamal 数字签名</h4><ul><li>ElGamal 签名方案由 T.ElGamal 于1985年提出，其安全性主要基于有限域上离散对数问题的难解性。</li><li>是 ElGamal 公钥密码体制的直接应用。</li><li>一般 ElGamal 签名方案<ul><li>系统初始化<br>设 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 是一大素数，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi></mrow><annotation encoding=application/x-tex>g</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span></span></span></span> 是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding=application/x-tex>Z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span></span></span></span> 的一个生成元，A执行如下：<ol><li>生成随机整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>x</mi><mo>&lt;</mo><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>1&lt;x&lt;p-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68354em;vertical-align:-.0391em></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>;</li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>y= g^x \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>;</li><li>A 的私钥是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span>，A的公钥是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>y</mi><mo separator=true>,</mo><mi>p</mi><mo separator=true>,</mo><mi>g</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(y,p,g)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mclose>)</span></span></span></span></li></ol></li><li>签名算法<br>对于待签消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span>，用户 A 计算：<ol><li>Hash 值 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><mi>H</mi><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>m=H(M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span>;</li><li>选择随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>，计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>=</mo><msup><mi>g</mi><mi>k</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>S_1=g^k \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.043548em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>; 计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><mi>m</mi><mo>−</mo><mi>x</mi><mi>S</mi><mn>1</mn><mo stretchy=false>)</mo><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mo stretchy=false>(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>S_2=k^{-1}(m-xS1) \bmod (p-1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">x</span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span></span></span></span></li><li>签名为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mi>i</mi><mi>g</mi><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>m</mi><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><msub><mi>S</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>S</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Sig(x,m)=(S_1,S_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">m</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></li></ol></li><li>验证算法<ul><li>任意接收方验证如下：<ol><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>V</mi><mn>1</mn></msub><mo>=</mo><msup><mi>g</mi><mi>m</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>V_1=g^m \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>V</mi><mn>2</mn></msub><mo>=</mo><msup><mi>y</mi><msub><mi>S</mi><mn>1</mn></msub></msup><mo stretchy=false>(</mo><msub><mi>S</mi><mn>1</mn></msub><msup><mo stretchy=false>)</mo><msub><mi>S</mi><mn>2</mn></msub></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>V_2=y^{S_1}(S_1)^{S_2} \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0913309999999998em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413309999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.05764em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413309999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31731428571428577em><span style=top:-2.357em;margin-left:-.05764em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></li></ol></li><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>V</mi><mn>1</mn></msub><mo>=</mo><msub><mi>V</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>V_1=V_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，则签名合法</li></ul></li></ul></li></ul><h4 id=schnorr数字签名><a class=markdownIt-Anchor href=#schnorr数字签名></a> Schnorr数字签名</h4><ul><li><p>密钥生成算法</p><ol><li>选择素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo separator=true>,</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>p,q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>，使得 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>p-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 的素因子</li><li>选择整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi></mrow><annotation encoding=application/x-tex>g</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span></span></span></span>，使得 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>g</mi><mi>q</mi></msup><mo>=</mo><mn>1</mn><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>g^q=1\bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.858832em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>。值 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi><mo separator=true>,</mo><mi>p</mi></mrow><annotation encoding=application/x-tex>g,p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 构成全局公钥参数，在用户组内的每个用户都可取此值</li><li>选择随机整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>s</mi><mo>&lt;</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>0&lt;s&lt;q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68354em;vertical-align:-.0391em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>，作为用户的私钥</li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>v</mi><mo>=</mo><msup><mi>g</mi><mrow><mo>−</mo><mi>s</mi></mrow></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>v= g^{-s} \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03588em>v</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.9657709999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.771331em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>，作为用户公钥</li></ol></li><li><p>签名算法</p><ol><li><p>对于待签消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><mi>Z</mi></mrow><annotation encoding=application/x-tex>m∈Z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>Z</span></span></span></span>，选择随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi><mo stretchy=false>(</mo><mn>0</mn><mo>&lt;</mo><mi>r</mi><mo>&lt;</mo><mi>q</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>r(0&lt;r&lt;q)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span></span></span></span>，计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>g</mi><mi>r</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>x=g^r\bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>（与待签名消息无关，可以预处理）</p></li><li><p>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi><mo>=</mo><mi>h</mi><mo stretchy=false>(</mo><mi>m</mi><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>e=h(m||x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">h</span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mord>∣</span><span class=mord>∣</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span></p></li><li><p>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>r</mi><mo>+</mo><mi>s</mi><mi>e</mi><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>q</mi></mrow><annotation encoding=application/x-tex>y=r+se \bmod q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span></p></li><li><p>发送签名对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>e</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(e,y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">e</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span></span></span></span>。</p></li></ol></li><li><p>验证算法</p><ol><li>收方收到消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 和数字签名 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>e</mi><mo separator=true>,</mo><mi>s</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(e,s)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">e</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">s</span><span class=mclose>)</span></span></span></span></li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><msup><mi>g</mi><mi>y</mi></msup><msup><mi>v</mi><mi>e</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>x&#x27;=g^yv^e \bmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span></span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>v</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span></li><li>验证是否 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi><mo stretchy=false>(</mo><mi>m</mi><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><msup><mi>x</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo><mo>=</mo><mi>e</mi></mrow><annotation encoding=application/x-tex>h(m||x&#x27;)=e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class="mord mathdefault">h</span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mord>∣</span><span class=mord>∣</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span></span></span></span></li></ol><p>※ ：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi></mrow><annotation encoding=application/x-tex>||</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class=mord>∣</span></span></span></span> 表示级联</p></li></ul><h5 id=schnorr数字签名方案的安全性分析><a class=markdownIt-Anchor href=#schnorr数字签名方案的安全性分析></a> Schnorr数字签名方案的安全性分析</h5><ul><li><p>EIGAMAL系统中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi></mrow><annotation encoding=application/x-tex>g</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span></span></span></span> 为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding=application/x-tex>Z_p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 中的本原元，而 Schnorr 系统中则不是。</p><ul><li>从安全角度看，ElGamal 安全性较高，这是因为本原元的阶为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>p-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> ，而 Schnorr 系统中 g 的阶为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>，在此阶下，基于LP的体制是否安全有待进一步研究。</li></ul></li><li><p>Schnorr 系统的签名文较短，e 的长度由函数 h 决定。</p></li></ul><h4 id=数字签名标准dsa算法><a class=markdownIt-Anchor href=#数字签名标准dsa算法></a> 数字签名标准DSA算法</h4><ul><li>DSA的安全性主要依赖于有限域上离散对数问题的难解性，是 ElGamal 签名算法的变种</li><li>步骤</li></ul><p>※：对每一个报文需要选择不同的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span></p><div align=center><img src=/img/post/密码学备忘/DSA算法.png style=zoom:67%></div><h4 id=rsa和相关签名方案><a class=markdownIt-Anchor href=#rsa和相关签名方案></a> RSA和相关签名方案</h4><h5 id=rsa签名方案><a class=markdownIt-Anchor href=#rsa签名方案></a> RSA签名方案</h5><ul><li><p>初始化阶段<br>实体 A 执行如下操作：</p><ol><li>随机产生大小相近的两个不同大素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span></li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>n=p×q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span>，其欧拉函数值 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo><mo stretchy=false>(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\varphi(n)=(p-1)(q-1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span></span></span></span>；</li><li>随机选一整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi></mrow><annotation encoding=application/x-tex>e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">e</span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>≤</mo><mi>e</mi><mo>≤</mo><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>1\leq e\leq\varphi(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78041em;vertical-align:-.13597em></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7719400000000001em;vertical-align:-.13597em></span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> ，满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=false>(</mo><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>e</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>gcd(\varphi(n), e)=1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class=mopen>(</span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>；</li><li>利用扩展的欧几里德算法，计算惟一的整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>， <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>d</mi><mo>&lt;</mo><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>1&lt; d &lt; \varphi(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68354em;vertical-align:-.0391em></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>,满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi><mi>e</mi><mo>≡</mo><mn>1</mn><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>φ</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>de \equiv 1 \bmod \varphi(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≡</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">φ</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> ；</li><li>公钥为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>e</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(n,e)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mclose>)</span></span></span></span> ；私钥为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>。( <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>,<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span> 不再需要，可以销毁)</li></ol></li><li><p>签名生成算法</p><ol><li>计算取值在区间 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>[</mo><mn>0</mn><mo separator=true>,</mo><mi>𝑛</mi><mo>−</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>[0,𝑛-1]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>[</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>]</span></span></span></span> 内的整数 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>R</mi><mo stretchy=false>(</mo><mi>𝑚</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>m&#x27;=R(𝑚)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span></li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi><mo>=</mo><mo stretchy=false>(</mo><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><msup><mo stretchy=false>)</mo><mi>𝑑</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi mathvariant=normal>⁡</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>s=(m&#x27;)^𝑑 \bmod⁡ n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=mord>⁡</span><span class="mord mathdefault">n</span></span></span></span></li><li>A 对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的签名为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span></li></ol></li><li><p>签名验证算法</p><p>为验证A的签名 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 且恢复消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span>，B执行如下操作：</p><ol><li>获得A的可信公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>e</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(n,e)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">e</span><span class=mclose>)</span></span></span></span></li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><msup><mi>s</mi><mi>e</mi></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi mathvariant=normal>⁡</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>m&#x27;=s^e \bmod⁡ n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=mord>⁡</span><span class="mord mathdefault">n</span></span></span></span></li><li>验证 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo>∈</mo><msub><mi>M</mi><mi>R</mi></msub></mrow><annotation encoding=application/x-tex>m&#x27;\in M_R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.790992em;vertical-align:-.0391em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>;否则拒绝接受签名</li><li>4.恢复 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>m=R^{-1} (m&#x27;)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></li></ol></li><li><p>扩展：带消息恢复的 RSA 数字签名、带附录的 RSA 数字签名</p></li></ul><h4 id=rabin公钥签名方案><a class=markdownIt-Anchor href=#rabin公钥签名方案></a> Rabin公钥签名方案</h4><ul><li>密钥生成：每个实体生成各自的公钥和相应私钥。<br>实体A执行如下操作：<ol><li>随机产生两个不同的大素数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span></li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>∗</mo><mi>q</mi></mrow><annotation encoding=application/x-tex>n=p*q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.6597200000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span></span></span></span></li><li>A 的公钥是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>，私钥是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>p</mi><mo separator=true>,</mo><mi>q</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(p,q)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">p</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>q</span><span class=mclose>)</span></span></span></span></li></ol></li><li>签名生成：实体 A 签署消息 m<ol><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>R</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>m&#x27;=R(m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mopen>(</span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span></li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>n</mi><mo stretchy=false>)</mo></mspace></mspace></mrow><annotation encoding=application/x-tex>m&#x27;\pmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span> 的一个平方根 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span></li><li>A 对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的签名是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span></li></ol></li><li>验证：为验证签名s且恢复消息m，B执行如下操作<ol><li>获得公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span></li><li>计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><msup><mi>s</mi><mn>2</mn></msup><mtext> </mtext><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>m&#x27;=s^2\bmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span><span class=mbin><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mspace style=margin-right:.05555555555555555em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span></li><li>验证 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo>∈</mo><msub><mi>M</mi><mi>R</mi></msub></mrow><annotation encoding=application/x-tex>m&#x27;\in M_R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.790992em;vertical-align:-.0391em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>；否则拒绝接受签名</li><li>恢复 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><msup><mi>m</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>m=R^{-1}(m&#x27;)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></li></ol></li></ul><h4 id=具有特殊功能的数字签名><a class=markdownIt-Anchor href=#具有特殊功能的数字签名></a> 具有特殊功能的数字签名</h4><ul><li><p>盲签名</p><ul><li>需要盲签名的情形：当 Bob 想让 Alice 对一个文档签名，但他又不想让 Alice 知道这个文档的内容，且 Alice 在签署文档后不能将这次签名追踪到 Bob 时需要盲签名.</li><li>盲签名的步骤：<ol><li>Bob 对要签署的消息进行盲化</li><li>Alice 对盲化过的消息进行签名</li><li>Bob 进行脱盲恢复原来消息的签名</li></ol></li><li>应用：电子选举</li></ul></li><li><p>群签名</p><ul><li><p>群签名具有三个性质:</p><ol><li>群里的任何人都可以群的名义对文档签名；</li><li>签名的接受者可以验证签名是这个群的合法签名,但不知道它是群中哪个成员所为,</li><li>如遇争执,一个可信机构能识别出那个签名者</li></ol></li><li><p>一个群签名方案</p><ol><li><p>部门经理(相当于可信机构)选定本部门(群)的公钥方案，比如RSA，然后为每个成员选定若干私钥并告知他，再将群里每个成员的公钥随机排列成一表并公布。</p></li><li><p>每个成员在打印的时候，随机选择一个私钥进行签名，每个私钥只能使用一次，否则验证者可将这些签名联系起来。</p></li><li><p>签名接受者收到一个群签名，使用这个群的公钥列表一个个验证，只要有一个公钥通过验证，则是合法签名，否则非法。</p></li><li><p>发生争执，部门经理能找出具体的签名者。</p></li></ol></li></ul></li><li><p>代理签名</p><ul><li>现实中，利用印章签名可实现代理，即印章的拥有者将印章给别人。当自己有事的时候，这个人就可以对文件盖章相当于以他的名义对文件签名。</li><li>所谓代理签名是指：在一个代理签名方案中，一个代理签名者可代表原始签名者生成有效的签名。</li></ul></li><li><p>门限数字签名</p><ul><li>门限数字签名体制是面向组织或团体的签名体制，能解决如何由集体而非个人进行数字签名的问题，是数字签名体制研究的重要分支。</li></ul></li><li><p>批验证协议</p><ul><li>安全的批验证协议需满足如下的条件：<ol><li>签名者在签名过程中一次产生多个消息的签名；</li><li>多个签名的有效性由签名验证者一次验证完成；</li><li>多个有效的签名一定满足批验证协议中的批验证原则；</li><li>在批验证协议中有效的多个签名一定是有效的签名。</li></ol></li></ul></li></ul><h2 id=密码学-hash-函数><a class=markdownIt-Anchor href=#密码学-hash-函数></a> 密码学 Hash 函数</h2><h3 id=hash-函数的定义><a class=markdownIt-Anchor href=#hash-函数的定义></a> Hash 函数的定义</h3><ul><li><p>Hash函数也叫散列函数、哈希函数、杂凑函数</p></li><li><p>哈希函数是一公开函数，通常记为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span>，用于将任意长的消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 映射为较短的、固定长度的一个值，记为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span></p></li><li><p>对于大的输入集合使用该函数，产生的输出结果均匀地分布且看起来随机</p></li><li><p>Hash函数首要目标是<strong>保证数据的完整性</strong>，对于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 任何一位或几位的改变都将极大可能改变其hash码</p></li><li><p>从密码角度看，散列函数可看作是一种<strong>单向密码体制</strong></p></li><li><p>找到两个不同的数据块对应相同的Hash值在计算上不可行</p></li></ul><h3 id=hash-函数的应用><a class=markdownIt-Anchor href=#hash-函数的应用></a> Hash 函数的应用</h3><h4 id=消息认证><a class=markdownIt-Anchor href=#消息认证></a> 消息认证</h4><ul><li><p>是用来验证消息完整性的一种机制或服务</p></li><li><p>确保收到的数据确实和发送时的一样（即没有修改、插入、删除或重放），且发送方声称的身份真实有效</p></li><li><p>当哈希函数用于提供消息认证功能时，Hash函数值通常称为<strong>消息摘要</strong></p></li><li><p>一般通过使用消息认证码（MAC）实现，即带密钥的Hash函数</p><p>广泛应用于文件传输（如网络文件下载）</p></li><li><p>利用 Hash 函数检查数据完整性</p><ul><li>在该例中，Hash 函数必须得到保护，否则，Darth 拦截了该消息后，篡改其中的数据，然后重新计算 Hash 值并附在后面。<strong>Bob 无法发现消息被篡改了</strong>。</li></ul></li></ul><div align=center><img src=img/Hash消息认证.png style=zoom:50%></div><ul><li><p>几种可行的改进方法</p><div align=center><img src=/img/post/密码学备忘/Hash消息认证改进.png style=zoom:67%></div></li></ul><p>（a）消息与 Hash 值链接后用单钥加密算法加密</p><ul><li>有保密性</li></ul><p>（b）用单钥加密算法仅对 Hash 值加密</p><ul><li>无保密性</li></ul><p>（c）使用共享秘密值 S</p><ul><li>无保密性，但是敌手由于不知道 S，无法产生假消息</li></ul><p>（d）在（c）的基础上，对整个消息和 Hash 值加密</p><ul><li>有保密性</li></ul><h4 id=数字签名-2><a class=markdownIt-Anchor href=#数字签名-2></a> 数字签名</h4><ul><li><p>使用用户的私钥加密消息的Hash值，其它任何知道该用户公钥的人通过数字签名验证消息的完整性。</p></li><li><p>攻击者要想篡改消息，则需要知道用户私钥。</p></li><li><p>优点：</p><ul><li>提高签名速度——可以预处理消息的Hash值</li><li>可以不泄露签名所对应的消息</li></ul></li><li><p>利用 Hash 函数进行数字签名</p></li></ul><div align=center><img src=/img/post/密码学备忘/Hash数字签名.png style=zoom:50%></div><h4 id=其他应用><a class=markdownIt-Anchor href=#其他应用></a> 其他应用</h4><ul><li>产生单向口令文件:<br>如操作系统存储口令的Hash值而不是口令本身，大多数操作系统都采用了这种口令保护机制</li><li>入侵检测和病毒检测：<br>将每个文件的Hash值 H(F) 存储在安全系统中，随后就能够通过重新计算 H(F) 来判断文件是否被修改过</li><li>构建随机函数（PRF）或用做伪随机发生器</li></ul><h3 id=hash-函数安全性><a class=markdownIt-Anchor href=#hash-函数安全性></a> Hash 函数安全性</h3><ul><li>原像：对于 Hash 函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>h=H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span>，称 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 原像。</li><li>碰撞：因为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 是多对一映射，所以对于任意给定的 Hash 值 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi></mrow><annotation encoding=application/x-tex>h</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span></span></span></span>，对应有多个原像。如果满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mi mathvariant=normal>≠</mi><mi>y</mi></mrow><annotation encoding=application/x-tex>x≠y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span> 且 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mi>H</mi><mo stretchy=false>(</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(x)=H(y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span></span></span></span>，则称出现碰撞。</li><li>假设函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 的输入消息或数据块长度是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=application/x-tex>b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span> 位，输出的长度为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 位，且 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>b&gt;n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.73354em;vertical-align:-.0391em></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>，则平均每个 Hash 值对应 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mrow><mi>b</mi><mo>−</mo><mi>n</mi></mrow></msup></mrow><annotation encoding=application/x-tex>2^{b-n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8491079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> 个原像。</li><li>若输入长度不限，则每个hash值对应原像个数将更大。</li></ul><h4 id=hash-函数的安全性需求><a class=markdownIt-Anchor href=#hash-函数的安全性需求></a> Hash 函数的安全性需求</h4><table><thead><tr><th><strong>需求</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>输入长度可变</td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 可应用于任意大小的数据块</td></tr><tr><td>输出长度固定</td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 产生定长的输出</td></tr><tr><td>效率</td><td>对于任意给定的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span>，计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 比较容易，用软件和硬件均可实现</td></tr><tr><td>单向性</td><td>对于任意给定的 Hash 码 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi></mrow><annotation encoding=application/x-tex>h</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span></span></span></span>，找到满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>y</mi><mo stretchy=false>)</mo><mo>=</mo><mi>h</mi></mrow><annotation encoding=application/x-tex>H(y)=h</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span></span></span></span> 的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span> 在计算上是不可行的</td></tr><tr><td>抗弱碰撞性</td><td>对任意给定的分块 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span>，找到满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mi mathvariant=normal>≠</mi><mi>x</mi></mrow><annotation encoding=application/x-tex>y≠x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 且 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>y</mi><mo stretchy=false>)</mo><mo>=</mo><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(y)=H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span> 在计算上是不可行的</td></tr><tr><td>抗强碰撞性</td><td>找到任何满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>y</mi><mo stretchy=false>)</mo><mo>=</mo><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(y)=H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 的偶对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x,y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span></span></span></span> 在计算上是不可行的</td></tr><tr><td>伪随机性</td><td><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 的输出满足伪随机性测试标准</td></tr></tbody></table><p>※：一个函数如果是抗强碰撞的，那么同时也是抗弱碰撞的，单反之不一定成立。一个函数可以是抗强碰撞的，但不一定是抗原像攻击的，反之亦然；一个函数可以是抗弱碰撞的，但不一定是抗原像攻击的，反之亦然。</p><h5 id=不同应用下的-hash-函数的安全需求><a class=markdownIt-Anchor href=#不同应用下的-hash-函数的安全需求></a> 不同应用下的 Hash 函数的安全需求</h5><table><thead><tr><th></th><th><strong>抗原象攻击</strong></th><th><strong>抗弱碰撞攻击</strong></th><th><strong>抗强碰撞攻击</strong></th></tr></thead><tbody><tr><td>Hash+数字签名</td><td>是</td><td>是</td><td>是*</td></tr><tr><td>入侵病毒和病毒检测</td><td></td><td>是</td><td></td></tr><tr><td>Hash+对称加密</td><td></td><td></td><td></td></tr><tr><td>单向口令文件</td><td>是</td><td></td><td></td></tr><tr><td>MAC</td><td>是</td><td>是</td><td>是*</td></tr></tbody></table><p>※：标 * 处要求攻击者能够实现选择消息攻击</p><h3 id=攻击-hash-函数><a class=markdownIt-Anchor href=#攻击-hash-函数></a> 攻击 Hash 函数</h3><ul><li><p>Hash函数的安全性取决于其<strong>抗击各种攻击</strong>的能力。</p></li><li><p>攻击杂凑函数的原理是：伪造消息，使其与原来消息的杂凑码相同</p></li><li><p>常见的攻击方法：穷举攻击、密码分析</p><ul><li><p>穷举攻击：不依赖于任何算法细节，仅与Hash值长度有关；</p><ul><li><p>原像攻击和第二原像攻击（弱碰撞攻击）</p></li><li><p>碰撞攻击：</p><ul><li><p>生日攻击法：没有利用Hash函数的结构和任何代数弱性质，只依赖于Hash值的长度。</p></li><li><p>中点交会攻击法：是生日攻击的一种变形，不比较Hash值，而是比较链中的中间变量，适用于攻击具有分组链结构的Hash方案。</p></li></ul></li></ul></li><li><p>密码分析：依赖于具体算法的设计缺点，主要集中在：</p><ul><li>对迭代型Hash函数的压缩函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi></mrow><annotation encoding=application/x-tex>f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span></span></span></span> 的内部结构的分析，</li><li>试图找到能由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi></mrow><annotation encoding=application/x-tex>f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span></span></span></span> 的单步执行产生碰撞的有效方法。</li></ul></li></ul></li></ul><h4 id=穷举攻击><a class=markdownIt-Anchor href=#穷举攻击></a> 穷举攻击</h4><h5 id=第一类生日攻击><a class=markdownIt-Anchor href=#第一类生日攻击></a> 第一类生日攻击</h5><ul><li><p>相关问题<br>已知一散列函数 H 有 n 个可能的输出，<strong>H(x) 是一个特定的输出</strong>，如果对 H 随机取 k 个输入，则至少有一个输入 y 使得 H(y)=H(x) 的概率为 0.5 时，k 有多大？<br>为叙述方便，称对散列函数 H 寻找上述 y 的攻击为<strong>第Ⅰ类生日攻击</strong>。</p></li><li><p>解答：</p><p>因为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 个可能的输出，所以输入 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span> 产生的输出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>y</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(y)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span></span></span></span> 等于<strong>特定输出</strong> <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 的概率是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mi mathvariant=normal>/</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>1/n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mord>/</span><span class="mord mathdefault">n</span></span></span></span>，即<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>y</mi><mo stretchy=false>)</mo><mi mathvariant=normal>≠</mi><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(y)≠H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 的概率是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant=normal>/</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>1-1/n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mord>/</span><span class="mord mathdefault">n</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span> 取 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个随机值而函数的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个输出中没有一个等于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span>，其概率等于每个输出都不等于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 的概率之积，为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant=normal>/</mi><mi>n</mi><msup><mo stretchy=false>)</mo><mi>k</mi></msup></mrow><annotation encoding=application/x-tex>(1-1/n)^k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class=mord>1</span><span class=mord>/</span><span class="mord mathdefault">n</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span></span></span>，<br>所以，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span> 取 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个随机值得到函数的k个输出中至少有一个等于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span></span></span></span> 的概率为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>−</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant=normal>/</mi><mi>n</mi><msup><mo stretchy=false>)</mo><mi>k</mi></msup></mrow><annotation encoding=application/x-tex>1-(1-1/n)^k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class=mord>1</span><span class=mord>/</span><span class="mord mathdefault">n</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span></span></span>。<br>由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mn>1</mn><mo>+</mo><mi>x</mi><msup><mo stretchy=false>)</mo><mi>k</mi></msup><mo>≈</mo><mn>1</mn><mo>+</mo><mi>k</mi><mi>x</mi></mrow><annotation encoding=application/x-tex>(1+x)^k≈1+kx</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class="mord mathdefault">x</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class="mord mathdefault">x</span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>x</mi><mi mathvariant=normal>∣</mi><mo>&lt;</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>|x|&lt;&lt;1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class="mord mathdefault">x</span><span class=mord>∣</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>，可得<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>−</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant=normal>/</mi><mi>n</mi><msup><mo stretchy=false>)</mo><mi>k</mi></msup><mo>≈</mo><mn>1</mn><mo>−</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mi>k</mi><mi mathvariant=normal>/</mi><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mi>k</mi><mi mathvariant=normal>/</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>1-(1-1/n)^k≈1-(1-k/n)=k/n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.099108em;vertical-align:-.25em></span><span class=mord>1</span><span class=mord>/</span><span class="mord mathdefault">n</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mord>/</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mord>/</span><span class="mord mathdefault">n</span></span></span></span></p><p>若使上述概率等于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0.5</mn></mrow><annotation encoding=application/x-tex>0.5</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>.</span><span class=mord>5</span></span></span></span>，则 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mi>n</mi><mi mathvariant=normal>/</mi><mn>2</mn></mrow><annotation encoding=application/x-tex>k=n/2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class=mord>/</span><span class=mord>2</span></span></span></span>。<br>特别地，如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 的输出为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 比特长，即可能的输出个数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>m</mi></msup></mrow><annotation encoding=application/x-tex>n=2^m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span></span></span></span>，则 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=application/x-tex>k=2^{m-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>。</p></li></ul><h5 id=生日攻击><a class=markdownIt-Anchor href=#生日攻击></a> 生日攻击</h5><ul><li><p>生日悖论<br>生日悖论是考虑这样一个问题：</p><p>——在k个人中至少有两个人的生日相同的概率大于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>0.5</mn></mrow><annotation encoding=application/x-tex>0.5</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>.</span><span class=mord>5</span></span></span></span> 时，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 至少多大？</p><p>为了回答这一问题，首先定义下述概率：<br>设有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个整数项，每一项都在 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn></mrow><annotation encoding=application/x-tex>1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 之间等可能地取值，则 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个整数项中至少有两个取值相同的概率为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>k</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P(n, k)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span></span></span></span>。<br>生日悖论就是求使得 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><mn>365</mn><mo separator=true>,</mo><mi>k</mi><mo stretchy=false>)</mo><mo>≥</mo><mn>0.5</mn></mrow><annotation encoding=application/x-tex>P(365,k)≥0.5</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class=mord>3</span><span class=mord>6</span><span class=mord>5</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≥</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>.</span><span class=mord>5</span></span></span></span> 的最小 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>。</p></li><li><p>当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mn>23</mn></mrow><annotation encoding=application/x-tex>k=23</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span><span class=mord>3</span></span></span></span> 时，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><mn>365</mn><mo separator=true>,</mo><mn>23</mn><mo stretchy=false>)</mo><mo>=</mo><mn>0.5073</mn></mrow><annotation encoding=application/x-tex>P(365,23)=0.5073</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class=mord>3</span><span class=mord>6</span><span class=mord>5</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>2</span><span class=mord>3</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>.</span><span class=mord>5</span><span class=mord>0</span><span class=mord>7</span><span class=mord>3</span></span></span></span>，即上述问题只需 23人，<strong>人数如此之少</strong>。<br>当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding=application/x-tex>k=100</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mord>0</span><span class=mord>0</span></span></span></span> 时，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><mn>365</mn><mo separator=true>,</mo><mn>100</mn><mo stretchy=false>)</mo><mo>=</mo><mn>0.9999997</mn></mrow><annotation encoding=application/x-tex>P(365,100)=0.9999997</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class=mord>3</span><span class=mord>6</span><span class=mord>5</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mord>0</span><span class=mord>0</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>.</span><span class=mord>9</span><span class=mord>9</span><span class=mord>9</span><span class=mord>9</span><span class=mord>9</span><span class=mord>9</span><span class=mord>7</span></span></span></span>，即获得如此大的概率！</p></li><li><p>之所以称这一问题是悖论，是因为当人数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 给定时，得到的至少有两个人的生日相同的概率比想象的要大得多。这是因为在k个人中考虑的是<strong>任意两个人的生日是否相同</strong>，在23个人中可能的情况数为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mi>𝐶</mi><mn>23</mn><mn>2</mn></msubsup><mo>=</mo><mn>253</mn></mrow><annotation encoding=application/x-tex>𝐶_{23}^2=253</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0622159999999998em;vertical-align:-.24810799999999997em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-2.4518920000000004em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.24810799999999997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span><span class=mord>5</span><span class=mord>3</span></span></span></span>。</p></li><li><p>生日攻击</p><ul><li><p>生日攻击是基于下述结论：</p><p>设散列函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>m</mi></msup></mrow><annotation encoding=application/x-tex>2^m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span></span></span></span> 个可能的输出（即输出长 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 比特），如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=application/x-tex>H</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.08125em>H</span></span></span></span> 的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个随机输入中至少有两个产生相同输出的概率大于0.5，则 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>≈</mo><msqrt><mo stretchy=false>(</mo></msqrt><msup><mn>2</mn><mi>m</mi></msup><mo stretchy=false>)</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>m</mi><mi mathvariant=normal>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=application/x-tex>k\approx\sqrt(2^m )=2^{m/2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.24em;vertical-align:-.30499999999999994em></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.935em><span class=svg-align style=top:-3.2em><span class=pstrut style=height:3.2em></span><span class=mopen style=padding-left:1em>(</span></span><span style=top:-2.8950000000000005em><span class=pstrut style=height:3.2em></span><span class=hide-tail style=min-width:1.02em;height:1.28em><svg width=400em height=1.28em viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,
158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067
c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,
175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71
c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,
-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26
s76,-59,76,-59s76,-60,76,-60z M1001 80H40000v40H1012z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.30499999999999994em><span></span></span></span></span></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8879999999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p>称寻找函数H的<strong>具有相同输出的两个任意输入</strong>的攻击方式为第Ⅱ类生日攻击。</p></li><li><p>生日攻击法<br>生日悖论原理可用于构造对 Hash 函数的攻击：<br>设 Hash 函数值有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 个比特， <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 是真消息，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 是伪造的假消息，分别把消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 表示成 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi></mrow><annotation encoding=application/x-tex>R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span> 个变形的消息。消息与其变形消息具有不同的形式，但有相同的含义</p><ul><li><p>敌手可在文件的单词之间插入很多 space-space-backspace 字符对</p></li><li><p>使用意义相同但词句不同的语句</p></li></ul></li><li><p>计算真消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的变形与假消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 的变形发生碰撞的概率<br>由于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 比特长的散列值共有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>2^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 个，所以对于给定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的变形 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>m_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 的变形 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>M_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span>，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>m_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 与 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>M_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span> 不碰撞的概率是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><msup><mn>2</mn><mi>n</mi></msup></mfrac></mrow><annotation encoding=application/x-tex>1-\frac{1}{2^n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.190108em;vertical-align:-.345em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.845108em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.5935428571428571em><span style=top:-2.786em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。由于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 共有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi></mrow><annotation encoding=application/x-tex>R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span> 个变形，所以 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 的全部变形都不与 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>m_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 碰撞的概率是： <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><msup><mn>2</mn><mi>n</mi></msup></mfrac><msup><mo stretchy=false>)</mo><mi>R</mi></msup></mrow><annotation encoding=application/x-tex>(1-\frac{1}{2^n})^R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.190108em;vertical-align:-.345em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.845108em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.5935428571428571em><span style=top:-2.786em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413309999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span></span></span></span></span></span></span></span><br>因为消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 共有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span> 个变形，因此 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的变形与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 的变形都不碰撞的概率是：<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><msup><mn>2</mn><mi>n</mi></msup></mfrac><msup><mo stretchy=false>)</mo><mrow><mi>r</mi><mi>R</mi></mrow></msup></mrow><annotation encoding=application/x-tex>(1-\frac{1}{2^n})^{rR}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.190108em;vertical-align:-.345em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.845108em><span style=top:-2.6550000000000002em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.5935428571428571em><span style=top:-2.786em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413309999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span></span></span></span></span></span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 的变形与 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 的变形发生碰撞的概率是：</p><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><msup><mn>2</mn><mi>n</mi></msup></mfrac><msup><mo stretchy=false>)</mo><mrow><mi>r</mi><mi>R</mi></mrow></msup><mo>≈</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mi>r</mi><mi>R</mi></mrow><msup><mn>2</mn><mi>n</mi></msup></mfrac></mrow></msup></mrow><annotation encoding=application/x-tex>P(n)=1-(1-\frac{1}{2^n})^{rR}\approx 1-e^{- \frac{rR}{2^n}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:2.00744em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.32144em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.590392em><span style=top:-2.9890000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8913309999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.0234649999999998em;vertical-align:0></span><span class=mord><span class="mord mathdefault">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0234649999999998em><span style=top:-3.4130000000000003em;margin-right:.05em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8720928571428572em><span style=top:-2.656em><span class=pstrut style=height:3em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.72456em><span style=top:-2.794em;margin-right:.1em><span class=pstrut style=height:2.5em></span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span><span style=top:-3.2255000000000003em><span class=pstrut style=height:3em></span><span class="frac-line mtight" style=border-bottom-width:.049em></span></span><span style=top:-3.384em><span class=pstrut style=height:3em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.344em><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>当 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi><mo>=</mo><mi>R</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>n</mi><mi mathvariant=normal>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=application/x-tex>r=R=2^{n/2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8879999999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 时，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>l</mi></mrow></msup><mo>≈</mo><mn>0.63</mn></mrow><annotation encoding=application/x-tex>P(n)=1-e^{-l}\approx 0.63</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8491079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight" style=margin-right:.01968em>l</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≈</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>0</span><span class=mord>.</span><span class=mord>6</span><span class=mord>3</span></span></span></span></p></li><li><p>步骤</p><p>② 敌手<strong>对 A 发送的消息M产生出 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mrow><mi>m</mi><mi mathvariant=normal>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=application/x-tex>2^{m/2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8879999999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 个变形的消息</strong>，每个变形的消息本质上的含义与原消息相同，同时敌手准备一个假冒消息 M’ ，并<strong>对假冒消息产生出 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mrow><mi>m</mi><mi mathvariant=normal>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=application/x-tex>2^{m/2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8879999999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 个变形的消息</strong>。</p><p>③ 敌手在产生的两个消息集合中，找出杂凑值相同的一对消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>M_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>M_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，由上述讨论可知敌手成功的概率大于 0.5。如果不成功，则重新产生一个假冒的消息，并产生 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mrow><mi>m</mi><mi mathvariant=normal>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=application/x-tex>2^{m/2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8879999999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8879999999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 个变形，直到找到杂凑值相同的一对消息为止</p><p>④ 敌手将 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>M_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 提交给 A 请求签字，由于 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>M_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 与 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>M_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的杂凑值相同，所以可将 A 对 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>M_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的签字当作对 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>M_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的签字，将此签字连同 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>M_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 一起发给意欲的接收者。</p></li><li><p>为了抵抗生日攻击，消息摘要必须足够长。建议Hash值长度至少为128 比特</p></li></ul></li></ul><h5 id=中间相遇攻击><a class=markdownIt-Anchor href=#中间相遇攻击></a> 中间相遇攻击</h5><ul><li>用于攻击一类具有特殊结构的Hash函数</li><li>分析Hash函数运算的中间值相等的概率</li><li>中间相遇攻击的基本原理为：<ol><li>将消息分成两部分，对伪造消息的第一部分从初试值开始逐步向中间阶段产生r1个变量</li><li>对伪造消息的第二部分从Hash结果开始逐步退回中间阶段产生r2个变量。</li><li>在中间阶段有一个匹配的概率与生日攻击成功的概率一样。</li></ol></li></ul><h3 id=迭代型散列函数><a class=markdownIt-Anchor href=#迭代型散列函数></a> 迭代型散列函数</h3><ul><li><p>目前使用的大部分散列函数如 MD5，SHA，其结构都是迭代型的</p></li><li><p>迭代型 Hash 函数：Merkle 于1989 年提出：b 比特分组，n比特输出；f 为压缩函数，L 轮链接迭代</p><ul><li><p>设 x 是一个长度为 L 个固定长度分组的比特串，重复应用压缩函数 f，对 x 进行多次压缩，最后得到 x 的散列值</p></li><li><p>关于分组：将输入消息 M 分为 L-1 个长度为 b 位的分组</p></li><li><p>填充：如果 L-1 组不足 b 位，则惊醒填充</p></li><li><p>附加：表示输入的总长度的分组</p></li><li><p>共 L 个长度为 b的分组</p></li><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>H</mi><mo stretchy=false>(</mo><mi>M</mi><mo separator=true>,</mo><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>C</mi><msub><mi>V</mi><mn>0</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>h=H(M,length(M),CV_0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.01968em>l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>V</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p></li></ul></li><li><p>计算散列值的步骤</p><ol><li><p>预处理：用一个公开算法在 x 右方填充，得到比特串 y，使 y 的长度为 n 的整数倍</p><p>即：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><mi>p</mi><mi>a</mi><mi>d</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><msub><mi>y</mi><mn>2</mn></msub><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><mo>…</mo><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>y=x||pad(x)=y_1||y_2||\dots||y_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">x</span><span class=mord>∣</span><span class=mord>∣</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord>∣</span><span class=mord>∣</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord>∣</span><span class=mord>∣</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>∣</span><span class=mord>∣</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></p></li></ol></li></ul><h2 id=消息认证码><a class=markdownIt-Anchor href=#消息认证码></a> 消息认证码</h2><h3 id=对消息认证的要求><a class=markdownIt-Anchor href=#对消息认证的要求></a> 对消息认证的要求</h3><ul><li><p>攻击的类型</p><ul><li>主动攻击<ul><li>伪装、内容修改、顺序修改、计时修改</li><li>发送方否认、接收方否认</li></ul></li><li>被动攻击<ul><li>信息内容泄露</li><li>传输分析：分析双方的通信模式</li></ul></li></ul></li><li><p>认证是一个过程，验证所收到的消息确实来自<strong>真正的发送方</strong>，且是<strong>未被修改</strong>的消息，也可验证消息的<strong>顺序</strong>和<strong>及时性</strong></p></li></ul><h3 id=消息认证函数><a class=markdownIt-Anchor href=#消息认证函数></a> 消息认证函数</h3><ul><li>认证符的产生<ul><li>Hash：任意长的消息映射为定长的Hash值</li><li>消息加密：消息加密后的密文</li><li>消息认证码 MAC：消息和密钥的函数，产生定长的值</li></ul></li></ul><h3 id=消息认证码-mac><a class=markdownIt-Anchor href=#消息认证码-mac></a> 消息认证码 MAC</h3><h4 id=定义及使用方式><a class=markdownIt-Anchor href=#定义及使用方式></a> 定义及使用方式</h4><ul><li><p>消息认证码 MAC 是一种消息认证技术，是指消息被一密钥控制的公开函数作用后产生的、用作认证符的、固定长度的数值，也称为密码校验和。</p></li><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>A</mi><mi>C</mi><mo>=</mo><mi>C</mi><mo stretchy=false>(</mo><mi>K</mi><mo separator=true>,</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>MAC=C(K,M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span>，其中，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 为输入消息；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span> 为 MAC 函数；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span> 为共享的密钥；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>A</mi><mi>C</mi></mrow><annotation encoding=application/x-tex>MAC</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span> 为消息认证码。</p></li></ul><div align=center><img src=/img/post/密码学备忘/MAC原理图.png style=zoom:50%></div><ul><li><p>MAC 函数与加密类似，区别在于：MAC 算法不要求可逆性，而加密算法必须是可逆的。</p></li><li><p>为提供**保密性，**可在MAC函数以后（对整体）或以前（对 M）进行一次加密，而且加密密钥也需被收发双方共享</p></li></ul><h4 id=对消息认证码的要求><a class=markdownIt-Anchor href=#对消息认证码的要求></a> 对消息认证码的要求</h4><ul><li>攻击目的<ul><li>伪造攻击</li><li>密钥恢复攻击</li></ul></li></ul><h5 id=密钥恢复攻击><a class=markdownIt-Anchor href=#密钥恢复攻击></a> 密钥恢复攻击</h5><ul><li><p>产生MAC的函数一般都为多到一映射，如果产生 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 比特长的 MAC，则函数的取值范围为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>2^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 个可能的 MAC，函数输入的可能的消息个数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>N</mi><mo>&gt;</mo><mo>&gt;</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>N&gt;&gt;2^n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.72243em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.10903em>N</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>，而且如果函数所用的密钥为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 比特，则可能的密钥个数为 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=application/x-tex>2^k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.849108em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span></span></span>。</p></li><li><p>如果系统不考虑保密性，即敌手能获取明文消息和相应的MAC，那么在这种情况下要考虑敌手使用<strong>穷搜索攻击</strong>来获取产生MAC的函数所使用的密钥。</p></li><li><p>攻击步骤</p><ol><li>已知 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo separator=true>,</mo><mi>M</mi><mi>A</mi><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>M_1,MAC_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>A</mi><msub><mi>C</mi><mn>1</mn></msub><mo>=</mo><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>MAC_1=C_K(M_1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>。对所有 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=application/x-tex>2^k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.849108em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span></span></span> 个可能的密钥计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>A</mi><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><msub><mi>K</mi><mi>i</mi></msub></msub><mo stretchy=false>(</mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>MAC_i=C_{K_i}(M_1)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3280857142857143em><span style=top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>，得 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mrow><mi>k</mi><mo>−</mo><mi>n</mi></mrow></msup></mrow><annotation encoding=application/x-tex>2^{k-n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8491079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> 个可能的密钥。</li><li>已知 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub><mo separator=true>,</mo><mi>M</mi><mi>A</mi><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>M_2,MAC_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>A</mi><msub><mi>C</mi><mn>2</mn></msub><mo>=</mo><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><msub><mi>M</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>MAC_2=C_K(M_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>。对上一轮得到的 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mrow><mi>k</mi><mo>−</mo><mi>n</mi></mrow></msup></mrow><annotation encoding=application/x-tex>2^{k-n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8491079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> 个可能的密钥计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>A</mi><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><msub><mi>K</mi><mi>i</mi></msub></msub><mo stretchy=false>(</mo><msub><mi>M</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>MAC_i=C_{K_i}(M_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.0001em;vertical-align:-.2501em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3280857142857143em><span style=top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>，得 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mrow><mi>k</mi><mo>−</mo><mn>2</mn><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding=application/x-tex>2^{k-2×n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8491079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> 个可能的密钥。<br>如此下去，如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mi>α</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>k=αn</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.0037em>α</span><span class="mord mathdefault">n</span></span></span></span>，则上述攻击方式<strong>平均</strong>需要 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>α</mi></mrow><annotation encoding=application/x-tex>α</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.0037em>α</span></span></span></span> 轮。<br>例如，密钥长为 80 比特，MAC长为 32 比特，则第 1 轮将产生大约 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>48</mn></msup></mrow><annotation encoding=application/x-tex>2^{48}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span></span> 个可能密钥，第 2 轮将产生 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup></mrow><annotation encoding=application/x-tex>2^{16}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 个可能的密钥，第3轮即可找出正确的密钥。</li></ol></li></ul><h5 id=伪造攻击><a class=markdownIt-Anchor href=#伪造攻击></a> 伪造攻击</h5><ul><li><p>例如，设 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>X</mi><mn>1</mn></msub><mi mathvariant=normal>∥</mi><msub><mi>X</mi><mn>2</mn></msub><mi mathvariant=normal>∥</mi><mo>…</mo><mi mathvariant=normal>∥</mi><msub><mi>X</mi><mi>m</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M=(X_1\|X_2\|…\|X_m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord>∥</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord>∥</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>∥</span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 是由 64 比特长的分组 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo stretchy=false>(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>X_i(i=1,…,m)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">i</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">m</span><span class=mclose>)</span></span></span></span> 链接得到的，其消息认证码由以下方式得到：<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>△</mi><mo stretchy=false>(</mo><mi>𝑀</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>𝑋</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>𝑋</mi><mn>2</mn></msub><mo>⊕</mo><mo>⋯</mo><mo>⊕</mo><msub><mi>𝑋</mi><mi>𝑚</mi></msub></mrow><annotation encoding=application/x-tex>\triangle(𝑀)=𝑋_1⊕𝑋_2⊕⋯⊕𝑋_𝑚</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>△</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>𝐶</mi><mi>𝐾</mi></msub><mo stretchy=false>(</mo><mi>𝑀</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>𝐸</mi><mi>𝐾</mi></msub><mo stretchy=false>[</mo><mi mathvariant=normal>△</mi><mo stretchy=false>(</mo><mi>𝑀</mi><mo stretchy=false>)</mo><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>𝐶_𝐾 (𝑀)=𝐸_𝐾 [\triangle(𝑀)]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>[</span><span class=mord>△</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span><span class=mclose>]</span></span></span></span><br>其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>⊕</mo></mrow><annotation encoding=application/x-tex>⊕</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=mord>⊕</span></span></span></span> 表示异或运算，加密算法是电码本模式的 DES。<br>因此，密钥长为 56 比特，MAC长为 64 比特，如果敌手得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi mathvariant=normal>∥</mi><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M\|C_K(M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mord>∥</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span>，那么敌手使用穷搜索攻击寻找 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span> 将需做 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mn>2</mn><mn>56</mn></msup></mrow><annotation encoding=application/x-tex>2^{56}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 次加密。</p></li><li><p>敌手还可用以下方式攻击系统：<br>将 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>X_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 到 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>X_{m-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span> 分别用自己选取的 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>Y</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>Y_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 到 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>Y</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>Y_{m-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.891661em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span> 替换，<br>求出 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>Y</mi><mi>m</mi><mo>=</mo><mi>Y</mi><mn>1</mn><mo>⊕</mo><mi>Y</mi><mn>2</mn><mo>⊕</mo><mo>…</mo><mo>⊕</mo><mi>Y</mi><mi>m</mi><mo>−</mo><mn>1</mn><mo>⊕</mo><mi mathvariant=normal>Δ</mi><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Ym=Y1⊕Y2⊕…⊕Ym-1⊕Δ(M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=mord>2</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=minner>…</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>Δ</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span>，并用 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>Y</mi><mi>m</mi></msub></mrow><annotation encoding=application/x-tex>Y_m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 替换 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>X</mi><mi>m</mi></msub></mrow><annotation encoding=application/x-tex>X_m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07847em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><br>敌手可伪造一新消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>Y</mi><mn>2</mn></msub><mo>⊕</mo><mo>…</mo><mo>⊕</mo><msub><mi>Y</mi><mi>m</mi></msub></mrow><annotation encoding=application/x-tex>M&#x27;=Y_1⊕Y_2⊕…⊕Y_m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=minner>…</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> ，且 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>M&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的MAC与原消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 的MAC相同。</p></li></ul><blockquote><p><strong>阻止基于选择明文的穷举攻击</strong></p></blockquote><ul><li><p>MAC应满足以下要求，其中假定敌手知道函数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span>，但不知道密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span>：<br>如果敌手得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>C_K(M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span>，则构造一满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo><mo>=</mo><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>C_K(M&#x27;)=C_K(M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span> 的新消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>M&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 在计算上不可行。</p></li><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>C_K(M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span> 在以下意义下是均匀分布的：随机选取两个消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mo separator=true>,</mo><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>M,M&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.946332em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mi>r</mi><mo stretchy=false>[</mo><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo><mo stretchy=false>]</mo><mo>=</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>n</mi></mrow></msup></mrow><annotation encoding=application/x-tex>Pr[C_K(M)=C_K(M&#x27;)]=2^{-n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mclose>]</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.771331em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.771331em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>，其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 为 MAC 的长</p><p>若 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup></mrow><annotation encoding=application/x-tex>M&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span> 的某个变换，即 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup><mo>=</mo><mi>f</mi><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M&#x27;=f(M)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.751892em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span></span></span></span>，例如 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>f</mi></mrow><annotation encoding=application/x-tex>f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10764em>f</span></span></span></span> 为插入一个或多个比特，那么<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mi>r</mi><mo stretchy=false>[</mo><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>C</mi><mi>K</mi></msub><mo stretchy=false>(</mo><msup><mi>M</mi><mo mathvariant=normal>′</mo></msup><mo stretchy=false>)</mo><mo stretchy=false>]</mo><mo>=</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>n</mi></mrow></msup></mrow><annotation encoding=application/x-tex>Pr[C_K(M)=C_K(M&#x27;)]= 2^{-n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mopen>[</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.001892em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.751892em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mclose>]</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.771331em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.771331em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span><br>认证算法对消息的某部分或位不应比其他部分或位更弱。</p></li></ul><hr><ul><li>对MAC攻击时，因为攻击者需要有已选择的 &lt;消息-MAC&gt; 对或密钥信息，所以这种攻击方式<strong>不能离线进行</strong>。</li></ul><h4 id=mac的构造><a class=markdownIt-Anchor href=#mac的构造></a> MAC的构造</h4><h4 id=hmac算法描述><a class=markdownIt-Anchor href=#hmac算法描述></a> HMAC算法描述</h4><p>H：嵌入的散列函数(如MD5、SHA)，<br>M：HMAC的输入消息(包括散列函数所要求的填充位)，<br>Yi(0≤i≤L-1)：M的第i个分组，<br>L：M的分组数，<br>b：一个分组中的比特数，<br>n：由嵌入的散列函数所产生的杂凑值的长度，<br>K：密钥，如果密钥长度大于b，则将密钥输入到散列函数中产生一个n比特长的密钥，<br>K+是左边经填充0后的K，K+的长度为b比特，<br>ipad为b/8个00110110，<br>opad为b/8个01011010。</p><div align=center><img src=/img/post/密码学备忘/HMAC.png style=zoom:50%></div><hr><h2 id=密钥管理和分发><a class=markdownIt-Anchor href=#密钥管理和分发></a> 密钥管理和分发</h2><h3 id=对称加密的对称密钥分发><a class=markdownIt-Anchor href=#对称加密的对称密钥分发></a> 对称加密的对称密钥分发</h3><ul><li><p>密钥可根据其不同用途分为会话密钥和主密钥两种类型</p><ul><li><p>会话密钥又称为数据加密密钥</p></li><li><p>主密钥又称为密钥加密密钥</p></li></ul></li></ul><ol><li><p>密钥由 A 选取并通过物理手段发送给 B</p></li><li><p>密钥由第三方选取并通过物理手段发送给A和B</p><p>※：第 1 和第 2 种方法称为人工发送，分配的代价很大</p></li><li><p>如果A、B事先已有一密钥，则其中一方选取新密钥后，用已有的密钥加密新密钥并发送给另一方</p><ul><li><p>缺点：攻击者一旦获得一个密钥就可获取以后所有的密钥；</p><p>​ 用这种方法对所有用户分配初始密钥时，代价仍然很大</p></li></ul></li><li><p>如果 A 和 B 与第三方 C 分别有一保密信道，则 C 为 A、B 选取密钥后，分别在两个保密信道上发送给 A、B</p><ul><li>该方法最常用</li><li>其中的第三方通常是一个负责为用户分配密钥的密钥分配中心(KDC)</li><li>这时每一用户必须和密钥分配中心有一个共享密钥，称为主密钥（可通过第二种方法）</li><li>通过主密钥分配给一对用户的密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mi>s</mi></msub></mrow><annotation encoding=application/x-tex>k_s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 称为会话密钥，用于这一对用户之间的保密通信</li><li>通信完成后，会话密钥即被销毁。如上所述，如果用户数为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>，则会话密钥数为 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo stretchy=false>(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo><mi mathvariant=normal>/</mi><mn>2</mn></mrow><annotation encoding=application/x-tex>n(n-1)/2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault">n</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>1</span><span class=mclose>)</span><span class=mord>/</span><span class=mord>2</span></span></span></span>。但主密钥数却只需 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 个，所以主密钥可通过物理手段发送</li></ul></li></ol><div align=center><img src=/img/post/密码学备忘/密钥分配实例.png style=zoom:50%></div><ul><li><p>网络中如果用户数目非常多且分布的地域非常广，则需要使用多个KDC的<strong>分层结构</strong></p><ul><li>分层结构可减少主密钥的分布</li><li>分层结构还可将虚假KDC的危害<strong>限制到一个局部区域</strong>，但会<strong>降低信任度</strong></li></ul></li><li><p>会话密钥的有效期</p><ul><li>更换得越频繁，系统的安全性就越高</li><li>更换得太频繁，又将延迟用户之间的交换，造成网络负担</li></ul></li><li><p>用密钥分配中心为用户分配密钥时，要求<strong>所有用户都信任KDC</strong>，同时还要求<strong>对 KDC 加以保护</strong>。如果密钥的分配是无中心的，则不必有以上两个要求</p></li></ul><h3 id=非对称加密的对称密钥分发><a class=markdownIt-Anchor href=#非对称加密的对称密钥分发></a> <strong>非对称加密的对称密钥分发</strong></h3><ul><li>公钥分配完成后，用户可用公钥加密体制进行保密通信。然而由于公钥加密的速度过慢，以此进行保密通信不太合适，但用于分配单钥密码体制的密钥却非常合适</li></ul><ol><li>简单分配：用公钥直接加密会话密钥<ul><li>缺点：中间人攻击</li></ul></li></ol><div align=center><img src=/img/post/密码学备忘/简单分配.png style=zoom:50%></div><ol start=2><li>具有保密性和认证性的密钥分配</li></ol><div align=center><img src=/img/post/密码学备忘/具有保密性和认证性的密钥分配.png style=zoom:50%></div><h3 id=公钥分发><a class=markdownIt-Anchor href=#公钥分发></a> 公钥分发</h3><ol><li><p>公开发布</p><ul><li>用户将自己的公钥发给每一其他用户，或向某一团体广播</li><li>缺点：任何人都可伪造这种公开发布</li></ul></li><li><p>公用目录表</p><ul><li>公用目录表的建立、维护以及公钥的分布由某个可信的实体或组织承担，称这个实体或组织为公用目录的管理员</li></ul></li><li><p>公钥授权</p><ul><li>通过更加严格地控制目录中的公钥分配，使公钥分配更安全</li><li>优点：每次密钥的获得由公钥管理机构查询并认证发送，<strong>用户不需要查表</strong>，提高了安全性</li><li>缺点：公钥管理机构必须一直在线</li></ul></li><li><p>公钥证书</p><ul><li><p>用户通过<strong>公钥证书来互相交换自己的公钥</strong>而无须与公钥管理机构联系</p></li><li><p>X.509证书</p></li></ul></li></ol><h4 id=公钥基础设施><a class=markdownIt-Anchor href=#公钥基础设施></a> 公钥基础设施</h4><ul><li>PKI 系统是有硬件、软件、人、策略和程序构成的一整套体系</li><li>IETF 的 PKIX 工作组在 X.509 的基础上，建立一个可以构建网络认证的基本模型</li></ul><div align=center><img src=/img/post/密码学备忘/IETF.png style=zoom:67%></div><ul><li>PKI<ul><li>端实体</li><li>签证机构 CA</li><li>注册机构 RA</li><li>证书撤销列表发布 CRL</li><li>证书存储库</li></ul></li><li>PKI 主要完成功能<ul><li>为用户生成一对密钥，并通过一定途径分发给用户</li><li>CA 为用户签发数字证书，形成用户的公开密钥信息，并通过一定的途径分发给用户</li><li>对用户证书进行有效性认证</li><li>对用户的数字证书进行管理，包括：有效证书的公布、册小证书的公布、证书归档等</li></ul></li><li>PKIX 管理任务<ul><li>用户注册</li><li>初始化</li><li>认证</li><li>密钥对的恢复</li><li>密钥对的更新</li><li>证书撤销请求</li><li>交叉认证</li></ul></li></ul></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class=category-chains><span class=category-chain><a href=/categories/%E5%A4%87%E5%BF%98/ class=category-chain-item>备忘</a></span></span></div><div class=post-meta><i class="iconfont icon-tags"></i> <a href=/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/ class=print-no-link>#密码学</a></div></div><div class="license-box my-3"><div class=license-title><div>密码学备忘</div><div>https://justloseit.top/密码学备忘/</div></div><div class=license-meta><div class=license-meta-item><div>作者</div><div>Mobilis In Mobili</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2020年10月28日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2023年3月3日</div></div><div class=license-meta-item><div>许可协议</div><div><a class=print-no-link target=_blank href=https://creativecommons.org/licenses/by-sa/4.0/ ><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i> </span></a><a class=print-no-link target=_blank href=https://creativecommons.org/licenses/by-sa/4.0/ ><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-cc-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href=/%E7%AA%84%E9%97%A8/ title=窄门><i class="iconfont icon-arrowleft"></i> <span class=hidden-mobile>窄门</span> <span class=visible-mobile>上一篇</span></a></article><article class="post-next col-6"><a href=/Bilibili_1024Sec_Writeup/ title="Bilibili 1024 Sec Writeup"><span class=hidden-mobile>Bilibili 1024 Sec Writeup</span> <span class=visible-mobile>下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id=comments><div id=valine></div><script type=text/javascript>Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",function(){var i=Object.assign({appId:"t4w421aIGl2GXkT0tSGoap5I-gzGzoHsz",appKey:"BpNeeVt0v3tKAbF1L6RTf94X",path:"window.location.pathname",placeholder:"说点什么",avatar:"hide",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!1,serverURLs:"https://t4w421ai.lc-cn-n1-shared.com",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class=sidebar style=margin-left:-1rem><div id=toc><p class=toc-header><i class="iconfont icon-list"></i> <span>目录</span></p><div class=toc-body id=toc-body></div></div></aside></div></div></div><script>Fluid.utils.createScript("https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js",function(){mermaid.initialize({theme:"default"}),Fluid.utils.listenDOMLoaded(function(){Fluid.events.registerRefreshCallback(function(){"mermaid"in window&&mermaid.init()})})})</script><a id=scroll-top-button aria-label=TOP href=# role=button><i class="iconfont icon-arrowup" aria-hidden=true></i></a><div class="modal fade" id=modalSearch tabindex=-1 role=dialog aria-labelledby=ModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-lg" role=document><div class=modal-content><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type=button id=local-search-close class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type=text id=local-search-input class="form-control validate"> <label data-error=x data-success=v for=local-search-input>关键词</label></div><div class=list-group id=local-search-result></div></div></div></div></div></main><footer><div class=footer-inner><div class=footer-content><a href=https://hexo.io target=_blank rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href=https://github.com/fluid-dev/hexo-theme-fluid target=_blank rel="nofollow noopener"><span>Fluid</span></a></div><div class=statistics><span id=leancloud-site-pv-container style=display:none>总访问量 <span id=leancloud-site-pv></span> 次 </span><span id=leancloud-site-uv-container style=display:none>总访客数 <span id=leancloud-site-uv></span> 人</span></div><div class=beian><span><a href=http://beian.miit.gov.cn/ target=_blank rel="nofollow noopener"><a target=_blank rel=noopener href=https://beian.miit.gov.cn>京ICP备2021006744号-1</a> </a></span><span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802034644" rel="nofollow noopener" class=beian-police target=_blank><span style=visibility:hidden;width:0>|</span> <img src=/img/police_beian.png alt=police-icon> <span>京公网安备 11010802034644号</span></a></span></div></div></footer><script src=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js></script><link rel=stylesheet href=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src=https://lib.baomitu.com/jquery/3.6.4/jquery.min.js></script><script src=https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js></script><script src=/js/events.js></script><script src=/js/plugins.js></script><script src=https://lib.baomitu.com/typed.js/2.0.12/typed.min.js></script><script>(t=>{var e=Fluid.plugins.typing;(t=t.getElementById("subtitle"))&&e&&e(t.getAttribute("data-typed-text"))})((window,document))</script><script src=/js/img-lazyload.js></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script defer=defer src=/js/leancloud.js></script><script src=/js/local-search.js></script><script src=/js/boot.js></script><noscript><div class=noscript-warning>博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>