<!DOCTYPE html><html lang=zh-CN data-default-color-scheme=auto><head><meta charset=UTF-8><link rel=apple-touch-icon sizes=76x76 href=/img/favicon/favicon.png><link rel=icon href=/img/favicon/favicon.png><link rel=canonical href=https://justloseit.top/区块链分片技术综述/ ><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content=#2f4154><meta name=author content="Mobilis In Mobili"><meta name=keywords content=""><meta name=description content="Survey Sharding in Blockchains 笔记"><meta property=og:type content=article><meta property=og:title content=区块链分片技术综述><meta property=og:url content=https://justloseit.top/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%88%86%E7%89%87%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/index.html><meta property=og:site_name content=动中之动><meta property=og:description content="Survey Sharding in Blockchains 笔记"><meta property=og:locale content=zh_CN><meta property=og:image content=https://justloseit.top/img/index/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%88%86%E7%89%87%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0.jpg><meta property=article:published_time content=2022-03-13T06:46:25.000Z><meta property=article:modified_time content=2022-11-21T12:40:44.081Z><meta property=article:author content="Mobilis In Mobili"><meta property=article:tag content=区块链><meta property=article:tag content=分片><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=https://justloseit.top/img/index/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%88%86%E7%89%87%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0.jpg><title>区块链分片技术综述 - 动中之动</title><link rel=stylesheet href=https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css><link rel=stylesheet href=https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css><link rel=stylesheet href=https://lib.baomitu.com/hint.css/2.7.0/hint.min.css><link rel=stylesheet href=https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css><link rel=stylesheet href=https://lib.baomitu.com/KaTeX/0.16.2/katex.min.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css><link rel=stylesheet href=/css/main.css><link id=highlight-css rel=stylesheet href=/css/highlight.css><link id=highlight-css-dark rel=stylesheet href=/css/highlight-dark.css><script id=fluid-configs>var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"justloseit.top",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:60,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:"§"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:"snI2XNrHrhyx5g84m3Uim3EC-gzGzoHsz",app_key:"x2YseXJIHmvnsM4v9y9UAlvu",server_url:"https://sni2xnrh.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src=/js/utils.js></script><script src=/js/color-schema.js></script><meta name=generator content="Hexo 5.4.2"><link rel=alternate href=/atom.xml title=动中之动 type=application/atom+xml></head><body><header><div class=header-inner style=height:70vh><nav id=navbar class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=/ ><strong>Mobilis In Mobili</strong> </a><button id=navbar-toggler-btn class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"><div class=animated-icon><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto text-center"><li class=nav-item><a class=nav-link href=/ target=_self><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class=nav-item><a class=nav-link href=/archives/ target=_self><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class=nav-item><a class=nav-link href=/categories/ target=_self><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class=nav-item><a class=nav-link href=/tags/ target=_self><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class=nav-item><a class=nav-link href=/about/ target=_self><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class=nav-item><a class=nav-link href=/links/ target=_self><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class=nav-item id=search-btn><a class=nav-link target=_self href=javascript:; data-toggle=modal data-target=#modalSearch aria-label=Search><i class="iconfont icon-search"></i></a></li><li class=nav-item id=color-toggle-btn><a class=nav-link target=_self href=javascript:; aria-label="Color Toggle"><i class="iconfont icon-dark" id=color-toggle-icon></i></a></li></ul></div></div></nav><div id=banner class=banner parallax=true style="background:url(/img/banner/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%88%86%E7%89%87%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0.jpg) no-repeat center center;background-size:cover"><div class=full-bg-img><div class="mask flex-center" style=background-color:rgba(0,0,0,.3)><div class="banner-text text-center fade-in-up"><div class=h2><span id=subtitle data-typed-text=区块链分片技术综述></span></div><div class=mt-3><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden=true></i> Mobilis In Mobili </span><span class=post-meta><i class="iconfont icon-date-fill" aria-hidden=true></i> <time datetime="2022-03-13 14:46" pubdate>2022年3月13日 下午</time></span></div><div class=mt-1><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3.8k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 32 分钟 </span><span id=leancloud-page-views-container class=post-meta style=display:none><i class="iconfont icon-eye" aria-hidden=true></i> <span id=leancloud-page-views></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id=board-ctn><div id=board><article class="post-content mx-auto"><h1 id=seo-header>区块链分片技术综述</h1><p id=updated-time class="note note-info">本文最后更新于 2022年11月21日 晚上</p><div class=markdown-body><p><strong>Survey Sharding in Blockchains</strong> 笔记</p><span id=more></span><h1 id=区块链分片技术综述><a class=markdownIt-Anchor href=#区块链分片技术综述></a> 区块链分片技术综述</h1><h2 id=sharding-的意义><a class=markdownIt-Anchor href=#sharding-的意义></a> Sharding  的意义</h2><ul><li>现有区块链的性能限制：Bitcoin 每秒约 10笔交易，其最大区块大小为1MB，平均区块时间为10分钟</li></ul><p>- 因此，Bitcoin 交易在链外处理，然后在区块链中结算。（Layer-2 scaling）</p><p>- Layer-1 scaling</p><p>1. 减少通信和计算开销</p><p>2. 向单个节点添加资源，即垂直扩展</p><p>3. 向区块链添加更多节点，即水平缩放</p><h3 id=reducing-overhead><a class=markdownIt-Anchor href=#reducing-overhead></a> reducing overhead</h3><ul><li>例子：</li></ul><p>- Bitcoin-NG 每个 Pow 赢家能够获得多个区块（而不是一个）</p><p>- 传统 PBFT 协议的优化</p><ul><li>缺点：最多只能减少到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></li></ul><h3 id=vertical-scaling><a class=markdownIt-Anchor href=#vertical-scaling></a> Vertical Scaling</h3><ul><li>例子</li></ul><p>- 增加单个区块中允许的交易数量/缩短区块周期——但是会消耗更多资源</p><p>- GHOST [[GRANDPA 笔记]]</p><p>- 进一步扩展到 DAG：能够并行确认事务</p><ul><li>缺点：不能无限提高吞吐量——网络规模增大会需要更多带宽</li></ul><h4 id=horizontal-scaling><a class=markdownIt-Anchor href=#horizontal-scaling></a> Horizontal Scaling</h4><ul><li><p>分片：整个区块链划分为多个分区，并允许参与节点处理和存储几个分片的交易</p></li><li><p>优点：通过利用允许在单个节点上处理和存储部分事务的分片技术，整个区块链可以随着节点数量的增加实现<strong>线性增加</strong>的吞吐量</p></li></ul><h2 id=sharding-overview><a class=markdownIt-Anchor href=#sharding-overview></a> Sharding Overview</h2><h3 id=面临的问题><a class=markdownIt-Anchor href=#面临的问题></a> 面临的问题</h3><ul><li><p>共识内安全：如何以可扩展的方式保护分区内的一致性算法，因为攻击者可以更轻松地控制单个分区，而不是控制整个网络</p></li><li><p>交叉分区原子性：如何以有效的方式支持交叉验证（如果实现原子安全的交叉分区事务的延迟和开销高于 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span>，则效率低下；n 表示分区数或参与节点）</p></li></ul><h3 id=内共识协议><a class=markdownIt-Anchor href=#内共识协议></a> 内共识协议</h3><ul><li><p>PoW：<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>&gt;</mo><mi mathvariant=double-struck>P</mi><mi mathvariant=normal>/</mi><mi>n</mi><mo>×</mo><mn>50</mn><mi mathvariant=normal>%</mi></mrow><annotation encoding=application/x-tex>P&gt;\mathbb{P}/n\times 50\%</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.72243em;vertical-align:-.0391em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&gt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathbb">P</span></span><span class=mord>/</span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.80556em;vertical-align:-.05556em></span><span class=mord>5</span><span class=mord>0</span><span class=mord>%</span></span></span></span> 即可发动攻击。<span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>P</mi></mrow><annotation encoding=application/x-tex>\mathbb{P}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">P</span></span></span></span></span> 是网络中的采矿权总量</p></li><li><p>BFT：基于 BFT 的共识算法的弱可拓展性限制了分区的大小（分区内的成员数量）。太小的分区可能会降低具有严格容错性（FT）的内部一致性的安全性</p></li></ul><p><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable rowspacing=0.24999999999999992em columnalign="right left" columnspacing=0em><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mi>s</mi><mo stretchy=false>(</mo><mi>k</mi><mo separator=true>,</mo><mi>m</mi><mo separator=true>,</mo><mi>p</mi><mo stretchy=false>)</mo><mo>=</mo><mi>P</mi><mo stretchy=false>[</mo><mi>X</mi><mo>≤</mo><mi>c</mi><mo stretchy=false>]</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>c</mi></munderover><mrow><mo fence=true>(</mo><mtable rowspacing=0.15999999999999992em columnalign=left columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mi>m</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mi>k</mi></mstyle></mtd></mtr></mtable><mo fence=true>)</mo></mrow><msup><mi>p</mi><mi>k</mi></msup><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy=false>)</mo><mrow><mi>m</mi><mo>−</mo><mi>k</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mi>f</mi><mo stretchy=false>(</mo><mi>k</mi><mo separator=true>,</mo><mi>m</mi><mo separator=true>,</mo><mi>p</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mi>s</mi><mo stretchy=false>(</mo><mi>k</mi><mo separator=true>,</mo><mi>m</mi><mo separator=true>,</mo><mi>p</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} &amp;s(k, m, p)=P[X \leq c]=\sum_{k=0}^{c}\left(\begin{array}{l} m \\ k \end{array}\right) p^{k}(1-p)^{m-k} \\ &amp;f(k, m, p)=1-s(k, m, p) \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:4.75351em;vertical-align:-2.126755em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.626755em><span style=top:-4.626755em><span class=pstrut style=height:3.6513970000000002em></span><span class=mord></span></span><span style=top:-2.184642em><span class=pstrut style=height:3.6513970000000002em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.126755em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.626755em><span style=top:-4.626755em><span class=pstrut style=height:3.6513970000000002em></span><span class=mord><span class=mord></span><span class="mord mathdefault">s</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mopen>[</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">c</span><span class=mclose>]</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.6513970000000002em><span style=top:-1.8478869999999998em;margin-left:0><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style=top:-3.0500049999999996em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=top:-4.300005em;margin-left:0><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.302113em><span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">(</span></span><span class=mord><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault">m</span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">)</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">p</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8991079999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">p</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8991079999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span></span></span><span style=top:-2.184642em><span class=pstrut style=height:3.6513970000000002em></span><span class=mord><span class=mord></span><span class="mord mathdefault" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">s</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.126755em><span></span></span></span></span></span></span></span></span></span></span></span></p><p>（<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>X</mi></mrow><annotation encoding=application/x-tex>X</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07847em>X</span></span></span></span> 是表示恶意矿工被选中次数的随机变量；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 表示分区大小；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">c</span></span></span></span> 表示分区中恶意成员的数量；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 表示整个网络中的总 FT；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 应该大于 99%，此时 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span></span></span></span> 大于 144 才能满足——但是传统的 BFT 算法不能实现）</p><h4 id=nakamoto-based-monoxide-chu-ko-nu-mining><a class=markdownIt-Anchor href=#nakamoto-based-monoxide-chu-ko-nu-mining></a> NAKAMOTO-BASED-MONOXIDE - CHU-KO-NU MINING</h4><ul><li><p>第一个无需生成随机性、实现中本聪共识的算法</p></li><li><p>开始时一次性自举（one-off bootstrapping？），根据身份地址将每个节点分配到不同的分区中。</p></li><li><p>基于 <em>Merkle Patricia Tree</em> 根，由多个分区中的提议块（proposed blocks？）构成。这样就能让 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>P</mi><mi mathvariant=normal>/</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>\mathbb{P}/n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathbb">P</span></span><span class=mord>/</span><span class="mord mathdefault">n</span></span></span></span> 变成 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>×</mo><mi mathvariant=double-struck>P</mi><mi mathvariant=normal>/</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>k \times \mathbb{P}/n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathbb">P</span></span><span class=mord>/</span><span class="mord mathdefault">n</span></span></span></span>（<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 表示特定矿工设法开采的碎片数量）——这样分散的采矿能力可以<strong>重新聚合</strong>以解决1%的攻击</p></li><li><p>灵感来源于合并挖矿，合并挖基于正在运行的同类PoW算法，在父链和多个辅助链之间共享挖掘能力，具有相对较小采矿功率的辅助链可以由父链的总采矿功率进行保护。Monoxide 也有类似的想法，但在<strong>没有任何层次结构</strong>的情况下跨多个并行碎片执行挖掘过程。</p></li><li><p>Pow 表达式 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>H</mi><mrow><mo fence=true>(</mo><mi>η</mi><mi mathvariant=normal>∥</mi><mi mathvariant=double-struck>H</mi><mrow><mo fence=true>(</mo><mi>x</mi><mi mathvariant=normal>∥</mi><mi>M</mi><mi>P</mi><msub><mi>T</mi><mi>M</mi></msub><mo fence=true>)</mo></mrow><mo fence=true>)</mo></mrow><mo>≤</mo><mi>γ</mi></mrow><annotation encoding=application/x-tex>\mathbb{H}\left(\eta \| \mathbb{H}\left(x \| M P T_{M}\right)\right) \leq \gamma</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathbb">H</span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class="mord mathdefault" style=margin-right:.03588em>η</span><span class=mord>∥</span><span class=mord><span class="mord mathbb">H</span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class="mord mathdefault">x</span><span class=mord>∥</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.10903em>M</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05556em>γ</span></span></span></span>（其中 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=double-struck>H</mi></mrow><annotation encoding=application/x-tex>\mathbb{H}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">H</span></span></span></span></span> 表示散列函数；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>η</mi></mrow><annotation encoding=application/x-tex>\eta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>η</span></span></span></span> 表示 nonce；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 表示报头内容，包括涉及的分片的上述信息和在正常 PoW 中定义的其他字段，以及与跨分片通信有关的入站和出站中继事务；<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>P</mi><msub><mi>T</mi><mi>M</mi></msub></mrow><annotation encoding=application/x-tex>MPT_M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.10903em>M</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 表示 MPT 根，包括每个相关碎片的所有提议块）</p><ul><li>因此，矿工可以随后将最终确定的区块发送给其相应的碎片，并提供满足的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>η</mi></mrow><annotation encoding=application/x-tex>\eta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>η</span></span></span></span> 和证据 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>[</mo><mi>M</mi><mi>P</mi><msub><mi>T</mi><mi>M</mi></msub><mo separator=true>,</mo><mi>η</mi><mo separator=true>,</mo><msub><mi mathvariant=script>B</mi><mi>i</mi></msub><mo separator=true>,</mo><msub><mi>π</mi><mi>i</mi></msub><mo fence=true>]</mo></mrow><annotation encoding=application/x-tex>\left[M P T_{M}, \eta, \mathcal{B}_{i}, \pi_{i}\right]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=minner><span class="mopen delimcenter" style=top:0>[</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.10903em>M</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>η</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=mord><span class="mord mathcal" style=margin-right:.03041em>B</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>]</span></span></span></span></span><ul><li>在混合 PoW 目标的情况下，允许矿工最终确定区块，并将其发送至任何分区 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span></span></span></span> 至 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>j</mi></mrow><annotation encoding=application/x-tex>j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.85396em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05724em>j</span></span></span></span>，其 PoW 目标已通过当前给定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>η</mi></mrow><annotation encoding=application/x-tex>\eta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>η</span></span></span></span> 实现，其余碎片的目标尚未实现。在那之后，挖矿过程继续，而 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>P</mi><msub><mi>T</mi><mi>M</mi></msub></mrow><annotation encoding=application/x-tex>MPT_M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.10903em>M</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 由于从碎片 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.65952em;vertical-align:0></span><span class="mord mathdefault">i</span></span></span></span> 到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>j</mi></mrow><annotation encoding=application/x-tex>j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.85396em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.05724em>j</span></span></span></span> 的块刚刚完成而被更新。</li><li>在相同 PoW 目标的情况下，矿工也可以最终确定块并将其发送到所有碎片，而不管给定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>η</mi></mrow><annotation encoding=application/x-tex>\eta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>η</span></span></span></span> 是否满足 PoW 目标。除此之外，通过消除 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>π</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>\pi_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 的需要，来自所有矿工必须参与的所有分区的全局子网主存和广播报头可以<em>显著减少通信开销</em>。<br>【可以观察到接受/拒绝单个分片的块与其他分片的决定无关，即<strong>异步化</strong>】</li></ul></li></ul></li><li><p>缺点：</p><ul><li>然而，为了满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>×</mo><mi mathvariant=double-struck>P</mi><mi mathvariant=normal>/</mi><mi>n</mi><mo>≃</mo><mi mathvariant=double-struck>P</mi></mrow><annotation encoding=application/x-tex>k \times \mathbb{P}/n \simeq \mathbb{P}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.77777em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathbb">P</span></span><span class=mord>/</span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≃</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68889em;vertical-align:0></span><span class=mord><span class="mord mathbb">P</span></span></span></span></span> 的要求，Monoxide 需要大多数矿工在尽可能多的碎片上进行 CHU-KO-NU MINING，即在最佳情况下 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>k=n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span>。然而，这意味着，如果矿工仅在 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 个碎片中的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 个上采矿，则预期放大有效采矿能力的因素将太小，无法确保采矿过程的安全，从而降低攻击成本。</li><li>另一方面，理性的矿工倾向于在所有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span></span></span></span> 个碎片上进行挖掘以获取最大利润，这也可能导致权力集中，因为只有专业的采矿设施才能负担得起带宽、磁盘存储和计算处理器的巨大成本</li></ul></li></ul><h4 id=bft-based-elastico><a class=markdownIt-Anchor href=#bft-based-elastico></a> BFT-BASED-ELASTICO</h4><ul><li><p>将基于 BFT 的算法用于内部一致性是绕过基于中本聪共识漏洞的一种替代方法</p></li><li><p>Elastico 在每个纪元开始时，根据不可预测的 PoW 解决方案的不同最低有效位均匀（重新）分配潜在的验证者，然后运行 PBFT 进行内部共识。挖矿过程中使用的随机性是由一个提议的分布式提交和异或方案产生的。</p><ul><li>由于 PBFT 的弱可伸缩性，即使扩展到更大规模网络，Elastico仍会产生 2.76%的故障概率。这一安全问题一直阻碍着Elastico的实际应用【<strong>传统的不可扩展PBFT会导致不可接受的高故障概率，除非扩大共识小组的规模，但是这样效率又低了</strong>】<ul><li>OmniLedger 和 RapidChain 极大地解决和改进了这一问题</li></ul></li></ul></li><li><p>随机性生成——<em>分布式提交和异或方案</em></p><ul><li>一种<strong>提交然后显示</strong>方案</li><li>具有弱可用性和鲁棒性，除非支付更多的通信开销，否则它<strong>不是</strong>一个完全无偏的随机生成器</li></ul></li></ul><h4 id=bft-based-chainspace><a class=markdownIt-Anchor href=#bft-based-chainspace></a> BFT-BASED-CHAINSPACE</h4><ul><li><p>使用了 Mod-SMaRt —— PBFT 的最佳实现，但是并没有扩展PBFT来解决 1% 攻击的问题</p></li><li><p>它将通信和共识原语解耦，而它仅以不变的开销减少后者的开销 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>O</mi><mo stretchy=false>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>O(n^2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.064108em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 通过将流程替换为经过验证且可证明的共识（VP-Consensus）。</p></li><li><p>Elastico 内部共识的高失败概率也在 Chainspace 中生效，同样限制了Chainspace在大规模网络中的使用。</p></li></ul><h4 id=bft-based-omniledger><a class=markdownIt-Anchor href=#bft-based-omniledger></a> BFT-BASED-OMNILEDGER</h4><ul><li><p>OmniLedger 将 RandHound 和基于 Algorand 的 VRF 结合起来，在25% 范围内产生不可预测和无偏的随机性，用于每个分区的重新分配和领导人选举。</p></li><li><p>此外，通过优化 ByzCoin，提出了一种新的可扩展的基于 BFT 的一致性算法ByzCoinX，通过将分区大小增加到数百到1000，解决了基于BFT的1%攻击的难题</p></li></ul><h4 id=bft-based-rapidchain><a class=markdownIt-Anchor href=#bft-based-rapidchain></a> BFT-BASED-RAPIDCHAIN</h4><ul><li><p>RapidChain 实现了一个基于 VSS 的<em>分布式随机生成（DRG）协议</em>，以同意无基础随机性。在DRG协议的基础上，RapidChain 通过引入确定性随机图来解决【RandHound 和VRF 的组合源于对 genesis 区块中预先定义的第三方初始随机性的依赖】问题</p></li><li><p>RapidChain 通过<strong>将内部一致性协议的 FT 增加到50%</strong>，解决了基于BFT的一致性算法在分片中的困境</p></li><li><p>但是：RapidChain 提出的 DRG 协议只实现了一个基本的 VSS 共享方案，仍然遇到了与其他典型 VSS 方案类似的问题——不可伸缩性（只适合小型分片中的 50% BFT）</p></li></ul><h4 id=bft-based-pos-ethereum-20><a class=markdownIt-Anchor href=#bft-based-pos-ethereum-20></a> BFT-BASED POS-ETHEREUM 2.0</h4><ul><li>讨论的是 Shaper + Casper-FFG ——此时 Casper-CBC 仍然尚待实现<ul><li>基于 BFT 的 PoS 共识算法</li><li>Shasper 为共识内部提供了比任何其他考虑的分片机制<strong>更灵活的分配</strong>，但是产生更大的开销</li><li>将成员分配和共识过程解耦，这导致分片中的内部共识<strong>也涉及来自其他分片的验证者作为证明者</strong>。与特定分片关联的证明者组的成员可以在每个槽中更新。</li></ul></li></ul><h3 id=交叉分区的原子性><a class=markdownIt-Anchor href=#交叉分区的原子性></a> 交叉分区的原子性</h3><h4 id=monoxide-中继交易><a class=markdownIt-Anchor href=#monoxide-中继交易></a> Monoxide 中继交易</h4><ul><li><p><strong>无锁设计</strong>（为了减少锁定和解锁的开销导致的的跨分片性能下降），提出了“最终原子性”（Eventual Atomicity），通过简单的消息交换实现无锁异步跨分片交易</p></li><li><p>缺点：与智能合约不兼容、额外延迟、意外重放</p></li></ul><h4 id=elastico-无跨分片交易><a class=markdownIt-Anchor href=#elastico-无跨分片交易></a> Elastico 无跨分片交易</h4><ul><li>Elastico 不提供全局分类跨账分片的原子性</li></ul><h4 id=omniledge-atomix协议><a class=markdownIt-Anchor href=#omniledge-atomix协议></a> OmniLedge ATOMIX协议</h4><ul><li><p>为了简化跨分区的原子性，OmniLedger 提出了一个基于 <em>UTXO</em> 的客户端驱动的 Atomix 协议。这样客户端充当网关，将<strong>通信开销被转移到分片之外</strong>。</p></li><li><p>缺点：Atomix 协议是一个“创口贴”（牺牲了轻量级客户端的支持）；同时，随着分区数量增大，Atomix 协议对基于 UTXO 的跨分片交易的支持较差，无法充分利用 UTXO 格式</p></li></ul><h4 id=rapidchain-三向确认><a class=markdownIt-Anchor href=#rapidchain-三向确认></a> RapidChain 三向确认</h4><ul><li><p>引入路由表，优化了 OmnLedge 的 Atomix 协议，显著降低通信开销，即使分区数量大的基于 UTXO 的跨分区事务也能保持较好性能。</p></li><li><p>缺点：通过污染特定路由表的 Eclipse 攻击成为问题</p></li></ul><h4 id=ethereum-20使用收据receipts><a class=markdownIt-Anchor href=#ethereum-20使用收据receipts></a> Ethereum 2.0使用收据（RECEIPTS）</h4><ul><li><p>通过实现全局（由所有验证者存储）信标链来交换基本消息，即收据和证明，从而引入了基于账户的跨分片交易</p><ul><li>可以看作是 OmniLedger 和 RapidChain 中实现的同步锁定/解锁方案的变体</li></ul></li><li><p>缺点：到目前为止，Shasper 只能支持基于账户（而不是基于UTXO）的简单支付交易</p></li></ul><h4 id=chainspace-mathcals-bac><a class=markdownIt-Anchor href=#chainspace-mathcals-bac></a> Chainspace <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>S</mi><mo>−</mo><mi>B</mi><mi>A</mi><mi>C</mi></mrow><annotation encoding=application/x-tex>\mathcal{S}-BAC</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class=mord><span class="mord mathcal" style=margin-right:.075em>S</span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span></h4><ul><li><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=script>S</mi><mo>−</mo><mi>B</mi><mi>A</mi><mi>C</mi></mrow><annotation encoding=application/x-tex>\mathcal{S}-BAC</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class=mord><span class="mord mathcal" style=margin-right:.075em>S</span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05017em>B</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span>：Sharded Byzantine Atomic Commit 分片拜占庭原子提交，其内部使用最优 PBFT —— Mod-SMaRt 来处理内部共识过程</p></li><li><p>类似于 OmniLedger 中的 Atomix 协议，具有关键的优化，其中必须执行BFT共识过程，而不是简单的客户端驱动模型</p></li><li><p>缺点：随着分区数量增大，Atomix 协议对基于 UTXO 的跨分片交易的支持较差，无法充分利用 UTXO 格式</p></li></ul><h3 id=一般改进><a class=markdownIt-Anchor href=#一般改进></a> 一般改进</h3><h4 id=减少事务延迟><a class=markdownIt-Anchor href=#减少事务延迟></a> 减少事务延迟</h4><ul><li><p>可以通过实现可扩展的 BFT 共识来解决，例如 OmniLedger 和Ethereum 2.0，或者在单个分片中增加 FT，例如 RapidChain</p></li><li><p>RapidChain 实现了基于信息分散算法（IDA）的八卦协议，可以更有效地传输大型有效载荷</p></li></ul><h4 id=通信间协议><a class=markdownIt-Anchor href=#通信间协议></a> 通信间协议</h4><ul><li><p>与实现原子性跨分片的协议不同，互连协议侧重于分片之间数据传输的开销</p></li><li><p>主要两种类型</p><ul><li>充当消息分发器的全局根链： Ethereum 2.0、Elastico、Monoxide</li><li>瓶颈由于单链结构而不是分片结构而转移到全局根链上</li><li>全网连接：OmniLedge、Chainspace<ul><li>会产生相当大的开销</li><li>RapidChain 利用路由表绕过全网连接</li></ul></li></ul></li></ul><h4 id=分片账本修剪><a class=markdownIt-Anchor href=#分片账本修剪></a> 分片账本修剪</h4><ul><li>OmniLedger 提出了状态块</li></ul><h4 id=分散式引导><a class=markdownIt-Anchor href=#分散式引导></a> 分散式引导</h4><ul><li>RapidChain提出了一个以采样图选举网络的形式分散的引导</li></ul><h4 id=保护-epoch-重新配置><a class=markdownIt-Anchor href=#保护-epoch-重新配置></a> 保护 Epoch 重新配置</h4><ul><li><p>Elastico 和 Chainspace 没有提供这样的解决方案</p></li><li><p>Ethereum 2.0通过频繁更新参与每个分片内部共识协议的成员来解决具有全局验证器池的内部共识</p></li><li><p>OmniLedger 实现了一个随机排列方案来交换验证器</p></li><li><p>RapidChain 提出了一种基于布谷鸟规则（Cuckoo Rule）的轻量级重新配置协议</p></li></ul><h4 id=分片智能合约><a class=markdownIt-Anchor href=#分片智能合约></a> 分片智能合约</h4><ul><li>仅 Chainspace 引入</li></ul><h2 id=评估><a class=markdownIt-Anchor href=#评估></a> 评估</h2><h3 id=吞吐量的上限><a class=markdownIt-Anchor href=#吞吐量的上限></a> 吞吐量的上限</h3><h3 id=比较和讨论><a class=markdownIt-Anchor href=#比较和讨论></a> 比较和讨论</h3><ul><li><p>RapidChain 和 Ethereum 2.0实现了优化，减少了Elastico和OmniLedger的限制，这使得RapidChain 和 Ethereum 2.0在吞吐量和成本方面是最先进的基于BFT的分片机制。</p></li><li><p>另一方面， Monoxide 将吞吐量的上限推到了百万级，并为基于中本聪的分片机制开辟了新的方向。</p></li><li><p>Chainspace 在分片智能合约方面有足够的性能改进空间。</p></li></ul><hr><h4 id=未来的趋势><a class=markdownIt-Anchor href=#未来的趋势></a> 未来的趋势</h4><h5 id=降低开销的未来趋势><a class=markdownIt-Anchor href=#降低开销的未来趋势></a> 降低开销的未来趋势</h5><ul><li>现有分片机制中三个缺陷阻止了系统水平扩展到理论上限<ol><li>需要由所有参与矿工/验证者存储的现有全局链</li><li>要求矿工/验证器存储来自其他分区的账本</li></ol><ul><li>潜在的解决方案之一可能是欺诈证明（fraud proof），使light节点与完整节点一样安全，而无需存储整个分类账</li></ul><ol start=3><li>根据业务需求将参与节点分配给分片，以避免过度使用分片技术（按业务分片）</li></ol></li></ul><h5 id=加强安全性和原子性的未来趋势><a class=markdownIt-Anchor href=#加强安全性和原子性的未来趋势></a> 加强安全性和原子性的未来趋势</h5><ul><li><p>内部共识</p><ul><li>在具有尽可能少的第三方硬编码设置的大规模网络中扩展无偏和不可预测的随机数生成器<ul><li>无偏和不可预测的随机性在基于BFT的内部共识设计中起着重要作用</li></ul></li><li>改进基于PoW的内部共识，并将其推广到其他类型的基于中本聪的共识算法中</li></ul></li><li><p>高效原子性：实现高效的条件跨分片交易，实现面向合约的操作。</p><ul><li>到目前为止，只有 Chainspace 和 Ethereum 2.0 的未来阶段声称支持这种条件的跨分片交易，但代价是不可接受的开销和延迟</li></ul></li></ul><h2 id=总结><a class=markdownIt-Anchor href=#总结></a> 总结</h2><ul><li><p>Monoxide 首次提出了一种基于中本聪的分片机制，但代价是存储所有分片的标头，以保证最大的共识内安全性。</p></li><li><p>Elastico 和 Chainspace 中使用的传统 PBFT 由于其可伸缩性较弱而不能保证内部共识安全性。而基于BFT 的分片机制，即 OmniLedger，Rapidchain 和 Ethereum 2.0，在扩展传统PBFT或增加传统PBFT容错的意义上提高了共识内的安全性。</p></li><li><p>本文中所有考虑的分片机制的<strong>随机性生成器</strong>都需要严格的网络设置，否则缩放网络中的不可预测性和无偏性将受到损害。</p></li><li><p>Monoxide、OmniLedger、Rapidchain 和 Ethereum 2.0 都针对跨分片交易问题提出了自己的解决方案，没有一个可以支持跨分片智能合约。只有 Chainspace 提出了一种面向智能合约的分片机制，但代价是吞吐量低。</p></li></ul></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class=category-chains><span class=category-chain><a href=/categories/%E7%AC%94%E8%AE%B0/ class=category-chain-item>笔记</a></span></span></div><div class=post-meta><i class="iconfont icon-tags"></i> <a href=/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/ class=print-no-link>#区块链</a> <a href=/tags/%E5%88%86%E7%89%87/ class=print-no-link>#分片</a></div></div><div class="license-box my-3"><div class=license-title><div>区块链分片技术综述</div><div>https://justloseit.top/区块链分片技术综述/</div></div><div class=license-meta><div class=license-meta-item><div>作者</div><div>Mobilis In Mobili</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2022年3月13日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2022年11月21日</div></div><div class=license-meta-item><div>许可协议</div><div><a class=print-no-link target=_blank href=https://creativecommons.org/licenses/by/4.0/ ><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href=/%E2%80%9C7%E5%A4%A9%E7%94%A8Go%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0Web%E6%A1%86%E6%9E%B6Gee%E2%80%9D%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/ title=“7天用Go从零实现Web框架Gee”学习记录><i class="iconfont icon-arrowleft"></i> <span class=hidden-mobile>“7天用Go从零实现Web框架Gee”学习记录</span> <span class=visible-mobile>上一篇</span></a></article><article class="post-next col-6"><a href=/%E7%AE%97%E6%B3%95%E5%A4%87%E5%BF%98%E5%BD%95%C2%B7%E6%97%B6%E7%A9%BA%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90/ title=算法备忘录·时空复杂度分析><span class=hidden-mobile>算法备忘录·时空复杂度分析</span> <span class=visible-mobile>下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id=comments><div id=valine></div><script type=text/javascript>Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",function(){var i=Object.assign({appId:"t4w421aIGl2GXkT0tSGoap5I-gzGzoHsz",appKey:"BpNeeVt0v3tKAbF1L6RTf94X",path:"window.location.pathname",placeholder:"说点什么",avatar:"hide",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!1,serverURLs:"https://t4w421ai.lc-cn-n1-shared.com",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class=sidebar style=margin-left:-1rem><div id=toc><p class=toc-header><i class="iconfont icon-list"></i> <span>目录</span></p><div class=toc-body id=toc-body></div></div></aside></div></div></div><script>Fluid.utils.createScript("https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js",function(){mermaid.initialize({theme:"default"}),Fluid.utils.listenDOMLoaded(function(){Fluid.events.registerRefreshCallback(function(){"mermaid"in window&&mermaid.init()})})})</script><a id=scroll-top-button aria-label=TOP href=# role=button><i class="iconfont icon-arrowup" aria-hidden=true></i></a><div class="modal fade" id=modalSearch tabindex=-1 role=dialog aria-labelledby=ModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-lg" role=document><div class=modal-content><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type=button id=local-search-close class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type=text id=local-search-input class="form-control validate"> <label data-error=x data-success=v for=local-search-input>关键词</label></div><div class=list-group id=local-search-result></div></div></div></div></div></main><footer><div class=footer-inner><div class=footer-content><a href=https://hexo.io target=_blank rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href=https://github.com/fluid-dev/hexo-theme-fluid target=_blank rel="nofollow noopener"><span>Fluid</span></a></div><div class=statistics><span id=leancloud-site-pv-container style=display:none>总访问量 <span id=leancloud-site-pv></span> 次 </span><span id=leancloud-site-uv-container style=display:none>总访客数 <span id=leancloud-site-uv></span> 人</span></div><div class=beian><span><a href=http://beian.miit.gov.cn/ target=_blank rel="nofollow noopener"><a target=_blank rel=noopener href=https://beian.miit.gov.cn>京ICP备2021006744号-1</a> </a></span><span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802034644" rel="nofollow noopener" class=beian-police target=_blank><span style=visibility:hidden;width:0>|</span> <img src=/img/police_beian.png alt=police-icon> <span>京公网安备 11010802034644号</span></a></span></div></div></footer><script src=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js></script><link rel=stylesheet href=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src=https://lib.baomitu.com/jquery/3.6.4/jquery.min.js></script><script src=https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js></script><script src=/js/events.js></script><script src=/js/plugins.js></script><script src=https://lib.baomitu.com/typed.js/2.0.12/typed.min.js></script><script>(t=>{var e=Fluid.plugins.typing;(t=t.getElementById("subtitle"))&&e&&e(t.getAttribute("data-typed-text"))})((window,document))</script><script src=/js/img-lazyload.js></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script defer=defer src=/js/leancloud.js></script><script src=/js/local-search.js></script><script src=/js/boot.js></script><noscript><div class=noscript-warning>博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>