<!DOCTYPE html><html lang=zh-CN data-default-color-scheme=auto><head><meta charset=UTF-8><link rel=apple-touch-icon sizes=76x76 href=/img/favicon/favicon.png><link rel=icon href=/img/favicon/favicon.png><link rel=canonical href="https://justloseit.top/2021 红明谷 Misc Writeup/"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content=#2f4154><meta name=author content="Mobilis In Mobili"><meta name=keywords content=""><meta name=description content="2021 “红明谷”杯数据安全大赛 Misc Writeup"><meta property=og:type content=article><meta property=og:title content="2021 红明谷 Misc Writeup"><meta property=og:url content=https://justloseit.top/2021%20%E7%BA%A2%E6%98%8E%E8%B0%B7%20Misc%20Writeup/index.html><meta property=og:site_name content=动中之动><meta property=og:description content="2021 “红明谷”杯数据安全大赛 Misc Writeup"><meta property=og:locale content=zh_CN><meta property=og:image content=https://justloseit.top/img/index/2021%20%E7%BA%A2%E6%98%8E%E8%B0%B7%20Misc%20Writeup.jpg><meta property=article:published_time content=2021-04-15T02:19:04.000Z><meta property=article:modified_time content=2022-11-21T12:08:21.972Z><meta property=article:author content="Mobilis In Mobili"><meta property=article:tag content=CTF><meta property=article:tag content=Misc><meta property=article:tag content=红明谷><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=https://justloseit.top/img/index/2021%20%E7%BA%A2%E6%98%8E%E8%B0%B7%20Misc%20Writeup.jpg><title>2021 红明谷 Misc Writeup - 动中之动</title><link rel=stylesheet href=https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css><link rel=stylesheet href=https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css><link rel=stylesheet href=https://lib.baomitu.com/hint.css/2.7.0/hint.min.css><link rel=stylesheet href=https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css><link rel=stylesheet href=//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css><link rel=stylesheet href=/css/main.css><link id=highlight-css rel=stylesheet href=/css/highlight.css><link id=highlight-css-dark rel=stylesheet href=/css/highlight-dark.css><script id=fluid-configs>var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"justloseit.top",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:60,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:"§"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:"snI2XNrHrhyx5g84m3Uim3EC-gzGzoHsz",app_key:"x2YseXJIHmvnsM4v9y9UAlvu",server_url:"https://sni2xnrh.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src=/js/utils.js></script><script src=/js/color-schema.js></script><meta name=generator content="Hexo 5.4.2"><link rel=alternate href=/atom.xml title=动中之动 type=application/atom+xml></head><body><header><div class=header-inner style=height:70vh><nav id=navbar class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=/ ><strong>Mobilis In Mobili</strong> </a><button id=navbar-toggler-btn class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"><div class=animated-icon><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto text-center"><li class=nav-item><a class=nav-link href=/ target=_self><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class=nav-item><a class=nav-link href=/archives/ target=_self><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class=nav-item><a class=nav-link href=/categories/ target=_self><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class=nav-item><a class=nav-link href=/tags/ target=_self><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class=nav-item><a class=nav-link href=/about/ target=_self><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class=nav-item><a class=nav-link href=/links/ target=_self><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class=nav-item id=search-btn><a class=nav-link target=_self href=javascript:; data-toggle=modal data-target=#modalSearch aria-label=Search><i class="iconfont icon-search"></i></a></li><li class=nav-item id=color-toggle-btn><a class=nav-link target=_self href=javascript:; aria-label="Color Toggle"><i class="iconfont icon-dark" id=color-toggle-icon></i></a></li></ul></div></div></nav><div id=banner class=banner parallax=true style="background:url(/img/banner/2021%20%E7%BA%A2%E6%98%8E%E8%B0%B7%20Misc%20Writeup.jpg) no-repeat center center;background-size:cover"><div class=full-bg-img><div class="mask flex-center" style=background-color:rgba(0,0,0,.3)><div class="banner-text text-center fade-in-up"><div class=h2><span id=subtitle data-typed-text="2021 红明谷 Misc Writeup"></span></div><div class=mt-3><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden=true></i> Mobilis In Mobili </span><span class=post-meta><i class="iconfont icon-date-fill" aria-hidden=true></i> <time datetime="2021-04-15 10:19" pubdate>2021年4月15日 上午</time></span></div><div class=mt-1><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 1.5k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 13 分钟 </span><span id=leancloud-page-views-container class=post-meta style=display:none><i class="iconfont icon-eye" aria-hidden=true></i> <span id=leancloud-page-views></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id=board-ctn><div id=board><article class="post-content mx-auto"><h1 id=seo-header>2021 红明谷 Misc Writeup</h1><p id=updated-time class="note note-info">本文最后更新于 2022年11月21日 晚上</p><div class=markdown-body><p>2021 “红明谷”杯数据安全大赛 Misc Writeup</p><span id=more></span><h1 id=2021-红明谷-misc-writeup><a class=markdownIt-Anchor href=#2021-红明谷-misc-writeup></a> 2021 红明谷 Misc Writeup</h1><h2 id=inputmonitor><a class=markdownIt-Anchor href=#inputmonitor></a> inputMonitor</h2><ul><li><p>题目描述：Akira在某次取证的过程中，在桌面找到了一个奇怪的文件，但是除此之外好像没有找到什么有价值的情报，很多的数据都被抹干净了，而且这个用户似乎根本就没装什么第三方的软件。Akira还粗心的只拷贝了C盘下的User目录，这下还有机会解开可疑文件吗？</p></li><li><p>提供了打包的 User 目录</p></li><li><p>解法</p><ul><li>利用脚本清理一下空文件，方便人工查找需要的新信息</li></ul><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><code class="hljs bash">@<span class=hljs-built_in>echo</span> off<br><span class=hljs-keyword>for</span> /f <span class=hljs-string>&quot;tokens=*&quot;</span> %%i <span class=hljs-keyword>in</span> (<span class=hljs-string>&#x27;dir/s/b/ad^|sort /r&#x27;</span>) <span class=hljs-keyword>do</span> rd <span class=hljs-string>&quot;%%i&quot;</span><br></code></pre></td></tr></table></figure><ul><li>发现 <code>Dump_6e7e51d82aa230fe12d1fbc145da6441\User\link3\Desktop</code> 里面有 <code>flag.7z</code> 和 <code>log_data.txt</code>。<ul><li>flag.7z：需要密码，或许得到了密码就能获得 flag</li><li>log_data.txt：显示<code>没事，我都删掉了，之前的聊天记录都被我清干净了。除非他们在监控我输入</code>，综合题目名称，猜测应该需要分析输入记录</li></ul></li><li>考虑输入法的记录，参考<a target=_blank rel=noopener href=https://mp.weixin.qq.com/s/0p3vbLub5vPKO5Pik9zmUQ>输入法取证：一种Windows8/10中文用户输入痕迹信息提取方法研究与实现</a><ul><li>与中文输入法相关的用户词库文件主要存储在 <code>C:\Users\Administrator\AppData\Roaming\Microsoft\InputMethod\Chs</code>中<ul><li><code>ChsPinyinlH.dat</code> 文件记录着系统用户的中文<strong>字词</strong>输入信息</li><li><code>ChsPinyinUDL.dat</code>文件记录着系统用户的中文<strong>短句</strong>输入信息</li></ul></li><li>利用 <a target=_blank rel=noopener href=https://github.com/studyzy/imewlconverter/issues/58>微软拼音自学习词库的导入导出算法</a>中 @HowcanoeWang 的<a target=_blank rel=noopener href=https://github.com/studyzy/imewlconverter/files/4365598/pinyin.zip>脚本</a>，就能获得输入记录。</li></ul><div align=center><img src="/img/post/2021 红明谷 Misc Writeup/pinyin.jpg" srcset="/img/loading.gif" lazyload style=zoom:50%></div></li><li>密码是：<code>有志者事竟成</code><ul><li>解压得到一个 pdf 文件</li></ul><div align=center><img src="/img/post/2021 红明谷 Misc Writeup/pdf.png" srcset="/img/loading.gif" lazyload style=zoom:50%></div></li><li>删除图片，得到图片下的 flag<div align=center><img src="/img/post/2021 红明谷 Misc Writeup/pdf2.png" srcset="/img/loading.gif" lazyload style=zoom:50%></div></li></ul></li></ul><hr><div class="note note-success"><p>快用你那无敌的<strong>取证大师</strong>想想办法啊!</p></div><p><s>然而，我使用取证大师并没有分析出结果</s></p><h2 id=我的心是冰冰的><a class=markdownIt-Anchor href=#我的心是冰冰的></a> 我的心是冰冰的</h2><ul><li>题目描述：似乎有信息被隐藏了。</li><li>提供一个压缩包</li><li>解法<ul><li><p>用 WinRAR 打开就报错，解压还需要密码……应该是使用了伪加密——然而，一般伪加密不是对于ZIP而言的么？</p><div align=center><img src="/img/post/2021 红明谷 Misc Writeup/winrar.png" srcset="/img/loading.gif" lazyload style=zoom:50%></div><ul><li>看了<a target=_blank rel=noopener href=https://l1near.top/index.php/2021/03/15/97.html#comment-174>L1near 师傅的官方 writeup</a> 后，需要修改 RAR 第 24 字节处（对应 <code>PASSWORD_ENCRYPTED</code>）从1改为0就可以正常打开文件了/把第24字节的后面一个4改成0也可以</li><li>然而，即便是使用了 010editor 的模板也没有解析处这里对应 <code>PASSWORD_ENCRYPTED</code>，看官方 writeup 应该是 RAR 版本问题</li><li>但是，或许正因为是版本问题，我在没有做任何伪加密修改时，同样能够正常解压缩</li></ul></li><li><p>解压得到 <code>bingbing.jpg</code> 和 <code>bingbing.zip</code></p><ul><li><code>bingbing.zip</code> 有密码，含有一个 <code>bingbing.pcapng</code> 文件</li></ul></li><li><p>根据官方 writeup，这是简单 FFT，其 payload 如下：（然而这道题改了，这样跑不出结果）</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br></pre></td><td class=code><pre><code class="hljs python"><span class=hljs-keyword>import</span> cv2 <span class=hljs-keyword>as</span> cv<br><span class=hljs-keyword>import</span> numpy <span class=hljs-keyword>as</span> np<br><span class=hljs-keyword>import</span> matplotlib.pyplot <span class=hljs-keyword>as</span> plt<br>img = cv.imread(<span class=hljs-string>&#x27;FFT.png&#x27;</span>, <span class=hljs-number>0</span>) <span class=hljs-comment>#直接读为灰度图像</span><br>f = np.fft.fft2(img)            <span class=hljs-comment>#做频率变换</span><br>fshift = np.fft.fftshift(f)     <span class=hljs-comment>#转移像素做幅度谱</span><br>s1 = np.log(np.<span class=hljs-built_in>abs</span>(fshift))<span class=hljs-comment>#取绝对值：将复数变化成实数取对数的目的为了将数据变化到0-255</span><br>plt.subplot(<span class=hljs-number>121</span>)<br>plt.imshow(img, <span class=hljs-string>&#x27;gray&#x27;</span>)<br>plt.title(<span class=hljs-string>&#x27;original&#x27;</span>)<br>plt.subplot(<span class=hljs-number>122</span>)<br>plt.imshow(s1,<span class=hljs-string>&#x27;gray&#x27;</span>)<br>plt.title(<span class=hljs-string>&#x27;center&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><ul><li>这里需要使用 Java 盲水印：</li></ul><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><code class="hljs bash">java -jar .\BlindWatermark.jar decode -c .\bingbing.jpg clue.jpg<br></code></pre></td></tr></table></figure><ul><li>Java 盲水印的工具：<a target=_blank rel=noopener href=https://github.com/ww23/BlindWatermark>BlindWatermark</a><br>![](/img/post/2021 红明谷 Misc Writeup/bingbing.png)<br>![](/img/post/2021 红明谷 Misc Writeup/blindwatermark.png)</li></ul></li><li><p>得到压缩包密码：<code>gnibgnib</code></p></li><li><p>打开压缩包，获得 <code>bingbing.pcapng</code></p><div align=center><img src="/img/post/2021 红明谷 Misc Writeup/bingbingpcap.png" srcset="/img/loading.gif" lazyload style=zoom:50%></div></li><li><p>USB键盘流量，使用 tshark + <a target=_blank rel=noopener href=https://github.com/WangYihang/UsbKeyboardDataHacker>USB Keyboard Data Hacker</a> 得到 <code>666c61677b38663965643266393333656631346138643035323364303334396531323939637d</code></p></li><li><p>Hex 转 ascii 得到flag</p></li></ul></li></ul><h2 id=歪比歪比><a class=markdownIt-Anchor href=#歪比歪比></a> 歪比歪比</h2><ul><li><p>题目描述：戴夫发送了一些信息给僵尸，但是被我截获到了。看看能从里边发现什么?好像是一个Surprise，你来翻译翻译?</p></li><li><p>提供一个名为 <code>data</code> 的文件</p><ul><li>实际上是一个 pcap 包（利用Online TrID）</li></ul></li><li><p>解法</p><ul><li>追踪TCP流，得到如下文本<div align=center><img src="/img/post/2021 红明谷 Misc Writeup/wireshark.png" srcset="/img/loading.gif" lazyload style=zoom:50%></div><div align=center><img src="/img/post/2021 红明谷 Misc Writeup/wireshark2.png" srcset="/img/loading.gif" lazyload style=zoom:50%></div></li><li>明显是词频统计，哈夫曼编码</li><li>payload如下：</li></ul><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br></pre></td><td class=code><pre><code class="hljs python"><span class=hljs-comment># 统计字符出现频率</span><br><br><span class=hljs-keyword>def</span> <span class="hljs-title function_">countFrequency</span>(<span class=hljs-params>text</span>):<br>    chars = []<br>    chars_freqs = []<br>    <span class=hljs-keyword>for</span> char <span class=hljs-keyword>in</span> text:<br>        <span class=hljs-keyword>if</span> char <span class=hljs-keyword>in</span> chars:<br>            <span class=hljs-keyword>continue</span><br>        <span class=hljs-keyword>else</span>:<br>            chars.append(char)<br>            chars_freqs.append((char, text.count(char)))<br>    <span class=hljs-keyword>return</span> chars_freqs<br><br><br><span class=hljs-comment># 节点类</span><br><br><span class=hljs-keyword>class</span> <span class="hljs-title class_">Node</span>:<br>    <span class=hljs-keyword>def</span> <span class="hljs-title function_">__init__</span>(<span class=hljs-params>self, freq</span>):<br>        <span class="hljs-variable language_">self</span>.left = <span class=hljs-literal>None</span><br>        <span class="hljs-variable language_">self</span>.right = <span class=hljs-literal>None</span><br>        <span class="hljs-variable language_">self</span>.father = <span class=hljs-literal>None</span><br>        <span class="hljs-variable language_">self</span>.freq = freq<br><br>    <span class=hljs-keyword>def</span> <span class="hljs-title function_">isLeft</span>(<span class=hljs-params>self</span>):<br>        <span class=hljs-keyword>return</span> <span class="hljs-variable language_">self</span>.father.left == <span class="hljs-variable language_">self</span><br><br><br><span class=hljs-comment># 根据freqs数组创建叶子节点</span><br><br><span class=hljs-keyword>def</span> <span class="hljs-title function_">createNodes</span>(<span class=hljs-params>freqs</span>):<br>    <span class=hljs-keyword>return</span> [Node(freq) <span class=hljs-keyword>for</span> freq <span class=hljs-keyword>in</span> freqs]<br><br><br><span class=hljs-comment># 构建Huffman树</span><br><br><span class=hljs-keyword>def</span> <span class="hljs-title function_">createHuffmanTree</span>(<span class=hljs-params>nodes</span>):<br>    queue = nodes[:]<br>    <span class=hljs-keyword>while</span> <span class=hljs-built_in>len</span>(queue) &gt; <span class=hljs-number>1</span>:<br>        queue.sort(key=<span class=hljs-keyword>lambda</span> item: item.freq)<br>        node_left = queue.pop(<span class=hljs-number>0</span>)<br>        node_right = queue.pop(<span class=hljs-number>0</span>)<br>        node_father = Node(node_left.freq+node_right.freq)<br>        node_father.left = node_left<br>        node_father.right = node_right<br>        node_left.father = node_father<br>        node_right.father = node_father<br>        queue.append(node_father)<br>    queue[<span class=hljs-number>0</span>].father = <span class=hljs-literal>None</span><br>    <span class=hljs-keyword>return</span> queue[<span class=hljs-number>0</span>]<br><br><br><span class=hljs-comment># 由Huffman树得到Huffman编码</span><br><span class=hljs-comment># codes，nodes，chars_freqs的下标是一一对应的</span><br><br><span class=hljs-keyword>def</span> <span class="hljs-title function_">encodeHuffman</span>(<span class=hljs-params>nodes, root</span>):<br>    codes = [<span class=hljs-string>&#x27;&#x27;</span>]*<span class=hljs-built_in>len</span>(nodes)<br>    <span class=hljs-comment># 对于每一个节点，找其父节点，若其父节点是左侧节点，则编码前添加&#x27;0&#x27;</span><br>    <span class=hljs-comment># node_tmp即用于一层层向上寻找父节点</span><br>    <span class=hljs-keyword>for</span> i <span class=hljs-keyword>in</span> <span class=hljs-built_in>range</span>(<span class=hljs-built_in>len</span>(nodes)):<br>        node_tmp = nodes[i]<br>        <span class=hljs-keyword>while</span> node_tmp != root:<br>            <span class=hljs-keyword>if</span> node_tmp.isLeft():<br>                codes[i] = <span class=hljs-string>&#x27;0&#x27;</span>+codes[i]<br>            <span class=hljs-keyword>else</span>:<br>                codes[i] = <span class=hljs-string>&#x27;1&#x27;</span>+codes[i]<br>            node_tmp = node_tmp.father<br>    <span class=hljs-keyword>return</span> codes<br><br><br><span class=hljs-comment># 编码字符串</span><br><br><span class=hljs-keyword>def</span> <span class="hljs-title function_">encodeStr</span>(<span class=hljs-params>text, chars_freqs, codes</span>):<br>    huffmanStr = <span class=hljs-string>&#x27;&#x27;</span><br>    <span class=hljs-comment># 对字符串中的每个字符，遍历chars_freqs，查看对应codes的下标</span><br>    <span class=hljs-keyword>for</span> char <span class=hljs-keyword>in</span> text:<br>        <span class=hljs-keyword>for</span> i <span class=hljs-keyword>in</span> <span class=hljs-built_in>range</span>(<span class=hljs-built_in>len</span>(codes)):<br>            <span class=hljs-keyword>if</span> char == chars_freqs[i][<span class=hljs-number>0</span>]:<br>                huffmanStr += codes[i]<br>                <span class=hljs-keyword>break</span><br>    <span class=hljs-keyword>return</span> huffmanStr<br><br><br><span class=hljs-comment># 解码哈夫曼编码串</span><br><br><span class=hljs-keyword>def</span> <span class="hljs-title function_">decodeStr</span>(<span class=hljs-params>huffmanStr, chars_freqs, codes</span>):<br>    orignStr = <span class=hljs-string>&#x27;&#x27;</span><br>    <span class=hljs-comment># 利用截断的方法，每次截取哈夫曼编码首部</span><br>    <span class=hljs-keyword>while</span> huffmanStr != <span class=hljs-string>&#x27;&#x27;</span>:<br>        <span class=hljs-comment># 遍历codes，查看是否有codes在哈夫曼编码串首部</span><br>        <span class=hljs-keyword>for</span> i <span class=hljs-keyword>in</span> <span class=hljs-built_in>range</span>(<span class=hljs-built_in>len</span>(codes)):<br>            <span class=hljs-keyword>if</span> codes[i] <span class=hljs-keyword>in</span> huffmanStr <span class=hljs-keyword>and</span> huffmanStr.index(codes[i]) == <span class=hljs-number>0</span>:<br>                orignStr += chars_freqs[i][<span class=hljs-number>0</span>]<br>                huffmanStr = huffmanStr[<span class=hljs-built_in>len</span>(codes[i]):]<br>    <span class=hljs-keyword>return</span> orignStr<br><br><br><span class=hljs-keyword>if</span> __name__ == <span class=hljs-string>&#x27;__main__&#x27;</span>:<br>    trash_array = &#123;<br>        <span class=hljs-string>&#x27;j&#x27;</span>: <span class=hljs-number>29</span>,<br>        <span class=hljs-string>&#x27;z&#x27;</span>: <span class=hljs-number>31</span>,<br>        <span class=hljs-string>&#x27;7&#x27;</span>: <span class=hljs-number>25</span>,<br>        <span class=hljs-string>&#x27;e&#x27;</span>: <span class=hljs-number>31</span>,<br>        <span class=hljs-string>&#x27;l&#x27;</span>: <span class=hljs-number>23</span>,<br>        <span class=hljs-string>&#x27;6&#x27;</span>: <span class=hljs-number>37</span>,<br>        <span class=hljs-string>&#x27;4&#x27;</span>: <span class=hljs-number>32</span>,<br>        <span class=hljs-string>&#x27;p&#x27;</span>: <span class=hljs-number>38</span>,<br>        <span class=hljs-string>&#x27;h&#x27;</span>: <span class=hljs-number>27</span>,<br>        <span class=hljs-string>&#x27;g&#x27;</span>: <span class=hljs-number>26</span>,<br>        <span class=hljs-string>&#x27;x&#x27;</span>: <span class=hljs-number>28</span>,<br>        <span class=hljs-string>&#x27;i&#x27;</span>: <span class=hljs-number>25</span>,<br>        <span class=hljs-string>&#x27;u&#x27;</span>: <span class=hljs-number>27</span>,<br>        <span class=hljs-string>&#x27;n&#x27;</span>: <span class=hljs-number>25</span>,<br>        <span class=hljs-string>&#x27;8&#x27;</span>: <span class=hljs-number>36</span>,<br>        <span class=hljs-string>&#x27;0&#x27;</span>: <span class=hljs-number>24</span>,<br>        <span class=hljs-string>&#x27;o&#x27;</span>: <span class=hljs-number>23</span>,<br>        <span class=hljs-string>&#x27;c&#x27;</span>: <span class=hljs-number>28</span>,<br>        <span class=hljs-string>&#x27;y&#x27;</span>: <span class=hljs-number>24</span>,<br>        <span class=hljs-string>&#x27;1&#x27;</span>: <span class=hljs-number>29</span>,<br>        <span class=hljs-string>&#x27;b&#x27;</span>: <span class=hljs-number>26</span>,<br>        <span class=hljs-string>&#x27;m&#x27;</span>: <span class=hljs-number>27</span>,<br>        <span class=hljs-string>&#x27;2&#x27;</span>: <span class=hljs-number>28</span>,<br>        <span class=hljs-string>&#x27;v&#x27;</span>: <span class=hljs-number>25</span>,<br>        <span class=hljs-string>&#x27;d&#x27;</span>: <span class=hljs-number>33</span>,<br>        <span class=hljs-string>&#x27;f&#x27;</span>: <span class=hljs-number>28</span>,<br>        <span class=hljs-string>&#x27;9&#x27;</span>: <span class=hljs-number>33</span>,<br>        <span class=hljs-string>&#x27;t&#x27;</span>: <span class=hljs-number>21</span>,<br>        <span class=hljs-string>&#x27;w&#x27;</span>: <span class=hljs-number>22</span>,<br>        <span class=hljs-string>&#x27;a&#x27;</span>: <span class=hljs-number>31</span>,<br>        <span class=hljs-string>&#x27;r&#x27;</span>: <span class=hljs-number>24</span>,<br>        <span class=hljs-string>&#x27;s&#x27;</span>: <span class=hljs-number>16</span>,<br>        <span class=hljs-string>&#x27;k&#x27;</span>: <span class=hljs-number>32</span>,<br>        <span class=hljs-string>&#x27;5&#x27;</span>: <span class=hljs-number>25</span>,<br>        <span class=hljs-string>&#x27;q&#x27;</span>: <span class=hljs-number>23</span>,<br>        <span class=hljs-string>&#x27;3&#x27;</span>: <span class=hljs-number>32</span>,<br>        <span class=hljs-string>&#x27;&#123;&#x27;</span>: <span class=hljs-number>1</span>,<br>        <span class=hljs-string>&#x27;-&#x27;</span>: <span class=hljs-number>4</span>,<br>        <span class=hljs-string>&#x27;&#125;&#x27;</span>: <span class=hljs-number>1</span>,<br>    &#125;<br>    tt = <span class=hljs-built_in>list</span>(trash_array.items())<br>    chars_freqs = tt<br><br>    nodes = createNodes([item[<span class=hljs-number>1</span>] <span class=hljs-keyword>for</span> item <span class=hljs-keyword>in</span> chars_freqs])<br>    root = createHuffmanTree(nodes)<br>    codes = encodeHuffman(nodes, root)<br><br>    huffmanStr = <span class=hljs-string>&#x27;0111110001000011001010001111011110101010011011011110100000110010111101000010010010001100001110010000011110011101101111011001111101000000111010100000101101001000111100000000010100110100101001011101110010001100011100010010111001100011100110011010011000101010100011011110001111111110111001011100010100101111100001011011001001001000010111110101110111010111100010111011000011001011001101001010010111111001110101000110001001001100101110111101111000110010010111111000111110000101001100100100001001110100101011111101111110011101011101000000100100100011111111001000101110101001001101110001011101101001001001011010000101111111001011111100110010100111111110001001100100010010010011110111110110110001101000010010110110001011010000100011010111110101110000110000010001111111110000101000100101101111000111100101101011001100010101011000110010011111001010011110100100011000101111110111011011000011011010100011011100010001010001010000000001101001010010100111111010010110110011110100101010010101001010100010101011010011110001000011000100001010111001110001100101100001010111011110110111110000001011011111011101101000111111110100111100110011101111100111100101101101101010100110001100100110101011110000011111111100011110011101010011110101010111100111100001000111110111110100010011110011000010000100001100101111101010110101100011100010010100001110001001010110010010010100010101101101001110000101111110101010110110110000010011000111000010001001101101101101100111000011000011010101111010101100101000011011001011000101101110100011110001100111101111011000100110110000111010101101111101001111111111100001000111000001001011111011110010110101011110001110001101010011000101111100001111111011100110101001000011111101111111011001111110001110111110110010111000111011011110010101010110011001110110011110001111010000011010101000111110111011100101100100100100001111101010011101111100110011100000010100101000111100100011001011111000000111111111000000011111111101110111111001110100100000100000011011111010000000011110101110111101101011001111011010101111000010110001101000111000111000001110110111000100011110101100100100011100111100101101010010110101011111110011100100000111011011010101101110111000001001100110111001000111001000000111000110010110000100100010001001111010101000101101111000000110101110011101001011100110111101101111100001111000110001101010000111100100011110001100110111001101011100010101011110111111111100101100101010001101110101101101010101001110100001101011000100001111011011100101011000001001000011011000111011101110011001101110100000010100000101111010000001000011001101101111010011101000000101101101011101001101110000010011110001110100111000101111101010110111010011010011000011000110110010110001001000101101111000010010001011110100010111010100101100101111010100001110111100000100101101011110010110001000111111001000000101110010111010001101101111101110111000010101100100001010101001010010001011101001100101010101001111110000010011010011110101001001001110010110100111011110110000111101000010011111000111111001111010011101011010011100010001111101001110011110101111111111111011010100000010100010010011110100110011011101011101011101100000100111110111100100000101011000110110000010110001001111111111011101011000010101111110111001011101111111100111011101001000111011110110111101001011110011000110011000010011011001001100010010111110000110100001110111100110110100101010010111001001100101111010010001001111111000010111101010110000001110101000111011010111100110101001001110001110001001111110001000010011011110100111011111000101111110011000011010001000101000110011100011001001011000111011100101101000110001110011011101010101001010011101110100100111101011101010011010101010111101110101101000001111100111111010011010111101000101011111101011100101101101001100011001111101111100100111101101101110111111010111010100100101110111000011100001001000011100010101110100111110011001100101111110110100111101000010001000011011110000011010110111010110001110011111110000011110010001011010010111111101010101110010000001010011111011100101000101101010101101101000101000110011101101010110001100101011101110111100000001010000011110011010011000011111110100111011100100111000001101001110111100000101010110000010000100001110111000011111110010010100111111101010110000000000111011010000101100100111001110000001011101100000110110101011001011000111001111110010101111001011011101000010001100011101110010100111000011111001110001100111110110111101010101011001000101011010001100000010001111110011001101111111010110010001111001100111110001110011100010011011100100010011011000110000100101111100111110111101010010001101010011100110001011001111000100011011110100011101011101010111111110000011110110111011110000010111100110011100011010111101111110100000010001111100101100011110001101011111101111111011111011101010001101001000111000101111110101000110011000111011111101111110100001111011110010100011101110111111010101100111000101100100010011101001011110011111001111101110001110111111011100111100010110010011011010100011100101010101010110000001010111001101111100111110010100111000010101111001110011011011111001101110011111001000000000111101011000111110001101010011011000010100100100111011111110010000000101001111111110101100001010000001110100101001111001011011001001001011100101111110&#x27;</span><br>    orignStr = decodeStr(huffmanStr, chars_freqs, codes)<br><br>    <span class=hljs-built_in>print</span>(<span class=hljs-string>&#x27;Decode result:&#x27;</span> + orignStr)<br></code></pre></td></tr></table></figure><ul><li>运行后得到flag</li></ul></li></ul></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class=category-chains><span class=category-chain><a href=/categories/Writeup/ class=category-chain-item>Writeup</a></span></span></div><div class=post-meta><i class="iconfont icon-tags"></i> <a href=/tags/CTF/ class=print-no-link>#CTF</a> <a href=/tags/Misc/ class=print-no-link>#Misc</a> <a href=/tags/%E7%BA%A2%E6%98%8E%E8%B0%B7/ class=print-no-link>#红明谷</a></div></div><div class="license-box my-3"><div class=license-title><div>2021 红明谷 Misc Writeup</div><div>https://justloseit.top/2021 红明谷 Misc Writeup/</div></div><div class=license-meta><div class=license-meta-item><div>作者</div><div>Mobilis In Mobili</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2021年4月15日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2022年11月21日</div></div><div class=license-meta-item><div>许可协议</div><div><a class=print-no-link target=_blank href=https://creativecommons.org/licenses/by-sa/4.0/ ><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i> </span></a><a class=print-no-link target=_blank href=https://creativecommons.org/licenses/by-sa/4.0/ ><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-cc-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href=/%E5%8F%96%E8%AF%81%E9%A2%98%E4%B8%AD%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/ title=取证题中系统文件><i class="iconfont icon-arrowleft"></i> <span class=hidden-mobile>取证题中系统文件</span> <span class=visible-mobile>上一篇</span></a></article><article class="post-next col-6"><a href=/%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93%EF%BC%9A2020%E5%B9%B4%E6%88%91%E7%9A%84%E9%98%85%E8%AF%BB%C2%B7%E5%BD%B1%E8%A7%86%C2%B7%E6%B8%B8%E6%88%8F/ title=年度总结：2020年我的阅读·影视·游戏><span class=hidden-mobile>年度总结：2020年我的阅读·影视·游戏</span> <span class=visible-mobile>下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id=comments><div id=valine></div><script type=text/javascript>Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",function(){var i=Object.assign({appId:"t4w421aIGl2GXkT0tSGoap5I-gzGzoHsz",appKey:"BpNeeVt0v3tKAbF1L6RTf94X",path:"window.location.pathname",placeholder:"说点什么",avatar:"hide",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!1,serverURLs:"https://t4w421ai.lc-cn-n1-shared.com",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class=sidebar style=margin-left:-1rem><div id=toc><p class=toc-header><i class="iconfont icon-list"></i> <span>目录</span></p><div class=toc-body id=toc-body></div></div></aside></div></div></div><a id=scroll-top-button aria-label=TOP href=# role=button><i class="iconfont icon-arrowup" aria-hidden=true></i></a><div class="modal fade" id=modalSearch tabindex=-1 role=dialog aria-labelledby=ModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-lg" role=document><div class=modal-content><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type=button id=local-search-close class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type=text id=local-search-input class="form-control validate"> <label data-error=x data-success=v for=local-search-input>关键词</label></div><div class=list-group id=local-search-result></div></div></div></div></div></main><footer><div class=footer-inner><div class=footer-content><a href=https://hexo.io target=_blank rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href=https://github.com/fluid-dev/hexo-theme-fluid target=_blank rel="nofollow noopener"><span>Fluid</span></a></div><div class=statistics><span id=leancloud-site-pv-container style=display:none>总访问量 <span id=leancloud-site-pv></span> 次 </span><span id=leancloud-site-uv-container style=display:none>总访客数 <span id=leancloud-site-uv></span> 人</span></div><div class=beian><span><a href=http://beian.miit.gov.cn/ target=_blank rel="nofollow noopener"><a target=_blank rel=noopener href=https://beian.miit.gov.cn>京ICP备2021006744号-1</a> </a></span><span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802034644" rel="nofollow noopener" class=beian-police target=_blank><span style=visibility:hidden;width:0>|</span> <img src=/img/police_beian.png alt=police-icon> <span>京公网安备 11010802034644号</span></a></span></div></div></footer><script src=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js></script><link rel=stylesheet href=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src=https://lib.baomitu.com/jquery/3.6.4/jquery.min.js></script><script src=https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js></script><script src=/js/events.js></script><script src=/js/plugins.js></script><script src=https://lib.baomitu.com/typed.js/2.0.12/typed.min.js></script><script>(t=>{var e=Fluid.plugins.typing;(t=t.getElementById("subtitle"))&&e&&e(t.getAttribute("data-typed-text"))})((window,document))</script><script src=/js/img-lazyload.js></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script defer=defer src=/js/leancloud.js></script><script src=/js/local-search.js></script><script src=/js/boot.js></script><noscript><div class=noscript-warning>博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>